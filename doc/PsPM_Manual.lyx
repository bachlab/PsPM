#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{stmaryrd}
\usepackage[svgpath=./Figures]{svg}
\usepackage{graphicx}
\definecolor{colKeys}{rgb}{0,0,1}
\definecolor{colIdentifier}{rgb}{0,0,0}
\definecolor{colComments}{rgb}{0.53, 0.66, 0.42}
\definecolor{colString}{rgb}{0.87, 0.36, 0.51}
\definecolor{barColor}{rgb}{0.43, 0.5, 0.5}
% Added by lyx2lyx
\renewcommand{\textendash}{--}
\renewcommand{\textemdash}{---}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
customHeadersFooters
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 0
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 0
\use_package mhchem 1
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle headings
\listings_params "language=Matlab,float=hbp,basicstyle={\footnotesize\ttfamily},identifierstyle={\color{colIdentifier}},keywordstyle={\color{colKeys}},stringstyle={\color{colString}},commentstyle={\itshape\color{colComments}},columns=fixed,tabsize=2,extendedchars=true,showspaces=false,showstringspaces=false,captionpos=t,backgroundcolor={\color{white}},framexleftmargin=1pt,frame=l"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
PsPM: Psychophysiological Modelling
\end_layout

\begin_layout Standard
\align center
Version 4.3.0
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center

\size larger
by the PsPM team
\size default

\begin_inset Foot
status open

\begin_layout Plain Layout
\noindent
If you have comments on or error corrections to this documentation, please
 send them to the PsPM team or post them on: 
\begin_inset CommandInset href
LatexCommand href
name "bachlab.org/pspm"
target "http://bachlab.org/pspm"
literal "false"

\end_inset


\end_layout

\end_inset


\size larger
:
\end_layout

\begin_layout Standard
\align center

\size larger
Dominik R Bach, Giuseppe Castegnetti, Laure Ciernik, Samuel Gerster, Saurabh
 Khemka, Christoph Korn, Tobias Moser, Philipp C Paulus, Ivan Rojkov, Matthias
 Staib, Eshref Yozdemir and collaborators
\size default

\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Part
Background
\end_layout

\begin_layout Section
What is psychophysiological modelling?
\end_layout

\begin_layout Subsection
The psychophysiological inverse problem
\end_layout

\begin_layout Standard
Psychophysiology is concerned with the relationship between the mind (i.e.
 psychological processes) and the body (including the nervous).
 This relationship is bidirectional: the mind influences the body, but processes
 in the body are monitored by the mind via proprioception and interoception.
 Knowledge on this bidirectional relationship affords for instance examining
 more closely how psychological factors influence health, or how the interceptiv
e abilities of an individual affect his psychological well-being.
 
\end_layout

\begin_layout Standard
However, a very common application of psychophysiological knowledge is to
 measure processes in the body (sweating, heart activity, respiration, etc.)
 to assess processes in the mind.
 This is an inverse problem.
 The researcher is not actually interested whether skin conductance is different
 between two conditions (the forward relation).
 They are interested, for example, whether a subject successfully learned
 an association between a conditioned stimulus (CS) and an electric shock,
 and use skin conductance to measure this learning process.
 To make this inverse inference, the 
\begin_inset Quotes eld
\end_inset

turn the forward model around
\begin_inset Quotes erd
\end_inset

 - they ask, what has happened in the mind, given what is measured in the
 body.
 There are several way of doing this, and all require good knowledge of
 the forward relationship.
 
\end_layout

\begin_layout Subsection
Operational analysis
\end_layout

\begin_layout Standard
Operational approaches seek to identify data features (
\begin_inset Quotes eld
\end_inset

indices
\begin_inset Quotes erd
\end_inset

) that closely follow a psychological state of interest.
 Operational data analysis algorithms extract these data features, to 
\begin_inset Quotes eld
\end_inset

index
\begin_inset Quotes erd
\end_inset

 central states.
 For example, to infer stimulus-evoked sympathetic arousal (SA) from skin
 conductance responses (SCR), one may filter the SCR data to reduce observation
 noise, define a response window after the stimulus, and define some criteria
 do detect peaks within this window.
 The amplitude of such peaks may then be taken as 
\begin_inset Quotes eld
\end_inset

index
\begin_inset Quotes erd
\end_inset

 of SA.
 The development of such indices is an important application of psychophysiology.
 Such indices are usually based on qualitative or semi-quantitative models
 of how the index relates to the psychological state of interest.
 Model-based analysis has precisely the same goal as operational analysis
 - but seeks to make these implict models explicit (i.e.
 testable) in mathematical form - see 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013ab"
literal "true"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach2018:aa"
literal "false"

\end_inset

 for a review.
\end_layout

\begin_layout Subsection
Model-based analysis 
\end_layout

\begin_layout Standard
Model-based approaches start with explicit, mathematical models that formulate
 how observed data are generated by psychological processes.
 For example, a model may formulate the relation between sympathetic arousal
 (SA) and skin conductance responses (SCR), 
\begin_inset Formula $SA\mapsto SCR$
\end_inset

, in mathematical form.
 This kind of model is often termed a "forward model": it predicts a data
 time series (SCR) from a known psychological process (SA).
 Another term for this kind of model is 
\begin_inset Quotes eld
\end_inset

generative
\begin_inset Quotes erd
\end_inset

, because it describes how a psychological process generates the data.
 When we analyse experimental data, we are faced with the opposite situation:
 we know the observed data data but not the central process, and seek to
 infer the central process from the data.
 In order to do so, one has to turn the forward model backwards, to arrive
 at the relation 
\begin_inset Formula $SA\mapsfrom SCR$
\end_inset

.
 In statistics, this process is often termed "model inversion".
 It provides the most likely estimates of the central process, given the
 observed data and the model.
 Both conventional and model-based analysis aim to infer central process
 from observed data.
 The difference is that model-based methods use a stringent mathematical
 language and probabilistic model inversion to do so.
 Note that probabilistic models acknowledge the existence of noise in the
 data, and they do not seek to explain this noise with variation in psychologica
l states.
 Hence, the criterion for the quality of a model-based method is not how
 well the model 
\begin_inset Quotes eld
\end_inset

fits the data
\begin_inset Quotes erd
\end_inset

, but how well it can recover the psychological variables of interest.
 In other words, the model should be able to fit the data but at the same
 time to ignore noise in the data.
\end_layout

\begin_layout Section
Method comparison
\end_layout

\begin_layout Standard
How can we infer that one method of inferring a central state is better
 than another? Each method returns indices or estimates of the psychological
 state, but which ones are more precise? Psychological variables cannot
 be measured directly, so how can we compare our estimates to ground truth?
 The solution we propose is to experimentally create psychological states
 that are known.
 We can then evaluate how well a method recovers these known states.
 In the simple example of fear conditioning, we could compute a paired t-test
 on the CS+/CS- difference in the estimates and look at the t-value.
 the method that yields the highest t-value is most precise.
 But is it also significantly more precise than another method? This can
 be assessed with a formal model comparison.
 
\end_layout

\begin_layout Standard
In our example, we can try to predict CS identity (CS+/CS-) from the model
 estimates.
 This means we quantify evidence for a model in which individual participants'
 CS+ and CS- estimates are drawn from two distributions with different means,
 rather than the same mean.
 In other words, we are using a regression model that seeks to predict the
 known psychological state (dependent variable) from the estimated psychological
 state (independent variable).
 Note that this is different from a more convential regression or ANOVA
 model in which the data are the dependent variable and experimental conditions
 are the independent variable.
 This difference is important.
 In our approach, when comparing different methods, the dependent variable
 (the true state) will be the same, and the independent variable (the state
 estimates) will differ.
 This means that the total sum of squares (TSS) in the model will be constant.
 Thus, we can use the residual sum of squares (RSS) to compute model evidence
 and compare models - i.e.
 compare evidence for the statement that the method's estimates of the psycholog
ical state predict the true psychological state.
 We have termed this 
\begin_inset Quotes eld
\end_inset

predictive validity
\begin_inset Quotes erd
\end_inset

.
 Note that the model is not predictive in time - we are not trying to predict
 unknown data values.
 We are trying to predict true psychological state from the estimated state.
\end_layout

\begin_layout Standard
To quantify model evidence, PsPM uses the following approximation to Akaike
 Information Criterion (AIC) 
\begin_inset CommandInset citation
LatexCommand cite
key "Burnham:2004"
literal "true"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
AIC=n\log\left(RSS/n\right)+2k=-2\log\left(L\right)+2k,
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $n$
\end_inset

 is the number of data points in the predictive model, 
\begin_inset Formula $L$
\end_inset

 is the maximum of the likelihood function, and 
\begin_inset Formula $k$
\end_inset

 the number of parameters in the predictive model.
 
\begin_inset Formula $k$
\end_inset

 is constant for all methods that are evaluated in a methods comparison.
 We only interpret AIC differences, so this complexity term disappears from
 methods comparison.
 AIC differences divided by 2 can be interpreted as log Bayes Factors (LBF).
 In our case this quantifies the relative evidence that one method's estimates
 predict the true psychological state, relative to the other method.
 An absolute LBF of greater than 3 is usually regarded as decisive.
 This is because for a classical significance threshold of 
\begin_inset Formula $\alpha=.05$
\end_inset

, the probability of the data given the null hypothesis is 
\begin_inset Formula $p<.05$
\end_inset

.
 Similarly, for an LBF difference larger than 3, the relative probability
 that the inferior method predicts the true psychological state given the
 data is 
\begin_inset Formula $p<\exp\left(-3\right)\approx0.05$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Penny:2004aa"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Standard
All methods included in PsPM have empirically been shown to provide better
 or equal predictive validity than the best available corresponding conventional
 index.
 Although in most validation experiments only two conditions need to be
 distinguished (a discrimination problem), the goal of PsPM is to provide
 minimum-variance estimates of cognitive processes also in situations in
 which the cognitive process varies across more than just two levels.
 This is why we do not use discrimination methods to evaluate the models.
 Also, since most psychophysiological measures are influenced by a variety
 of cognitive processes, inference on a specific process unavoidably rests
 on a suitable experimental design in which different conditions only differ
 on this dimension, and not on other dimensions.
\end_layout

\begin_layout Standard
Of course, this approach to method comparison can also be used to improve
 operational indices, or event to create new indices in a blind classification
 approach based on large data sets.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
Historical remark:
\shape default
 Some papers from the PsPM team have used the formula: 
\begin_inset Formula $NLL=n\log\left(RSS/n\right)$
\end_inset

.
 If NLL is read as an arbitrary variable name, this formula is consistent
 with the previous paragaphs.
 However, note that NLL in this formula is not the negative log likelihood
 (as confusingly implied in the papers), but really the AIC without complexity
 correction.
 The numerical value of the negative log likelihood would in this terminology
 be 
\begin_inset Formula $NLL/2$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Section
General model structure
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
All model in PsPM split the relation between mind and body into two models,
 a peripheral and a neural model.
 The peripheral model describes how a neural impulse is converted to a measurabl
e signal.
 The neural model describes the relation between the psychological process
 and the neural input into the peripheral system.
 This distinction is historically based on SCR models.
 The neural signal that elicits SCR can be measured by intraneural recordings,
 and its properties are in principle known.
 Hence it appeared plausible for various research groups to create a peripheral
 model 
\begin_inset CommandInset citation
LatexCommand cite
key "Alexander:2005aa,Bach:2009aa,Benedek:2010ab"
literal "true"

\end_inset

 that takes an arbitrary neural input, and several neural models were then
 combined with this peripheral model.
 This distinction has later been used for other modalities, too: first because
 it appeared simple from a practical standpoint, secondly because it is
 often plausible to assume that the peripheral process is not directly influence
d by psychological states, but only via a neural input.
 Note, however, that the peripheral/neural distinction in the model implementati
on is not always consistent with biophysical reality and tends to follow
 a need for manageable inversion algorithms.
 Indeed, some models collapse peripheral and stereotypical neural processes
 into the peripheral model.
 Examples are the GLMs for fear-conditioned HPR, PSR, and RAR - this is
 unlike the non-linear SCR model in which parameters of the neural model
 are estimated explicitly.
\end_layout

\begin_layout Subsection
Peripheral models
\end_layout

\begin_layout Standard
The peripheral models in PsPM collapse all physiological and biophysical
 processes involved in the generation of the measured signal.
 For most psychophysiological measures, these processes are not known at
 the level of detail required to build true biophysical models from theory.
 In fact, biophysical models for the best-investigated modality, SCR, tend
 to not fit the observed data very well 
\begin_inset CommandInset citation
LatexCommand cite
key "Benedek:2010aa,Alexander:2005aa"
literal "true"

\end_inset

.
 This is why PsPM uses purely phenomenological models which regard the periphera
l system as a black box.
 By applying controlled inputs into the system, and measuring the output,
 one can then approximate the workings of this black box in mathematical
 form, without knowing its content.
\end_layout

\begin_layout Subsubsection*
LTI systems
\end_layout

\begin_layout Standard
Crucially, all models in PsPM assume that the peripheral system can be described
 by one (or several) linear time invariant (LTI) systems with the defining
 properties linearity and time invariance.
 A LTI system is unambiguously described by its response function (RF).
 By linearity, input and output are linearly mapped so the responses to
 several inputs can be simply obtained by summing the responses to individual
 inputs.
 Time invariance means that the output does not explicitly depend on the
 time, i.e.
 that the shape of the RF is constant over time while the amplitude can
 vary.
 It is usually also assumed that the RF is constant over individuals, although
 this assumption is not necessary in the PsPM framework.
\end_layout

\begin_layout Standard
In principle, linearity ensures pure summation of two overlapping inputs.
 This is not realistic if the system has limited dynamic range and saturates
 due to a quick succession of inputs (e.
 g.
 the heart rate cannot increase indefinitely).
 One can formulate limits, for each data modality, within which the model
 is a useful approximation to reality.
 
\end_layout

\begin_layout Standard
For some modalities, the two properties linearity and time invariance can
 be explicitly tested by neural recordings (e.g.
 for SCR).
 For other modalities, this is not possible.
 
\end_layout

\begin_layout Standard
Mathematically, the output 
\begin_inset Formula $y\left(t\right)$
\end_inset

 of a LTI system can be fully described by convolving input 
\begin_inset Formula $u(t)$
\end_inset

 with the system’s response function 
\begin_inset Formula $h(t)$
\end_inset

 and can be written as 
\begin_inset Formula 
\[
y(t)=u(t)*h(t)=∫_{0}^{∞}u(t-τ)h(τ)dτ.
\]

\end_inset


\end_layout

\begin_layout Standard
This is the equation for a linear filter.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\family typewriter

\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
 Note: 
\shape default
Convolution is more generally defined by integration over 
\begin_inset Formula $\mathbb{R}$
\end_inset

.
 Integrating over 
\begin_inset Formula $\mathbb{R}^{+}$
\end_inset

 (or alternatively, setting 
\begin_inset Formula $h\left(t\right)=0,\;t<0$
\end_inset

) ensures the causal structure of the model - only past inputs can have
 an effect only into the future, not future inputs into the past.
 It also reflects the implementation via Matlab's vector convolution function,
 
\family typewriter
conv.m
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset

In many cases, the peripheral system is not exactly LTI but can be approximated
 by the combination of several LTI systems.
 The common case is the inclusion of RF derivatives to account for between-subje
ct variability in RF shape and latency, and a special case the combination
 of a dilation and a constriction RF in pupil size modelling.
 In our terminology, the RF then has 
\begin_inset Formula $k$
\end_inset

 
\begin_inset Quotes eld
\end_inset

components
\begin_inset Quotes erd
\end_inset

: 
\begin_inset Formula $h\left(t\right)=h_{1..k}\left(t\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
In such cases, the amplitude estimates for several response functions need
 to be combined.
 In PsPM, this is usually (unless indicated otherwise) done by multiplying
 each component of the RF with its amplitude estimate, and adding them.
 The peak of highest absolute amplitude is then identified, and its signed
 amplitude extracted as estimate of neural input amplitude.
\end_layout

\begin_layout Standard
Signal frequencies in the data that are not present in the RF do not contribute
 to the model inversion and can be filtered out.
 If the true RF were known, the matched filter theorem provides a way of
 theoretically deriving a filter that maximises the signal-to-noise ratio
 for the model inversion.
 In most cases, the true RF is not precisely known, and also varies between
 individuals.
 This is why PsPM seeks to empirically determine the filter characteristics
 that maximise predictive validity of psychological state estimates.
\end_layout

\begin_layout Subsection
Neural models
\end_layout

\begin_layout Standard
The neural model in PsPM describes the form of the neural input that the
 peripheral model can take, and thus, the relation between mind and neural
 system.
 In general, model inversion benefits from constraining the neural model,
 i.e.
 from reducing the number of parameters that have to be estimated.
 We have empirically shown for SCR models that in many cases, a strongly
 constrained neural model will result in higher predictive validity 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa,Bach:2014aa,Staib:2015aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
Most PsPM models assume an instantaneous (delta) neural input into the periphera
l system at a known time point 
\begin_inset Formula $t_{i}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u\left(t\right)=\delta\left(t_{i}\right).
\]

\end_inset

Only the amplitude of the neural input is then estimated, and is taken as
 estimate of the psychological state.
 This renders the model suitable for GLM inversion (see below).
 Less constrained models require non-linear inversion methods and can also
 deal with variable onset, dispersion, or shape, of the neural input.
 
\end_layout

\begin_layout Subsection
Model inversion
\end_layout

\begin_layout Subsubsection
Hierarchical summary statistic approach
\end_layout

\begin_layout Standard
It is common in psychophysiology (and psychology in general) to compute
 summary statistics for each cell of the design, and for each subject.
 These estimates of are then entered into a group-level model.
 To implement this approach, PsPM estimates parameters for each participant
 separately, either per experimental condition, or per trial with subsequent
 averaging within the experimental condition.
 In line with fMRI terminology (and different from many branches of psychology),
 we use the terms 
\begin_inset Quotes eld
\end_inset

first-level
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

second-level
\begin_inset Quotes erd
\end_inset

 for the individual and group level.
\end_layout

\begin_layout Subsubsection
Multi-level modelling
\end_layout

\begin_layout Standard
Multi-level models, also termed linear mixed effects model (LME) or random-effec
t models, are becoming increasingly popular in psychology 
\color black

\begin_inset CommandInset citation
LatexCommand cite
key "Pinheiro:2000aa"
literal "true"

\end_inset

.
 The idea is to take variance between trials into account: a summary statistic
 that is computed from individual data points with high variance is less
 precise that a statistic from low-variance data, and such information is
 lost when summarising within each condition.
 PsPM offers the possibility to compute trial-by-trial estimates (by modelling
 each trial as a separate condition in GLM, or by default in DCM for SCR).
 This approach has been used for SCR, PSR and SEBR 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2017aa"
literal "true"

\end_inset

, see also 
\begin_inset CommandInset citation
LatexCommand cite
key "Homan:2017aa"
literal "false"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "Tzovara:2018aa"
literal "false"

\end_inset

.
 For GLM, modelling trial-by-trial amplitudes and averaging within conditions
 yields the same result as modelling condition-by-condition amplitudes,
 if the design matrix is of full rank and there is only one basis function.
 With more than one basis function, the results will deviate for the second
 and further basis functions in the basis set, because the orthogonalisation
 with the basis set is not a linear operation.
\end_layout

\begin_layout Standard
In theory it would also be possible to account for variability within the
 time series, i.e.
 between data points, not only between trials.
 Such approaches are implemented for fMRI, but they are not trivial.
 First, model inversion is much slower by the inclusion of many subjects.
 Secondly, in the time-series data analysed in PsPM, errors are usually
 not independent.
 This is usually not a problem for parameter estimation but impacts on the
 effective degrees of freedom and thus renders statistical tests in these
 models invalid, and this would apply to multi-level models, too.
 fMRI softwares solve this problem by estimating an auto-regression model
 on the first level but this is usually done on data from many data channels/vox
els, and this is not possible for single-channel data in psychophysiology.
 This is why PsPM does not offer statistical tests on the time-series level.
 For the trial-wise or condition-wise summary statistic approach in PsPM,
 the dependencies between data points on the first level are unproblematic.
\end_layout

\begin_layout Subsubsection
Probabilistic model inversion
\end_layout

\begin_layout Standard
All peripheral and neural models in PsPM are approximations to reality.
 It is hence assumed that there is measurement error (imprecision of the
 peripheral model) 
\begin_inset Formula $\varepsilon$
\end_inset

 in the data, and that the neural input is not truthfully described by the
 neural model such that it contains latent error, 
\begin_inset Formula $\omega$
\end_inset

.
 While this distinction between 
\begin_inset Formula $\varepsilon$
\end_inset

 and 
\begin_inset Formula $\omega$
\end_inset

 is theoretically interesting and often physiologically plausible, the model
 inversion methods collapse these two sources of error:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
y\left(t\right)=\varepsilon\left(t\right)+\left[u\left(t\right)+\omega\left(t\right)\right]*h\left(t\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\varepsilon\left(t\right)+\omega\left(t\right)*h\left(t\right)+u\left(t\right)*h\left(t\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\epsilon\left(t\right)+u\left(t\right)*h\left(t\right).
\]

\end_inset


\end_layout

\begin_layout Subsubsection
General linear convolution model (GLM)
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-linear-convolution"

\end_inset


\end_layout

\begin_layout Standard
Under the assumption of delta neural model, we can harness GLM to estimate
 the neural input amplitude.
 A GLM can be written as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Y=Xβ+\epsilon.
\]

\end_inset

Here, 
\begin_inset Formula $Y$
\end_inset

 is the vector of observations (time series data), 
\begin_inset Formula $β$
\end_inset

 is a vector of input amplitude parameters and 
\begin_inset Formula $\epsilon$
\end_inset

 is the error.
 
\begin_inset Formula $X$
\end_inset

 is design matrix in which each column is obtained by convolving impulse
 functions at known time points (e.g.
 event onsets for one condition) with each component of the RF.
 Each column takes the form:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
X_{ij}\left(t\right)=u_{i}\left(t\right)*h_{j}\left(t\right),
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $u_{i}\left(t\right)$
\end_inset

 is the neural input with unit amplitude for condition 
\begin_inset Formula $i$
\end_inset

, and 
\begin_inset Formula $j$
\end_inset

 is the index of the RF component.
 Finally, 
\begin_inset Formula $X$
\end_inset

 also contains a column for the intercept.
 It is possible to concatenate data from different experimental sessions,
 and an intercept is modelled for each session.
 The maximum-likelihood amplitude estimates are then computed using the
 Moore-Penrose pseudoinverse 
\begin_inset Formula $X^{+}$
\end_inset

, implemented in the Matlab function 
\family typewriter
pinv.m
\family default
: 
\begin_inset Formula 
\[
\hat{β}=X^{+}Y.
\]

\end_inset


\end_layout

\begin_layout Standard
This allows to deal with situations in which 
\begin_inset Formula $X$
\end_inset

 is not of full rank.
\end_layout

\begin_layout Subsubsection
Non-linear model inversion
\end_layout

\begin_layout Standard
Models in which timing and/or dispersion of the neural input need to be
 estimated require non-linear model inversion.
 PsPM contains several efficient non-linear model inversion methods:
\end_layout

\begin_layout Itemize
a Variational Bayes (VB) algorithm 
\begin_inset CommandInset citation
LatexCommand cite
key "Daunizeau:2009aa"
literal "true"

\end_inset

 for dynamic systems.
 This can be applied either to an entire data set, or on a trial-by-trial
 basis, and requires the peripheral system to be written in the form of
 an ordinary differential equation (ODE).
\end_layout

\begin_layout Itemize
a Matching Pursuit algorithm that provides a fast approximation to the VB
 inversion for some models
\end_layout

\begin_layout Section
Skin conductance (SCR) models
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
SCR arise from opening of sweat glands and are elicited via the sympathetic
 nervous system with negligible parasympathetic transmission (see 
\begin_inset CommandInset citation
LatexCommand cite
key "boucsein:2012"
literal "true"

\end_inset

 for the physiology of SCR).
 Nerve fibres carrying impulses to the sweat glands are termed 
\begin_inset Quotes eld
\end_inset

sudomotor nerve
\begin_inset Quotes erd
\end_inset

 (SN) fibres and can be measured by intraneural recordings.
 SN fibres are slow C-fibres.
 From their end terminal, the neurotransmitter Acetylcholine diffuses through
 the skin to reach sweat glands, a process on the time scale of up to a
 second.
 
\end_layout

\begin_layout Standard
The frequency and amplitude of SCR is mainly influenced by psychological
 arousal.
 Because not all forms of psychological arousal may influence SCR in the
 same way, we term the relevant psychological state 
\begin_inset Quotes eld
\end_inset

sympathetic arousal
\begin_inset Quotes erd
\end_inset

 (SA).
 Hence, the PsPM model is 
\begin_inset Formula $SA\mapsto SN\mapsto SCR$
\end_inset

.
\end_layout

\begin_layout Subsection
Peripheral LTI model
\end_layout

\begin_layout Subsubsection
Model evaluation
\end_layout

\begin_layout Standard
The peripheral LTI model can be evaluated explicitly (by intraneural recordings
 or stimulation) and implicitly (by assessing properties of the model 
\begin_inset Formula $SA\mapsto SN\mapsto SCR$
\end_inset

, an approach that collapses LTI violations with imprecision in the neural
 model).
 
\end_layout

\begin_layout Paragraph*
Time invariance: the system's response does not explicitly depend on time,
 or in other words, a given input always produces the same output.
 
\end_layout

\begin_layout Itemize
Direct evidence: The amplitude of individual SN bursts is linearly related
 to the amplitude of ensuing SCR, with a considerable scatter 
\begin_inset CommandInset citation
LatexCommand cite
key "Bini:1980aa"
literal "true"

\end_inset

; to the maximal rate of sweat expulsion; and, somewhat more weakly, to
 the integrated sweat production during the skin response 
\begin_inset CommandInset citation
LatexCommand cite
key "Sugenoya:1990aa"
literal "true"

\end_inset

.
 After initial dishabituation, constant SN stimulation leads to SCR, with
 constant amplitude and latency 
\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1991aa"
literal "true"

\end_inset

.
 Repeated SN stimulation yields slightly different SCR shapes 
\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1992aa"
literal "true"

\end_inset

, although this could be due to variation in elicited neural responses that
 were not measured downstream.
 In summary, these findings are consistent with (but do not prove or disprove)
 the time invariance principle.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Gerster:2017aa"
literal "true"

\end_inset

 re-analysed data 
\color black
from an experiment in which brachial sudomotor neves were regularly stimulated
 under thoracic block and SCR recorded 
\color inherit

\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1991aa,Kirno:1991aa"
literal "true"

\end_inset


\color black
.
 They found that for stimulation rates below 0.6 s (1 stimulus every 1.7 s)
 around 95% of variance could be explained by an LTI model.
 
\end_layout

\begin_layout Itemize
Indirect evidence: We have shown that for short events (< 1 s duration)
 that are separated by at least 30 s, more than 60% of the variance in (high
 pass filtered) SCR can be explained under an LTI model, for aversive white
 noise bursts, aversive electric stimulation, aversive pictures, auditory
 oddballs, and a visual detection task 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

.
 Is this residual variance (40%) due to violations of the LTI assumptions?
 We have shown that in the absence of any event for 60 s, signal variance
 amounts to more than 60% of total variance during stimulus presentation.
 That is to say, by introducing events, residual baseline variance is reduced
 by 20%.
 This suggests that residual variance is not caused by violations of the
 time invariance assumption but variation of the neural input (for example,
 spontaneous fluctuations), and observation error.
 
\end_layout

\begin_layout Paragraph
Linearity: the system's response does not depend on previous inputs.
 
\end_layout

\begin_layout Itemize
Direct evidence: Latency of sweat expulsion is slightly shortened when sweat
 expulsion rate is very high (i.
 e.
 for very strong SN bursts) but not when SN firing is frequent 
\begin_inset CommandInset citation
LatexCommand cite
key "Sugenoya:1990aa"
literal "true"

\end_inset

.
 SCR to individual SN stimulations depend linearly on skin conductance level,
 and are slightly suppressed upon repetition of the stimulation after 1
 s 
\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1992ab"
literal "true"

\end_inset

.
 This suggests that the linearity principle does not hold under all conditions
\color black
.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Gerster:2017aa"
literal "true"

\end_inset

 
\color inherit
re-analysed data 
\color black
from an experiment in which brachial sudomotor neves were regularly stimulated
 under thoracic block and SCR recorded 
\color inherit

\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1991aa,Kirno:1991aa"
literal "true"

\end_inset


\color black
.
 They found that for stimulation rates above 0.6 s (1 stimulus every 1.7 s),
 the response function looked very different from lower frequencies, suggesting
 non-linearities at that stimulation frequency.
 They did not quantitatively characterise these non-linearities.
\end_layout

\begin_layout Itemize
Indirect evidence: The linearity principle amounts to saying that SCR are
 not influenced by the (preceding) baseline signal.
 We tested this assumption by presenting two subsequent aversive white noise
 bursts with an inter stimulus interval (ISI) of either 2 s, 5.5 s, or 9
 s, such that the baseline signal at these three time points differed markedly.
 Violations of the linearity principle in the peripheral system would imply
 that the amplitude of the subsequent response is dependent on the baseline
 signal, and thereby, upon the ISI.
 The second response was always smaller than the first.
 However, this was not dependent on the ISI, and hence not on the baseline
 signal.
 We interpret this effect as central repetition suppression (of the neural
 inputs into the peripheral system) and conclude that linearity is appropriate
 for the peripheral system.
 In other words, the peripheral response to one input is not modulated or
 affected by the response to another, even when they overlap in time 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph

\series bold
Model limits
\end_layout

\begin_layout Standard
Both properties appear good approximations to reality as long as the time
 interval between two SN firing bursts is not very short (< 2 s) or when
 the SN firing burst is not extremely strong.
 It would be possible to model non-linearities in a linear model, using
 Volterra kernels, as in the analysis of functional magnetic resonance images
 in the software SPM 
\begin_inset CommandInset citation
LatexCommand cite
key "Friston:1998aa,Friston:2000aa"
literal "true"

\end_inset

.
 Such possibility is however not implemented in PsPM.
 
\end_layout

\begin_layout Subsubsection
Skin Conductance Response Function (SCRF)
\end_layout

\begin_layout Standard
The peripheral model in its general form does not specify a particular form
 of the SCRF.
 There are three principled ways of defining a SCRF in PsPM:
\end_layout

\begin_layout Enumerate
Individual response function.
 The most precise option is to measure the SCRF for each individual by providing
 brief inputs into the peripheral system and measuring the response.
 PsPM allows specifying individual response functions.
 The benefit of this approach has not been empirically tested.
\end_layout

\begin_layout Enumerate
Canonical response function.
 The most parsimonious method is to use a so-called canonical SCRF which
 is assumed to be constant across individuals.
 We have previously shown that a canonical SCRF can explain on average 50%
 of the variance in individual SCR elicited by various stimuli, while individual
 SCRFs explain about on average 75% of the variance 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

.
 Using a canonical SCRF, linear and non-linear models show a good predictive
 validity, superior to peak-scoring methods 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa,Staib:2015aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Enumerate
Constrained response function.
 One can estimate an SCRF from the data of an actual experiment and use
 this for analysis.
 It is usually necessary to constrain the shape of the SCRF to make the
 model estimable.
 PsPM provides two options for this: 
\end_layout

\begin_layout Itemize
In GLM, one can estimate parameters of the (orthogonalised) time derivative
 of the SCRF.
 In order to combine this with the canonical SCRF, the response can afterwards
 be reconstructed for each experimental condition, and the peak amplitude
 taken as estimate of SA.
 This approach has higher predictive validity than using the canonical SCRF
 alone, or using a less constrained SCRF (canonical with time and dispersion
 derivative) 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Itemize
In the non-linear model for event-related SCR, one can use the combined
 data from all evoked responses from one individual to estimate an SCRF.
 This approach only considers data within the inter-trial interval.
 In a validation experiments study with ITI of 7-11 s, this had lower predictive
 validity than using the canonical SCRF, and we would not recommend it unless
 the ITI is longer than 20 s, so that the SCRF tail can be unambigouosly
 estimated 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph
Canonical Skin Conductance Response Function
\end_layout

\begin_layout Standard
The canonical SCRF that is currently implemented was derived from a large
 dataset of 1278 SCRs from 64 individuals subjected to different experimental
 manipulations (white noise 85 dB and 95 dB, painful electric stimulation,
 aversive IAPS pictures, detection of auditory oddballs, detection of a
 visual target in a stimulus stream).
 We extracted and mean-centred the 30 s following each stimulus onset and
 performed a principal component analysis.
 The first principal component served as empirical SCRF 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph*
Formulation for linear models
\end_layout

\begin_layout Standard
The first PCA component of the empirical SCRF was approximated was fitted
 by a Gaussian smoothed bi-exponential function (also named bi-exponentially
 modified Gaussian function), and this provided better fit than other function
 categories, in particular Gaussian smoothed monoexponential function, exponenti
al-Gaussian hybrid function, or smoothed sigmoid-exponential function.
 The function is thus defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
h\left(t\right)\propto\int_{0}^{t}N\left(t-\tau\right)\left(E_{1}\left(\tau\right)+E_{2}\left(\tau\right)\right)d\tau\:,\:t\geqslant0,\label{eq:SCRFcan}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
N\left(t\right)=\frac{1}{\sqrt{2\pi\sigma}}e^{-\left(t-t_{0}\right)^{2}/2\sigma^{2}},
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E_{i}\left(t\right)=e^{-\lambda_{i}t},
\]

\end_inset


\end_layout

\begin_layout Standard
with estimated parameters: 
\begin_inset Formula $\hat{t}_{0}=3.0745$
\end_inset

 seconds for peak latency; 
\begin_inset Formula $\hat{\sigma}=0.7013$
\end_inset

 for definition of the rise time; 
\begin_inset Formula $\hat{\lambda}_{1}=0.3176$
\end_inset

 and 
\begin_inset Formula $\hat{\lambda}_{2}=0.0708$
\end_inset

 to define the two decay components.
 This function is normalised to its maximum such that an infinitely short
 SN impulse with unit amplitude elicits an SCR with unit amplitude.
 This renders parameter estimates from linear models easily interpretable
 in relation to conventional (peak-scoring) analysis.
 
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
Historical remarks:
\shape default
 
\end_layout

\begin_layout Plain Layout
(a) The appendix of 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

 contains a typographic error in the definition of the canonical response
 function, in particular in the integration limits of eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SCRFcan"

\end_inset

).
 However, in all versions of the software (PsPM 1.0-now) the canonical SCRF
 was constructed using the Matlab function 
\family typewriter
conv()
\family default
 which defines vector convolution analogous to the integral defined above.
 This implementation has not changed since the initial formulation of the
 model.
\end_layout

\begin_layout Plain Layout
(b) The initial formulation of the SCRF 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2009aa"
literal "true"

\end_inset

 used a Gaussian-smoothed Gamma distribution, based on a smaller dataset.
 In the extended data set published in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

, the polynomial part of the Gamma distribution was estimated to be one,
 resulting in a Gaussian smoothed exponential function.
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
\begin_inset VSpace defskip
\end_inset

Formulation for non-linear models
\end_layout

\begin_layout Standard
An alternative formulation is provided for non-linear models which require
 a definition of the SCRF in the form of an inhomogeneous ordinary differential
 equation (ODE).
 We use an third-order linear ODE to describe the data 
\begin_inset Formula $y\left(t\right)$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dddot{y}+\vartheta_{1}\ddot{y}+\vartheta_{2}\dot{y}+\vartheta_{3}y-u\left(t-\vartheta_{4}\right)=0;\label{eq:ODE}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where dot notation is used for time derivatives, and this formulation embeds
 convolution of the SCRF with the SN time series.
 Parameters were estimated from the empirical SCRF by using a Gaussian bump
 as canonical SN input (see section on SN below) as 
\begin_inset Formula $\hat{\vartheta}_{1}=1.342052$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{2}=1.411425$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{3}=0.122505$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{4}=1.533879$
\end_inset

.
 Amplitude of the response function is rescaled such that a canonical Gaussian
 bump SN impulse with unit amplitude elicits an SCR with unit amplitude.
\end_layout

\begin_layout Paragraph*
Formulation for spontaneous fluctuations
\end_layout

\begin_layout Standard
For modelling spontaneous fluctuations (SF), a different database was used
 that contained 1153 semi-automatically detected SF from 40 male participants
 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ac"
literal "true"

\end_inset

 The first PCA component was taken as empirical SCRF which has slightly
 different shape than the empirical SCRF for evoked responses.
 A number of reasons may account for this difference, from participant selection
 over data pre-conditioning to differences in the canonical SN input.
 In the absence of further knowledge about the reason for this difference,
 we propose to use this empirical response function for SF.
 We estimated the ODE parameters (eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ODE"

\end_inset

): 
\begin_inset Formula $\hat{\vartheta}_{\text{1}}=2.1594$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{2}=3.9210$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{3}=0.9235$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{4}=1.533879$
\end_inset

 seconds.
 Amplitude of the response function is rescaled such that a canonical Gaussian
 bump SN impulse with unit amplitude elicits an SF with unit amplitude.
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
Note: 
\shape default
In the Matlab implementation, the third order ODE is converted to a 3-dimensiona
l system of first-order ODEs.
 In that process, the order of the parameters 
\begin_inset Formula $\vartheta_{1..3}$
\end_inset

 is reversed, and they are renamed.
 With substitutions 
\begin_inset Formula $y_{1}=y$
\end_inset

, 
\begin_inset Formula $y_{2}=\dot{y}$
\end_inset

, 
\begin_inset Formula $y_{3}=\ddot{y}$
\end_inset

, the ODE becomes:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\begin{array}{c}
\dot{y}_{1}=y_{2}\\
\dot{y}_{2}=y_{3}\\
\dot{y}_{3}=-\vartheta_{1}y_{3}-\vartheta_{2}y_{2}-\vartheta_{3}y_{1}+u\left(t-\vartheta_{4}\right)
\end{array}.
\]

\end_inset


\end_layout

\end_inset

 
\end_layout

\begin_layout Paragraph*

\series bold
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Neural model and model inversion
\end_layout

\begin_layout Subsubsection
Physiological evidence
\end_layout

\begin_layout Standard

\color black
\begin_inset CommandInset citation
LatexCommand cite
key "Gerster:2017aa"
literal "true"

\end_inset

 
\color inherit
recorded from C-fibres in the superficial branch of the common peroneal
 nerve proximal to the ankle, while participants heard loud sounds, or responsed
 to oddball sounds.
 They found that the average SN response was well described by a Gaussian
 bump with 0.25 - 0.30 s standard deviation.
 PsPM models SN bursts as a Gaussian bump with 0.30 s standard deviation.
\end_layout

\begin_layout Subsubsection
General Linear Model (GLM) for evoked SA
\end_layout

\begin_layout Standard
This model was developed for experiments in which short experimental events
 with evoke SA with amplitude 
\begin_inset Formula $a$
\end_inset

.
 For each experimental condition 
\begin_inset Formula $i$
\end_inset

 with onset vector 
\begin_inset Formula $t_{o_{i}}$
\end_inset

, we assume 
\begin_inset Formula $u_{i}\left(t\right)=a_{i}\delta\left(t_{o_{i}}\right)$
\end_inset

.
 See 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

 for details on the model inversion.
 
\end_layout

\begin_layout Subsubsection
Non-linear model (DCM) for event-related SA
\end_layout

\begin_layout Standard
This model 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010aa"
literal "true"

\end_inset

 assumes that event-related SA with amplitude 
\begin_inset Formula $a$
\end_inset

 causes a Gaussian bump-like SN firing burst after some delay and with a
 specified dispersion.
 For each experimental event:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u_{exp}\left(t\right)=a\exp\frac{-\left(t-\mu\right)^{2}}{2\sigma^{2}}+\omega,\:0<\mu<\mu_{max},\:\sigma_{min}<\sigma<\sigma_{max}.
\]

\end_inset


\end_layout

\begin_layout Standard
For situations in which short external stimuli elicit SA, this model uses
 a canonical central burst latency of zero and dispersion of 
\begin_inset Formula $\sigma_{e}=0.3$
\end_inset

 seconds (
\begin_inset Quotes eld
\end_inset

fixed response
\begin_inset Quotes erd
\end_inset

).
 For situations in which central processes translate SA into SN with unknown
 parameters, latency and dispersion are estimated from the data, alongside
 the SA amplitude, using the following constraints: 
\begin_inset Formula $\sigma_{min}=0.1$
\end_inset

, 
\begin_inset Formula $\sigma_{max}=0.5\mu_{max}$
\end_inset

 where 
\begin_inset Formula $\mu_{max}$
\end_inset

 is the maximally allowed response latency (
\begin_inset Quotes eld
\end_inset

flexible response
\begin_inset Quotes erd
\end_inset

).
\end_layout

\begin_layout Standard
The full model also accounts for spontaneous fluctuations (next subsection)
 and baseline changes between trials and can be written as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
y\left(t\right)=y_{exp}\left(t\right)+y_{SF}\left(t\right)+y_{SCL}\left(t\right)+\epsilon
\]

\end_inset


\end_layout

\begin_layout Standard
The SCR components are defined by eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ODE"

\end_inset

) with respective parameters and a respective input function 
\begin_inset Formula $u\left(t\right)$
\end_inset

.
 Specifically, the experimental SCR component models evoked and event-related
 responses, and the SF component models spontaneous fluctuations between
 trials (part of the latent error).
 The SCL term is an explicitly modelled error term that absorbs baseline
 fluctuations and is defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u_{SCL}\left(t\right)=a\exp\frac{-\left(t-\mu\right)^{2}}{2\sigma^{2}},\:\sigma=\sigma_{0}
\]

\end_inset


\end_layout

\begin_layout Standard
where dispersion is set to 
\begin_inset Formula $\sigma_{0}=1.0$
\end_inset

 seconds, and 
\begin_inset Formula $\mu$
\end_inset

 is estimated from the data.
 By default, PsPM automatically mdoels SN bursts that occur more than 5
 s after the previous trial, and more than 2 s before the next trial.
 These limits ensure that the modelled SCL and SF do not absorb variance
 caused by the experiment.
 The use of different limits has not empirically been tested.
\end_layout

\begin_layout Standard
In this model, the parameter space is too large to invert it at once.
 Inversion is done in a trial-by-trial approach: a number of trials, 
\begin_inset Formula $T_{1..n}$
\end_inset

 is inverted.
 The ensuing parameter estimates for 
\begin_inset Formula $T_{1}$
\end_inset

 are extracted, and the parameter estimates for 
\begin_inset Formula $T_{2..n}$
\end_inset

 are used as prior values for the next inversion for trials 
\begin_inset Formula $T_{2..n+1}$
\end_inset

 where the estimated hidden state values at the start of trial 2 are taken
 as starting values of the hidden states 
\begin_inset Formula $x$
\end_inset

.
 This is continued until all trials have been estimated.
 This scheme ensures that inversion is kept tractable, and at the same time
 overlapping responses are taken into account.
 It also means that estimation errors accumulate over trials which is why
 part of the latent error is explicitly modelled as SF and SCL.
 At an inter trial interval of around 10 seconds, inverting 2 or 3 trials
 at the same time yields comparable predictive validity 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Subsubsection
Non-linear model for tonic SA (spontaneous fluctuations, SF)
\end_layout

\begin_layout Standard
Spontaneous SN bursts cause spontaneous fluctuations (SF) in skin conductance.
 The number of spontaneous SN bursts is thought to depend on SA.
 Each spontaneous SN burst is modelled as a Gaussian bump with unknown timing
 and amplitude and fixed dispersion.
 For each spontaneous SF burst:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u_{SF}=a\exp\frac{-\left(t-\mu\right)^{2}}{2\sigma^{2}}+\omega,\:\sigma=\sigma_{0},\:a>0
\]

\end_inset


\end_layout

\begin_layout Standard
The dispersion is set to 
\begin_inset Formula $\sigma_{0}=0.3$
\end_inset

 seconds.
 This model is inverted using a Variational Bayes algorithm 
\begin_inset CommandInset citation
LatexCommand cite
key "Daunizeau:2014aa,Daunizeau:2009aa"
literal "true"

\end_inset

.
 Because the number of SN bursts is difficult to estimate directly, the
 SF model inversion uses a fixed rate of SN bursts (set to 
\begin_inset Formula $f=0.5$
\end_inset

 Hertz by default) the amplitude of which is estimated from the data.
 An amplitude threshold is defined to separate 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 SN bursts from noise.
 An amplitude threshold of 0.1 µS rendered the predictive highest validity
 in a validation paper 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2011a"
literal "true"

\end_inset

.
 The results from this paper have been replicated in an unpublished re-analysis
 using AIC as objective function in a manner similar to 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
 Re-analysing the second data set described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2011a"
literal "true"

\end_inset

, the optimal threshold was between 0.15 - 0.20 µS.
 Further systematic research is needed to fine tune the optimal threshold.
 
\end_layout

\begin_layout Standard
Furthermore, PsPM uses a Matching Pursuit (MP) algorithm as fast (< 1 s
 per minute of data) approximation to the DCM inversion (ca.
 1 min.
 per minute of data).
 Using simulated data, this method was less precise, but empirically it
 was comparable to DCM results in three different data sets 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2015aa"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Subsection
Data conditioning
\end_layout

\begin_layout Subsubsection
Filtering
\end_layout

\begin_layout Standard
Skin conductance signals return to a baseline after an SCR, but this baseline
 can change over time within a large dynamic range.
 Such fluctuations of the skin conductance level need to be filtered out
 to make the data accessible to an LTI model.
 A unidirectional 1st order Butterworth high pass filter with cut off frequency
 0.05 Hz was optimal for GLM 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
 The design matrix of the GLM is filtered with the same frequency to account
 for distortions of response shape.
 For the non-linear model (DCM) for event-related responses, an optimal
 filter frequency was found at 0.0159 Hz when using a canonical SCRF and
 inversion of 2 trials at the same time 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
 Filter characteristics of SF models have not been investigated.
 In order to reduce computation load, data are resampled to 10 Hz sampling
 rate for all data analyses which requires a low-pass filter cut off frequency
 of 5 Hz.
 
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
Historical remark:
\shape default
 The SCRF was developed using a high pass filter with cut off frequency
 of 0.0159 Hz as commonly employed in conventional analysis (bidirectional
 for phasic responses, unidirectional for spontaneous fluctuations).
 However, this turned out to not be the optimal filter for GLM in follow-up
 analyses of optimal data conditioning.
 Note that the canonical SCRF was developed from data filtered with the
 original settings, and this has not changed since.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
Normalisation
\end_layout

\begin_layout Standard
For within-subjects analysis, we propose data normalisation after filtering
 to remove SCR scaling differences due to peripheral factors such as skin
 property.
 This increases predictive validity (unpublished analyses).
 For methods that yield trial-by-trial estimates, post-hoc normalisation
 of amplitude estimates across trials, before averaging within conditions,
 yields even better predictive validity 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
 For between-subjects analysis, this is not an option as it removes between-subj
ects variance.
 
\end_layout

\begin_layout Subsection
Implicit estimates of tonic sympathetic arousal
\end_layout

\begin_layout Standard
Our model for SF implies that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\int_{I}\left[y\left(t\right)-y_{0}\right]dt\propto\overset{n}{\underset{i=1}{\sum}}a_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $I$
\end_inset

 is a time interval, and 
\begin_inset Formula $a_{1..n}$
\end_inset

 are the amplitudes of the 
\begin_inset Formula $n$
\end_inset

 sudomotor bursts in this interval and 
\begin_inset Formula $y_{0}$
\end_inset

 is the skin conductance level at rest.
 That is, by simply taking the time integral, or area under the curve (AUC),
 of the baseline-corrected data, we get a measure of the number x amplitude
 of spontaneous SN bursts 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ac"
literal "true"

\end_inset

.
 This measure is implemented in the software as well.
 However, we have subsequently shown that the number of spontaneous SN bursts
 is a better predictor of tonic SA than AUC, and hence we recommend to use
 the non-linear model for tonic SA.
 
\end_layout

\begin_layout Subsection
Comparison with other model-based methods for SCR
\end_layout

\begin_layout Standard
Several further approaches to model-based analysis of SCR have been introduced
 in the literature 
\begin_inset CommandInset citation
LatexCommand cite
key "Lim:1997aa,Alexander:2005aa,Benedek:2010ab,Benedek:2010aa,Greco:2014aa"
literal "true"

\end_inset

 - for one of them, the implementation is publicly available in the software
 package Ledalab.
 In this method, SN is calculated from SCR using a deterministic inverse
 filter.
 Peaks in the SN time series are then identified and used as operational
 index of SA.
 In a head-to-head comparison, predictive validity to identify states with
 known SA was compared for experiments involving short stimuli and evoked
 SA.
 PsPM had better predictive validity than Ledalab in 4 out of 5 tested contrasts
, and equal validity in the fifth.
 Ledalab did not consistently perform superior to classical peak scoring
 analysis 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2014aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design: 
\end_layout

\begin_deeper
\begin_layout Itemize
SOA > 2 s between events eliciting SCR.
 SCR amplitudes appear to be linear with an SOA of 3.5 s between subsequent
 stimuli 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

 and non-linear with SOA < 1 s 
\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1992ab"
literal "true"

\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Itemize
Model set up:
\end_layout

\begin_deeper
\begin_layout Itemize
Use GLM wherever possible.
 GLM is more sensitive than non-linear models in evoked SCR paradigms 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Itemize
Use default filter frequencies (0.05 - 5 Hz unidirectional filter for GLM
 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

; 0.0159 - 5 Hz bidirectional filter for non-linear model 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

).
\end_layout

\begin_layout Itemize
GLM: include all experimental events that evoke SCR (including block starts,
 break messages, etc.).
\end_layout

\begin_layout Itemize
GLM: canonical SCRF with time derivative and reconstruction of amplitudes
 is more sensitive than just canonical SCRF, or SCRF plus time and dispersion
 derivative 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
 The benefit of subject-specific SCRFs has not been tested.
\end_layout

\begin_layout Itemize
non-linear model: canonical SCRF is more sensitive than using subject-specific
 SCRFs based on short (~ 10 s) ITIs 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
 The use of individual SCRFs based on long ITI paradigms has not been tested.
\end_layout

\begin_layout Itemize
non-linear model: for fear conditioning paradigms, the best way of modelling
 anticipatory SCR is currently under investigation.
 It is possibly suboptimal to model one anticipatory 
\begin_inset Quotes eld
\end_inset

flexible
\begin_inset Quotes erd
\end_inset

 response, in particular at longer CS/US SOAs when this flexible response
 may absorb SCR elicited by US or US omission.
\end_layout

\begin_layout Itemize
GLM and non-linear model: z-normalisation of data is recommended for within-subj
ects designs, and should not be used for between-subjects designs.
\end_layout

\end_deeper
\begin_layout Itemize
Model inversion:
\end_layout

\begin_deeper
\begin_layout Itemize
SF model: the VB inversion is theoretically better suited than the MP inversion
 when the expected number of SF is > 10/minute.
\end_layout

\end_deeper
\begin_layout Itemize
Post-processing
\end_layout

\begin_deeper
\begin_layout Itemize
non-linear model: trial-by-trial normalisation of amplitude estimates before
 averaging within conditions can increase sensitivity in within-subjects
 designs 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

 but should not be used in between-subjects designs.
\end_layout

\end_deeper
\begin_layout Section
Heart Period (HP) Models
\end_layout

\begin_layout Standard

\shape italic
contributed by Philipp C.
 Paulus and Giuseppe Castegnetti, and edited by Dominik R.
 Bach
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
Cardiac rhythm is generated locally in the sinoatrial node, but is modulated
 by central neural input.
 Therefore, heart rhythm can be used to infer psychological states.
 To quantify phasic changes in cardiac chronotropy, two measures are common:
 heart rate (beats per minute) or heart period (milliseconds).
 Heart period appears to relate to autonomic input linearly, as revealed
 in experiments in which autonomic nerves in rodents were electrically stimulate
d with varying frequencies to elicit heart period changes 
\begin_inset CommandInset citation
LatexCommand cite
key "Berntson:1995"
literal "true"

\end_inset

.
 This is why PsPM models heart period.
 Heart period information is only available at discrete time points.
 To facilitate analysis within the existing algorithms, PsPM assigns each
 heart period to its following heartbeat and linearly interpolates this
 time series at 10 Hz resolution.
 
\end_layout

\begin_layout Standard
For the analysis of event-related, i.e.
 phasic cardiac responses, PsPM includes two models: A model for event-related
 HPR 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

 and a model for fear-conditioned bradicardia 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

.
 As in previous models for Skin Conductance Responses (SCR), both models
 are optimised with regard to 
\shape italic
predictive validity
\shape default
, i.e.
 the ability to separate experimental conditions (e.g., CS+ vs.
 CS-).
\end_layout

\begin_layout Standard
Operational analysis has shown that event-related HPR pattern strongly depends
 upon properties of the input - i.e.
 modality, intensity and presentation duration of the stimulus material.
 It follows that both models can only be applied in experiments with similar
 conditions, including stimulus presentation times (i.e.
 
\begin_inset Formula $\leq$
\end_inset

 1 s for event-related HPR).
 Pharmacological studies have suggested a differential time course of sympatheti
c and parasympathetic nervous input, but it is not yet known how this maps
 onto the response components modelled here.
\end_layout

\begin_layout Subsection
Peripheral and neural model
\end_layout

\begin_layout Standard
In the absence of information on the timecourse of cardiac information,
 it is difficult to separate a neural and a peripheral model.
 Hence, these two are collapsed for the purpose of quick and simple inversion
 with GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

).
 This means that the two implemented models - for evoked HRP and fear-conditione
d HRP - use a different RF, although of course the peripheral system is
 the same in both cases.
 Castegnetti et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

 relate the two models to each other, and derived the neural input producing
 fear-conditioned bradycardia (see figure 1 of 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

).
\end_layout

\begin_layout Subsection
Model for event-related HPR
\end_layout

\begin_layout Standard
The model for event-related HPR 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

 was developed on data from 84 participants that underwent three different
 experiments: An experiment using loud white noise sounds (
\begin_inset Formula $\sim85dB$
\end_inset

), an experiment using an auditory oddball task, and an experiment using
 emotional pictures from the International Affective Picture System (IAPS;
 
\begin_inset CommandInset citation
LatexCommand cite
key "Bradley:2001"
literal "true"

\end_inset

).
 All stimuli were presented with long ITIs (> 30 s) to allow the cardiac
 system to return to baseline after stimulus presentation and avoid overlapping
 responses.
 The first three principal response components were extracted, and individual
 peaks fitted with Gaussian Functions as RF:
\begin_inset Formula 
\begin{equation}
h\left(y\right)=\frac{1}{\sigma\sqrt{2\pi}}e^{\frac{-(t-\mu)^{2}}{2\sigma^{2}}}\label{eq:Gaussian}
\end{equation}

\end_inset

To test whether a modeled peak qualified as a RF, we tested whether it explained
 interesting variance in the data.
 We started with a single RF and included further RFs.
 Specifically, we created a first-level GLM for each participant by convolving
 the event onsets with the specific subset of RFs, and extracted estimates
 of the response amplitudes for each RF and condition from the continuous
 heart period data.
 In order to qualify as RF, parameter estimates for this RF were either
 required to depict a stable response (i.e., acceleration or deceleration)
 across all experiments, tested by a one-sample t-test, or to add to the
 
\shape italic
predictive validity
\shape default
 of the model.
 This second criterion was evaluated by subjecting the parameter estimates
 to a between-subject analysis of variance (ANOVA) testing for a main effect
 of experimental condition.
\begin_inset Newline newline
\end_inset

 Hence, the following steps were taken: 
\begin_inset Newline newline
\end_inset

 
\begin_inset space \hspace*{}
\length 10mm
\end_inset


\series bold
Step 1.

\series default
 Test all potential RFs modeled from PCs individually and retain each single
 RF if it depicts a stable acceleration or deceleration across all experiments
 or if it allows separation of at least two of the three experiments.
 All potential RFs fulfilled one of these criteria.
 
\begin_inset Newline newline
\end_inset

 
\begin_inset space \hspace*{}
\length 10mm
\end_inset


\series bold
Step 2.

\series default
 Take the chronologically first RF from Step 1 and combine it with the chronolog
ically second RF from Step 1, or with any other RF that overlaps with this
 second RF.
 Orthogonalize each set in temporal order, using a Gram-Schmidt algorithm.
 Retain the best set if additional RFs allow the separation of the three
 experiments.
 
\begin_inset Newline newline
\end_inset

 
\begin_inset space \hspace*{}
\length 10mm
\end_inset


\series bold
Step 3-5.

\series default
 Take the current set, and add the chronologically next untested RF from
 Step 1, or any other RF that overlaps in time with this second RF.
 Repeat the strategy of Step 2, and retain the best set if additional RFs
 allow the separation of the three experiments.
 
\begin_inset Newline newline
\end_inset

 This testing procedure yielded a basis set of six RFs.
 Model constants are depicted in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:model_constants_HPR"

\end_inset

.
 
\begin_inset Newline newline
\end_inset

 In an independent model-validation experiment with short ISI (10 s) that
 used white-noise sounds of varying intensities (
\begin_inset Formula $\sim$
\end_inset

85 vs.
 
\begin_inset Formula $\sim$
\end_inset

65 dB) and both negative and positive pictures from the International Affective
 Picture System (IAPS; 
\begin_inset CommandInset citation
LatexCommand cite
key "Bradley:2001"
literal "true"

\end_inset

), the following RFs allowed separation of the different experimental conditions
:
\begin_inset Newline newline
\end_inset

 RF1 allowed the discrimination of 85 dB white-noise sounds and IAPS pictures
 as well as Positive and Negative IAPS pictures.
 RF2 allowed the discrimination of 85 dB and 65 dB white-noise sounds, as
 well as Positive and Negative IAPS pictures.
 RF3 allowed the discrimination of Negative and Positive IAPS pictures.
 RF4 did not allow discrimination of any experimental conditions in the
 validation experiment, but showed a trend to significance for the discriminatio
n of 85 dB white-noise sounds and IAPS pictures (
\begin_inset Formula $p=.051$
\end_inset

) and a trend for discrimination of Positive and Negative IAPS pictures
 (
\begin_inset Formula $p=.068$
\end_inset

).
\end_layout

\begin_layout Standard
\noindent
\begin_inset Float table
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Model constants for evoked HPR 
\end_layout

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Response Function (RF)
\series default
 
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameters of Gaussian Function
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.9 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.9 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7.2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.5 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7.2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12.6 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18.85 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.8 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
Note.

\shape default
 
\begin_inset Formula $\mu=$
\end_inset

mean; 
\begin_inset Formula $\sigma=$
\end_inset

 standard deviation
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:model_constants_HPR"

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Because the data are interpolated, apparent responses to stimuli can start
 before stimulus presentation.
 This is evident in these RFs some of which overlap time point 0 and therefore
 start before the actual stimulus.
 In PsPM this phenomenon is automatically accounted for.
\end_layout

\begin_layout Subsection
Model for fear-conditioned HPR
\end_layout

\begin_layout Standard

\color black
For the analysis of fear conditioned HPR, we sought to build a data-driven
 RF for discriminating between HPR to CS+ and CS- 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

.
 This model-based analysis was developed on the basis of four independent
 data sets, acquired during diverse implementations of a fear conditioning
 protocol.
 The shape of the response was determined by visually identifying a gamma
 distribution as the function that qualitatively best resembled the difference
 between grand means.
 This function 
\begin_inset Formula 
\[
y=\frac{A}{\Theta^{k}\Gamma(k)}(x-x_{0})^{k-1}e^{-\frac{x-x_{0}}{\Theta}}
\]

\end_inset


\end_layout

\begin_layout Standard

\color black
was fitted it by finding the values of the shape parameter 
\begin_inset Formula $k$
\end_inset

, the scale parameter Θ, the time onset 
\begin_inset Formula $x_{0}$
\end_inset

 and the amplitude 
\begin_inset Formula $A$
\end_inset

 that minimised the residual sum of squares (RSS)
\color inherit
.
 The resulting parameters were 
\begin_inset Formula $k=1373$
\end_inset

, 
\begin_inset Formula $\Theta=0.0311$
\end_inset

, 
\begin_inset Formula $x_{0}=-38$
\end_inset

, with 
\begin_inset Formula $A$
\end_inset

 left free to vary during the model inversion.
 Shifts in the response are modelled by its first time derivative.
 The ensuing model-based analysis reliably distinguishes HPR to CS+ and
 CS-, and does so significantly better than model-free analogues (e.g., peak
 scoring, area under the curve).
\end_layout

\begin_layout Subsubsection
Adaptation to different SOAs
\end_layout

\begin_layout Standard
By considering fear conditioning sessions with different SOAs between CS
 and US, we investigated how this changes the anticipatory response.
 Our analysis suggested that for different SOAs the anticipatory HPR is
 time-locked to the US, with no changes in shape.
 This can be modelled by time-locking the RF (developed for 3.5 s) to the
 US.
 In PsPM, the default SOA is 3.5 s, and it can be modified to assume any
 positive value.
 However, we recommend not using SOAs shorter than 2 s.
 This procedure has been successfully tested with SOAs of 4 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

 and 6 s 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016ab"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Data Conditioning
\end_layout

\begin_layout Subsubsection
QRS detection 
\begin_inset CommandInset label
LatexCommand label
name "subsec:QRS-detection"

\end_inset


\end_layout

\begin_layout Standard
PsPM uses a modified offline version of the Pan & Tompkins 
\begin_inset CommandInset citation
LatexCommand cite
key "Pan:1985aa"
literal "true"

\end_inset

 QRS detection algorithm.
 The algorithm analyses slope, amplitude, and width of QRS complexes.
 It uses digital band-pass filters to reduce noise and its thresholds are
 periodically adjusted to low values.
 The algorithm works best on data with a time-resolution of 200 Hz.
 Data with higher sampling rate will automatically be downsampled to the
 optimal time-resolution.
 The QRS complex is marked at the rising edge of the integrated waveform
 signal that usually corresponds well with the position of the R-spike of
 the ECG.
\begin_inset Newline newline
\end_inset

 For the offline version of the Pan & Tompkins QRS detection algorithm some
 adjustments were made: 
\end_layout

\begin_layout Itemize
The originally used cascaded integer filters were replaced by a second order
 Butterworth filter that approximates the desired passband from 5 to 15
 Hz better than the original filters.
 
\end_layout

\begin_layout Itemize
To increase detection accuracy heart rate values were restricted to the
 interval of 20 bpm (IBI of 3000 ms) to 300 bpm (IBI of 300 ms).
 
\end_layout

\begin_layout Itemize
To allow for a manual inspection and possible correction of detection failures
 QRS detection procedure also containes a tool to visually inspect the results
 of QRS detection (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:ECG-editor"

\end_inset

).
 In order to manually check only those QRS complexes that are likely to
 be wrong, only those IBIs are checked that fall outside a user-defined
 range.
 To avoid the introduction of bias, the rater should blind to the experimental
 conditions during manual correction of the QRS detection.
 
\end_layout

\begin_layout Standard
Depending on the quality of the recordings QRS detection can achieve a very
 high accuracy in detecting QRS complexes of up to 99.66% 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph

\series medium
PsPM also offers a QRS detection algorithm for ECG data acquired in MRI
 environments.
 The algorithm is described in 
\begin_inset CommandInset citation
LatexCommand cite
key "liu2012statistical"
literal "false"

\end_inset

.
 The implementation is obtained from the software link given in the paper.
\end_layout

\begin_layout Subsubsection
Interpolation and Filtering 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Interpolation-and-Filtering"

\end_inset


\end_layout

\begin_layout Standard
To transform the discontinuous heart-beat information into a continous signal
 of heart-period, the heart-beat events are interpolated at a fixed sampling
 rate of 10 Hz using the built-in function 
\family typewriter
pspm_hb2hp
\family default
.
 The interpolation shifts some early evoked responses such that they appear
 to start before an event - this is automatically being taken care of by
 a response function that starts slightly before an event definition.
\begin_inset Newline newline
\end_inset

Before obtaining parameter estimates for the individual response functions
 the interpolated heart beat time-series is filtered with a second-order
 Butterworth band-pass filter.
 For evoked HPR, PsPM uses a pass band of 0.01-2 Hz 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

.
 For fear-conditioned HPR, PsPM uses a 0.015-0.5 Hz bidirectional 4th order
 Butterworth filter (cf.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

).
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design: 
\end_layout

\begin_deeper
\begin_layout Itemize
evoked HPR model: use only those RFs that peak within the SOA between subsequent
 events that elicit an HPR.
 A formal test of the linearity assumption has not been done yet.
 Therefore, the number of RFs that can be applied depends upon the SOA.
\end_layout

\begin_layout Itemize
fear-conditioned HPR: use default model for CS/US-SOAs between approximately
 2-8 s.
 The model is tested for 3.5 - 6 s.
 
\end_layout

\end_deeper
\begin_layout Itemize
Model set up:
\end_layout

\begin_deeper
\begin_layout Itemize
Use default filter frequencies (0.01 - 2 Hz unidirectional 2nd order Butterworth
 filter for evoked HPR 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

; 0.015 - 0.5 Hz bidirectional 6th order Butterworth filter for fear-conditioned
 HPR 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

, although there is apparently no strong impact of filter frequency.
\end_layout

\end_deeper
\begin_layout Section
Pupil size response (PSR) models
\end_layout

\begin_layout Standard

\shape italic
\color black
contributed by Christoph W.
 Korn
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
Pupil size is under control of two antagonistic muscles 
\begin_inset CommandInset citation
LatexCommand cite
key "McDougal:2008aa"
literal "true"

\end_inset

: Dilation (mydriasis) results from sympathetic inputs on the M.
 dilatator pupillae.
 Constriction (miosis) results from parasympathetic inputs on the M.
 sphincter pupillae.
 Pupil size reacts to changes in illuminance (light falling onto the eye,
 directly related to the luminance of screen presentations).
 It also responds to many cognitive processes including attention, perception,
 memory, and emotion (see 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset

 for references).
 Such cognitive processes are supposed to be relayed via the Edinger-Westphal
 nucleus and noradrenergic inputs into the locus coeruleus, among others
 
\begin_inset CommandInset citation
LatexCommand cite
key "McDougal:2008aa"
literal "true"

\end_inset

.
 On the basis of two experiments that elicited (il)luminance changes, we
 have developed a model for steady state pupil size and, more importantly,
 an model for changes of pupil size that is based on two LTI systems.
 These LTI systems can be harnessed to infer the neural input into the pupillary
 system that is elicited by cognitive processes (under the assumption of
 a common final pathway of (il)luminance-mediated inputs and cognitive inputs).
 We have also developed and validated a specific LTI system that allows
 distinguishing responses to CS+US- and CS- in fear-conditioning setups
 employing different sensory modalities and timings 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2017a"
literal "true"

\end_inset

.
 In this latter model, neural and peripheral system are collapsed for the
 purpose of quick and simple inversion with GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

).
 
\end_layout

\begin_layout Subsection
Model for pupil size changes elicited by (il)luminance changes
\end_layout

\begin_layout Standard
The system controlling pupil size is non-linear.
 To be able and use linear methods for analysis, PsPM splits the model into
 several parts.
 
\end_layout

\begin_layout Subsubsection
Model for steady-state pupil size
\end_layout

\begin_layout Standard
An exponential function is used to relate illuminance (in
\begin_inset Formula $[lx]$
\end_inset

) or luminance (in
\begin_inset Formula $\frac{cd}{m^{2}}$
\end_inset

) to steady-state pupil size (in arbitrary units as determined by the Eyelink
 system or in mm).
 These functions were specified on the basis of the first experiment described
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset

 (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prepare-illuminance-GLM"

\end_inset

).
 The functional relationship should cover the (il)luminance range employed
 in most cognitive experiments.
 
\begin_inset Formula 
\[
d\text{(}E_{v}\text{)=}C\text{ +}A\exp(BE_{v}\text{)}.
\]

\end_inset


\end_layout

\begin_layout Standard
Here, 
\begin_inset Formula $d$
\end_inset

 is the z-scored steady-state pupil diameter and 
\begin_inset Formula $E_{v}$
\end_inset

 is the respective illuminance level in (in 
\begin_inset Formula $[lx]$
\end_inset

).
 We obtained the following parameter values: 
\begin_inset Formula $A=49.79$
\end_inset

; 
\begin_inset Formula $B=-0.50$
\end_inset


\begin_inset Formula $[\frac{1}{lx}]$
\end_inset

; 
\begin_inset Formula $C=-1.05$
\end_inset

.
 Whether the non-linearity occurs in the peripheral or neural system is
 currently not known.An extension that is similar to our model within the
 (il)luminance range specified in our experiments, but extends across a
 wider range, can be found in 
\begin_inset CommandInset citation
LatexCommand cite
key "Watson:2012aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Model for pupil dilation/constriction
\end_layout

\begin_layout Standard
Dilations and constrictions differ in shape, and can thus not be modeled
 by a single LTI system (which would assume that positive and negative changes
 do not differ in shape but just in sign).
 Hence, we identified a combination of two LTI systems that provide a good
 approximation of pupil size changes elicited by (il)luminance changes (see
 first two experiments in 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset

).
 The first LTI-system describes changes to continuous (il)luminace inputs
 and the second LTI-system models the difference between constriction and
 dilation.
 The second system thus receives a brief input for any increase in (il)luminance.
 Both systems are specified by canonical response functions that take the
 form of gamma probability density functions.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
d\text{(}t)=c\frac{(t-t0)^{k-1}\exp(-(t+t0)/\theta)}{\theta^{k}\Gamma(k)}
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $d$
\end_inset

 is the z-scored steady-state pupil diameter, 
\begin_inset Formula $t$
\end_inset

 is time, 
\begin_inset Formula $\varGamma$
\end_inset

 is the gamma function, and 
\begin_inset Formula $k$
\end_inset

, 
\begin_inset Formula $\theta$
\end_inset

, 
\begin_inset Formula $c$
\end_inset

and 
\begin_inset Formula $t0$
\end_inset

 are free parameters.
 The fitted parameter values were: System 1: 
\begin_inset Formula $k=2.40$
\end_inset

, 
\begin_inset Formula $\theta=0.29s^{-1}$
\end_inset

, 
\begin_inset Formula $c=0.77$
\end_inset

; System 2: 
\begin_inset Formula $k=3.24$
\end_inset

, 
\begin_inset Formula $\theta=0.18s^{-1}$
\end_inset

, 
\begin_inset Formula $c=0.43$
\end_inset

.
 Since the latency of the empirical responses was around 200 ms, 
\begin_inset Formula $t0$
\end_inset

 was set to 200 ms prior to fitting.
 (We also modelled the first system with a Gaussian smoothed biexponential
 function; 
\begin_inset Formula $d\text{(}t)=aN(t)*(E_{1}(t)+E_{2}(t));$
\end_inset

 where 
\begin_inset Formula $*$
\end_inset

 is the convolution operator; 
\begin_inset Formula $N(t)$
\end_inset

 is a centered Gaussian function 
\begin_inset Formula $N(t)=(2\pi\sigma)^{-0.5}\exp(-t^{2}/2\sigma^{2})$
\end_inset

 and 
\begin_inset Formula $E_{1}(t)$
\end_inset

 and 
\begin_inset Formula $E_{2}(t)$
\end_inset

 are exponential functions of the form 
\begin_inset Formula $E(t)=\exp(-\lambda t)$
\end_inset

; parameter values: 
\begin_inset Formula $\sigma=0.27$
\end_inset

, 
\begin_inset Formula $\lambda_{1}=2.04s^{-1}$
\end_inset

, 
\begin_inset Formula $\lambda_{2}=1.48s^{-1}$
\end_inset

, 
\begin_inset Formula $a=0.004$
\end_inset

).
\end_layout

\begin_layout Standard
In GLM-based analyses, these systems explain considerable variance in pupil
 size time series in two experiments with (il)luminance inputs of long and
 short duration (with the second LTI system being particularly relevant
 for brief, i.e., sub-second, inputs).
 The modeled pupil size time series can be easily specified given a time
 series of (il)luminance values (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prepare-illuminance-GLM"

\end_inset

).
 These time series can be used as nuisance regressors in GLMs.
 Because the end stage of the pupil system does not depend on where the
 neural input comes from, the specified canonical response functions can
 also be used to estimate the shape (i.e., the temporal characteristics) of
 likely inputs into the pupillary systems for cognitive tasks.
 We provide examples for this for auditory oddball tasks with three different
 timings, for an emotional words task, and for a visual detection task (see
 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset

).
 
\end_layout

\begin_layout Subsection
Model for pupil size changes elicited by fear conditioning
\end_layout

\begin_layout Standard
This model collapses peripheral and neural processes into one RF, in order
 to use GLM for the inversion.
 On the basis of four experiments employing simple and complex auditory,
 visual, and somatosensory CS, we have determined a canonical response function
 that reliably distinguishes pupil responses to CS+US- and CS- 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2017a"
literal "true"

\end_inset

.
 Predictive validity exceeds (or is at least equal to) peak scoring and
 calculating the area-under-the-curve.
 The response function was initially based on a CS to US SOA of 3.5 s but
 the same function can be used for an SOA of 6 s.
 The overall best performing model did not include the temporal derivative
 but this is still accessible in PsPM.
 See: 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:GLM-for-fear-conditioned"

\end_inset

.
 The gamma probability density function followed the same form specified
 above with the parameter values 
\begin_inset Formula $k=6.03$
\end_inset

, 
\begin_inset Formula $\theta=0.73s^{-1}$
\end_inset

, 
\begin_inset Formula $c=1.6$
\end_inset

, 
\begin_inset Formula $t0=0.029$
\end_inset

 (
\begin_inset Formula $t0$
\end_inset

 was fitted for this model).
\end_layout

\begin_layout Subsection
Data preconditioning
\end_layout

\begin_layout Standard
We provide procedures to import pupil data from Eyelink, SMI and ViewPoint
 files, but they can also be imported from other sources via matlab or text
 files.
 All PsPM models specify pupil diameter.
 Eyelink import automatically converts input into diameter in absolute units
 (mm).
 SMI diameter values are returned in pixel values.
 ViewPoint diameter values are returned in ratio units as they are given
 in the data file.
 For other sources it may be necessary to convert the data using the respective
 conversion function.
 Missing data due to blinks, saccades, or slight head movements can be linearly
 interpolated before z-scoring.
 These missing data can then be retained, or not, for the GLM.
\end_layout

\begin_layout Standard
Pupil area appears smaller to the eyetracking camera when the participant
 does not maintain fixation.
 Whether this 
\begin_inset Quotes eld
\end_inset

Pupil foreshortening error
\begin_inset Quotes erd
\end_inset

 (PFE) influences recordings depends on the eyetracker.
 Geometrically, it would be possible to fit the visible pupil shape with
 an ellipse and retain the long axis as pupil diameter, which is invariant
 to eye movements.
 However, apparently many eyetrackers simply report the number of pupil
 pixels, ie.
 an area measure.
 For example, although the Eyelink 1000 eyetracker has the possibility to
 choose an ellipsoid model, this is according to the manual (User Manual.
 v.1.4.0, p.
 23) only used to determine pupil position, but not pupil area or diameter
 (
\begin_inset Quotes eld
\end_inset

Measure of Area or Diameter are always based on the Centroid Model
\begin_inset Quotes erd
\end_inset

).
 
\end_layout

\begin_layout Standard
To account for loss of fixation, PsPM includes two options: exclude these
 time intervals, or correct pupil size with a geometric model.
 (1) To detect loss of fixation there is a specific function (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Find-valid-fixations"

\end_inset

).
 The user has to specify the distance between screen and eye, the screen
 size, the position of the fixation point (by default the middle of the
 screen is assumed but additionally a time series of fixation points can
 be specified), and the threshold for exclusion set in degrees of visual
 angle.
 (2) PsPM also includes a method to perform pupil foreshortening error (PFE)
 correction as described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

.
 The implementation itself is eyetracker or measurement method independent;
 however, we use Eyelink in its name because the method was proposed specificall
y for Eyelink 1000 eyetracker.
 To perform PFE correction, PsPM requires extra information about the recording
 setup.
 Specifically, screen resolution, screen size and the screen-camera-eye
 geometry setup must be known.
\end_layout

\begin_layout Standard
Pupil size obtained using eyetrackers may be contaminated with high noise.
 Before using this data in various statistical models, it might be beneficial
 to preprocess it in order to increase signal-to-noise ratio.
 PsPM offers a pupil size preprocessing utility that is independent of the
 eyetracker used.
 The method is described in 
\begin_inset CommandInset citation
LatexCommand cite
key "kret2018preprocessing"
literal "false"

\end_inset

.
 We use a modified version of the software published in this paper.
 All the modifications are documented and the changelog is part of PsPM.
 The preprocessing method can be used without any additional information
 about the recording setup.
 PsPM exposes all the preprocessing parameters used by the underlying software
 to the user for finetuning.
\end_layout

\begin_layout Standard
Finally, we found that filtering provided equal or worse proportions of
 explained variance and therefore there is no default filtering although
 this may be beneficial for other experimental designs.
\end_layout

\begin_layout Section
Respiratory response models
\end_layout

\begin_layout Standard

\shape italic
\color black
contributed by Giuseppe Castegnetti and Dominik R Bach
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
Brain stem centres regulate respiration via autonomic nervous efferents,
 and these centres are influenced by higher cognitive processes 
\begin_inset CommandInset citation
LatexCommand cite
key "Cacioppo:2007aa,Wientjes:1998aa"
literal "true"

\end_inset

.
 This may allow inferring psychological states from measured respiration,
 although it is not very well know which psychological variables or events
 elicit phasic respiratory responses.
 PsPM implements four models for respiratory responses, derived from a single
 chest belt system.
 In principle, this system only allows assessing respiration period, while
 for precise quantification of respiratory amplitude, a double-belt system
 would be required to measure both thoracic and abdominal compartments 
\begin_inset CommandInset citation
LatexCommand cite
key "Binks:2006aa"
literal "true"

\end_inset

.
 However, if the ratio between thoracic and abdominal contribution is relatively
 constant within any individual, it may still be possible to approximate
 respiratory amplitude up to a linear constant from the single-belt system.
 We confirmed in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

 that respiration amplitude from a single chest belt system can be usefully
 analysed.
 PsPM considers the following measures: 
\end_layout

\begin_layout Itemize
Respiration period (RP) is the duration of a breathing cycle.
 PsPM models RP rather than the more common respiration rate, its inverse,
 in analogy to analysis of event-related cardiac responses where heart period
 has been shown to linearly relate to autonomic nervous system input 
\begin_inset CommandInset citation
LatexCommand cite
key "Berntson:1995"
literal "true"

\end_inset


\end_layout

\begin_layout Itemize
Respiration amplitude (RA) is the amplitude in rib cage excursion on that
 cycle, which linearly relates to current tidal volume (VT) 
\begin_inset CommandInset citation
LatexCommand cite
key "Binks:2006aa"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Itemize
Respiration flowrate (RFR), RA/RP, which is linearly related to tidal volumetric
 flow rate, i.e.
 tidal volume per time unit.
 RFR is computed per cycle with variable duration.
 Otherwise it is similar to minute volume, or RLL (respiration line length),
 which are computed over fixed intervals rather than respiratory cycles.
\end_layout

\begin_layout Standard
In these measures, we identified the following pattern of phasic responses
 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

:
\end_layout

\begin_layout Itemize
Respiratory period responses (RPR) are elicited by various external events
 (aversive sounds, electric shocks, picture viewing, visual detection) and
 reliably distinguish events from non-events
\end_layout

\begin_layout Itemize
Respiratory amplitude responses (RAR) are elicited by aversive sounds and
 shocks, and by picture viewing.
 Response amplitudes are smaller for picture viewing (including aversive
 pictures) than aversive sounds.
 RAR are also elicited by fear-conditioned stimuli.
\end_layout

\begin_layout Itemize
Respiratory flow-rate responses (RFRR) are elicited by aversive sounds and
 shocks, and by picture viewing.
 Response amplitudes are smaller for picture viewing (including aversive
 pictures).
 
\end_layout

\begin_layout Subsection
Peripheral and neural model
\end_layout

\begin_layout Standard
In the absence of information on the timecourse of input into breathing
 control, it is difficult to separate a neural and a peripheral model.
 Hence, these two are collapsed for the purpose of quick and simple inversion
 with GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

).
 This means that the two implemented models for RAR - evoked RAR and fear-condit
ioned RAR - use a different RF, although of course the peripheral system
 is the same in both cases.
\end_layout

\begin_layout Subsection
Models for evoked respiratory responses
\end_layout

\begin_layout Standard
These models are based on responses from 46 participants and on the following
 task conditions: visual detection, aversive electric shocks, IAPS picture
 viewing.
 The model was validated on an independent sample of 20 participants and
 the following task conditions: aversive and less aversive white noise sounds,
 positive and negative IAPS picture viewing.
 
\end_layout

\begin_layout Standard
We modelled responses with Gaussian functions:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
h\left(y\right)=\frac{1}{\sigma\sqrt{2\pi}}e^{\frac{-(t-\mu)^{2}}{2\sigma^{2}}}.
\]

\end_inset


\end_layout

\begin_layout Standard
Model constants after filter optimisation are summarised in table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:model_constants-Resp"

\end_inset

.
 Later response components that were visually identified in the development
 data set did not contribute to detecting overall responses or separating
 experimental conditions.
 Modelling the time derivative of the RF improved the RA and RFR models,
 but not the RP model 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
\noindent
\begin_inset Float table
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Model constants for evoked respiratory responses
\end_layout

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Response Function (RF)
\series default
 
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameters of Gaussian Function
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RPR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.20 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.65
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RAR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.07 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.74
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RFRR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.23
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
Note.

\shape default
 
\begin_inset Formula $\mu=$
\end_inset

 mean; 
\begin_inset Formula $\sigma=$
\end_inset

 standard deviation
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:model_constants-Resp"

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Model for fear-conditioned RAR
\end_layout

\begin_layout Standard
After showing that RAR may be better suited to distinguish cognitive processes
 than respiration period 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

, we investigated whether RAR allow assessment of fear memory in cued fear
 conditioning.
 Following the same procedure as in 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

, we built the RF from data collected during six experiments, involving
 diverse stimuli and two types of breathing belts (bellows and cushion systems).
 The ensuing winning model was the combination of an early and a late response
 components, modelled by gamma distributions
\end_layout

\begin_layout Standard

\color black
\begin_inset Formula 
\[
y=\frac{A}{\Theta^{k}\Gamma(k)}(x-x_{0})^{k-1}e^{-\frac{x-x_{0}}{\Theta}}
\]

\end_inset


\color inherit
with parameters 
\begin_inset Formula $k_{e}=2.570*10^{7}$
\end_inset

, 
\begin_inset Formula $\Theta_{e}=3.124*10^{-4}$
\end_inset

, 
\begin_inset Formula $x_{o,e}=-8.024*10^{3}$
\end_inset

 and 
\begin_inset Formula $k_{l}=3.413$
\end_inset

, 
\begin_inset Formula $\Theta_{l}=1.107$
\end_inset

, 
\begin_inset Formula $x_{0,l}=7.583$
\end_inset

, respectively.
 This method distinguishes RAR to CS+ and CS- better than model-free scoring
 of RAR (e.g., peak scoring).
 Compared to other measures of fear learning, RAR turn out to perform similar
 to SCR, but are less sensitive than HPR.
 By comparing CS/US SOAs of 3.5, 4, and 6 s, it is evident that the RAR are
 most likely time locked to the US.
 In the model, both components of the RF are shifted in time as a function
 of the SOA.
 To avoid deformation of the early RF due to violations of the linearity
 assumptions, however, we recommend to use this method only with experiments
 involving SOAs longer than 2.5 s.
\end_layout

\begin_layout Subsection
Data Conditioning
\end_layout

\begin_layout Subsubsection
Breathing cycle detection 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Breathing-cycle-detection"

\end_inset


\end_layout

\begin_layout Paragraph*
Bellows system
\end_layout

\begin_layout Standard
Transducer output is filtered offline with an anti-aliasing bidirectional
 first-order Butterworth low-pass filter and a cut-offfrequency of 5 Hz.
 Data are then downsampled to 10 Hz resolution.
 Respiration traces are mean-centred, filtered with a bidirectional Butterworth
 band pass filter and cut-off frequencies of 0.01 Hz and 0.6 Hz, and median
 filtered over 1 s.
 A negative zero-crossing is taken as start of inspiration.
 After each detected cycle, PsPM imposes a 1 s refractory period, to account
 for residual signal noise with might cause several zero-crossings on the
 same cycle.
 In the validation data set, we compared this method to visual detection
 as gold standard and found, for the automated method, a sensitivity of
 99.3%, and a positive predictive value of 99.5%.
 For the time difference between visual and automated detection, we found
 a median delay of 0.1 s and a standard deviation of 0.1 s 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph
Cushion system
\end_layout

\begin_layout Standard
For data obtained from the cushion/belt system, the above algorithm must
 be adapted to account for the different response of cushion/belt system
 to ventilator activity.
 Specifically, we defined the onsets of the inspirations as the minima of
 the respiratory trace.
 Hence, the algorithm was adapted to extract zero crossings of the derivative
 of the time series (i.e., the extrema), from which the positive ones (i.e.,
 the minima) were set as the start of the inspiration.
\end_layout

\begin_layout Subsubsection
Interpolation and Filtering 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Interpolation-and-Filtering-Resp"

\end_inset


\end_layout

\begin_layout Standard
To transform the discontinuous RP, RA and RFR information into a continous
 signal, they are assigned to the start of the following inspiration cycle
 and linearly interpolated with 10 Hz sampling frequency.
 PsPM also allows writing out the respiration time stamps for quality control.
 The interpolation shifts some early evoked responses such that they appear
 to start before an event - this is automatically being taken care of by
 a response function that starts slightly before an event definition.
 The best filter frequencies in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

 were: 0.01-1 Hz for RP, 0.001-1 Hz for evoked RA and RFR.
 For fear-conditioned RA a 0.01-2 Hz bidirectional 6th order Butterworth
 filter provided the best results (cf.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016ab"
literal "true"

\end_inset

).
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design: 
\end_layout

\begin_deeper
\begin_layout Itemize
evoked respiratory response models: make sure the SOA between subsequent
 events that elicit an respiratory response is longer than the peak of the
 respective RF.
 A formal test of the linearity assumption has not been done yet.
 
\end_layout

\begin_layout Itemize
fear-conditioned RAR: To avoid deformation of the early RF due to violations
 of the linearity assumptions, we recommend to use this method only with
 experiments involving SOAs longer than 2.5 s.
\end_layout

\end_deeper
\begin_layout Itemize
Model set up:
\end_layout

\begin_deeper
\begin_layout Itemize
Use default filter frequencies (0.01-1 Hz for RP, 0.001-1 Hz for evoked RA
 and RFR.
 0.001-2 Hz for fear-conditioned RA.)
\end_layout

\end_deeper
\begin_layout Section
Startle eye blink response models
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
The startle response is a fast defensive reflex to an unexpected intense
 auditory, visual, or haptic stimulus.
 Functionally, it appears to protect an organism from an imminent blow to
 the head 
\begin_inset CommandInset citation
LatexCommand cite
key "Yeomans:2002aa"
literal "true"

\end_inset

.
 The human startle response encompasses a postural change and an eyeblink
 response which is easy to measure
\color magenta
 
\color inherit

\begin_inset CommandInset citation
LatexCommand cite
key "Lang:1997aa"
literal "true"

\end_inset

.
 While the startle response itself is very stereotypical, its amplitude
 is susceptible to various physiological and psychological manipulations,
 many of which can be summarised in a decision-theoretic model in terms
 of optimising the cost of the startle response, and of a putative predator
 attack
\color magenta
 
\color black

\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2015ac"
literal "true"

\end_inset

.
 In this context, the most important phenomenon is fear-potentiated startle,
 a stronger startle response during a CS+ than CS- in fear conditioning
 
\begin_inset CommandInset citation
LatexCommand cite
key "Brown:1951aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Peripheral and neural model
\end_layout

\begin_layout Standard
In the absence of information on the millesecond-time course of neural response
 in the centres controlling startle, it is difficult to separate a neural
 and a peripheral model.
 Hence, these two are collapsed for the purpose of quick and simple inversion
 with GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

).
 Because the startle response is so stereotypical, the same RF is used for
 all applications, and the amplitude estimated.
 There appears to be some variability in the latency of the startle response
 between trials and participants, such that the neural model contains a
 (constrained) latency parameter that is estimated from the data.
 The startle eye blink response function (SEBRF) is based on data from 19
 participants that heard startle sounds with no other manipulation.
 Pre-processing parameters were optimised to distinguish CS+/CS- in a fear
 retention task with 20 participants in which startle onsets were recorded
 for enhanced temporal precision.
 They were then validated on two independent samples of 15 and 14 participants
 in a fear retention, and fear acquisition task, respectively.
 The SEBRF is described as a gamma distribution 
\end_layout

\begin_layout Standard

\color black
\begin_inset Formula 
\[
y=\frac{A}{\Theta^{k}\Gamma(k)}(x-x_{0})^{k-1}e^{-\frac{x-x_{0}}{\Theta}}
\]

\end_inset


\end_layout

\begin_layout Standard
with parameters 
\begin_inset Formula $k=3.5114$
\end_inset

, 
\begin_inset Formula $\Theta=0.0108$
\end_inset

, 
\begin_inset Formula $x_{o}=0.0345$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Khemka:2016a"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Data preconditioning
\end_layout

\begin_layout Standard
The algorithm expects raw data from orbicularis oculi EMG.
 Data filtering and preprocessing is taken care of by a separate PsPM function
 (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Preprocess-startle-eyeblink"

\end_inset

) and includes a 4th order Butterworth band-pass filter with cutoff frequency
 of 50 Hz and 470 Hz, removal of mains noise with a 50 Hz notch filter.
 Filtered continuous EMG signals are rectified and smoothed using a 4th
 order Butterworth low-pass filter with a time constant of 3 ms corresponding
 to a cutoff frequency of 53.05 Hz.
 No more data pre-conditioning is applied during GLM inversion, which allows
\color black
 to visually inspect the filtered EMG data in advance to the inversion.
 To specify startle sound onsets with high precision, you can use the function
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Preprocess-startle-eyeblink"

\end_inset

 to detect these onsets from recorded audio signals.
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design: 
\end_layout

\begin_deeper
\begin_layout Itemize
record audio output from your startle equipment and use PsPM to detect sound
 onsets
\end_layout

\end_deeper
\begin_layout Itemize
Preprocessing:
\end_layout

\begin_deeper
\begin_layout Itemize
use default pre-processing
\end_layout

\end_deeper
\begin_layout Itemize
Model setup:
\end_layout

\begin_deeper
\begin_layout Itemize
model each trial as separate event type such that the response latency can
 be estimated per trial, rather than per condition
\end_layout

\end_deeper
\begin_layout Part
User Guide
\end_layout

\begin_layout Section
Installation
\end_layout

\begin_layout Standard
You can find and download the PsPM package at the following URL: 
\end_layout

\begin_layout Standard
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://bachlab.org/pspm
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Decompress and copy the files to any directory of your choice.
 Then add the PsPM files to the Matlab search path by entering the following
 command in the Matlab command line: 
\end_layout

\begin_layout Standard

\family typewriter
addpath([your Matlab path]) 
\family default
where [your Matlab path] is a string of the file location on your hard drive,
 e.g.
 
\end_layout

\begin_layout Standard

\family typewriter
addpath(‘C:
\backslash
Program Files
\backslash
MATLAB
\backslash
R2013a
\backslash
toolbox
\backslash
PsPM
\backslash
’)
\family default
.
 
\end_layout

\begin_layout Standard
Do not add subfolders of the PsPM directory to the matlab path.
\end_layout

\begin_layout Standard
Type 
\family typewriter
pspm
\family default
 in the command line to start the package.
 Alternatively, each function can be called individually from the command
 line.
 In that case, you can use 
\family typewriter
pspm_init
\family default
 to load the settings, and 
\family typewriter
pspm_quit
\family default
 to remove PsPM subfunctions from the path and delete the settings.
 
\end_layout

\begin_layout Standard
PsPM requires Matlab 2009a or higher.
 
\end_layout

\begin_layout Section
General points
\end_layout

\begin_layout Subsection
File types
\end_layout

\begin_layout Standard
PsPM knows three different file types:
\end_layout

\begin_layout Itemize
Data files - usually the original file name is prepended with 'pspm_' during
 import.
 Various pre-processing steps prepend additonal letters to the name.
\end_layout

\begin_layout Itemize
First-level model files - all models use a similar data structure.
 The name can be freely specified by the user.
 These files also contain reconstructed responses in GLM, and contrast values.
\end_layout

\begin_layout Itemize
Second-level model files.
 The name can be freely specified by the user.
\end_layout

\begin_layout Subsection
Functions that create new data files
\end_layout

\begin_layout Itemize
Import - prepended with 'pspm_'
\end_layout

\begin_layout Itemize
Interpolation - prepended with 'i'
\end_layout

\begin_layout Itemize
Trim - prepended with 't'
\end_layout

\begin_layout Itemize
Artefact removal - prepended with 'm'
\end_layout

\begin_layout Itemize
Split sessions - appended with '_sn<nr>'
\end_layout

\begin_layout Itemize
Downsample data - prepended with 'd'
\end_layout

\begin_layout Standard
These functions ask whether an existing file with the same name should be
 overwritten - unless you specify 'overwrite' in the options.
\end_layout

\begin_layout Subsection
Functions that create or modify data channels in an existing file
\end_layout

\begin_layout Itemize
Preprocess heart data
\end_layout

\begin_layout Itemize
Preprocess respiration data
\end_layout

\begin_layout Itemize
Preprocess startle eyeblink EMG
\end_layout

\begin_layout Itemize
Find valid fixations
\end_layout

\begin_layout Itemize
Pupil foreshortening error correction
\end_layout

\begin_layout Itemize
Pupil preprocessing
\end_layout

\begin_layout Itemize
Convert data
\end_layout

\begin_layout Itemize
Find startle sound onsets
\end_layout

\begin_layout Itemize
Interpolate missing data
\end_layout

\begin_layout Standard
These functions allow you to select where to store a modified data channel.
 The following options exist:
\end_layout

\begin_layout Itemize
add: A new channel is created with the new data
\end_layout

\begin_layout Itemize
replace: If one or several channels of the output type exists, the last
 of these will be overwritten.
 For some functions, this can overwrite the original data, i.
 e.
 if a conversion function produces an output of the same type as the input
 (e.g.
 when units are converted, or artefacts removed).
 If no channel of the output channel type is found, a channel will be added.
\end_layout

\begin_layout Section
Data preparation
\end_layout

\begin_layout Subsection
Import
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_import
\end_layout

\begin_layout Standard
Import external data files for use by PsPM.
 First, specify the data type.
 Then, other fields will come up as required for this data type.
 The imported data will be written to a new .mat file, prepended with 'pspm_'.
\end_layout

\begin_layout Subsubsection*
Data Type
\end_layout

\begin_layout Paragraph
CED Spike
\end_layout

\begin_layout Paragraph
Text
\end_layout

\begin_layout Standard
Text files can only contain numbers (i.e.
 no header lines with channel names) and one data column per channel.
 Make sure you use the decimal point (i.e.
 not decimal comma).
 At the moment, no import of event time stamps is possible, but continuous
 event marker channels are supported.
\end_layout

\begin_layout Paragraph
Matlab
\end_layout

\begin_layout Standard
Each input file must contain a variable called data that is either a cell
 array of column vectors, or a data points × channels matrix.
 The import of event markers is supported.
 Marker channels are assumed to be continuous if the input data is a matrix
 or if the input data is a cell and the given samplerate is larger than
 1 Hz.
 A sample rate has to be specified for any type of data.
\end_layout

\begin_layout Paragraph
Biopac AcqKnowledge (up to v.
 3.9)
\end_layout

\begin_layout Standard
Imports original files.
\end_layout

\begin_layout Paragraph
exported Biopac AcqKnowledge
\end_layout

\begin_layout Standard
Converted with manufacturer's export function.
\end_layout

\begin_layout Paragraph
bioread-converted Biopac AcqKnowledge (any version)
\end_layout

\begin_layout Standard
Loads mat files which have been converted using the bioread tool acq2mat.
 Bioread can be installed using pip (installed by python) or can be downloaded
 and installed manually from here 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/njvack/bioread
\end_layout

\end_inset

.
 It requires python and the python libraries numpy and scipy.
 
\end_layout

\begin_layout Paragraph*
Labchart (any Version, Windows only)
\end_layout

\begin_layout Standard
Supports the import of any original Labchart (.adicht) file.
 Since it uses an external library, this import is restricted to Windows
 systems only and does not work on any other operating system.
\end_layout

\begin_layout Paragraph
Labchart exported (up to v.
 7.1)
\end_layout

\begin_layout Standard
Export data to matlab format (plugin for the LabChart software, available
 from www.adinstruments.com)
\end_layout

\begin_layout Paragraph
Labchart exported (v.
 7.2 and higher)
\end_layout

\begin_layout Paragraph
VarioPort
\end_layout

\begin_layout Paragraph
Biograph Infiniti exported
\end_layout

\begin_layout Standard
Export data to text format, both "Export Channel Data" and "Export Interval
 Data" are supported; a header is required
\end_layout

\begin_layout Paragraph*
Mindmedia Biotrace exported
\end_layout

\begin_layout Paragraph*
BrainVision
\end_layout

\begin_layout Paragraph*
Windaq (Manufacturer's version)
\end_layout

\begin_layout Standard
Requires an ActiveX Plugin provided by the manufacturer and contained in
 the subfolder Import/wdq for your convenience.
 This plugin only runs under 32 bit Matlab on Windows.
 
\end_layout

\begin_layout Paragraph
Windaq (PsPM Version)
\end_layout

\begin_layout Standard
Windaq import written by the PsPM team.
 Is platform independent, thus has no requirements for ActiveX Plugins,
 Windows or 32bit Matlab.
 Imports the *.wdq files.
 Up to now the import has been tested with files of the following type:
 Unpacked, no Hi-Res data, no Multiplexer files.
 A warning will be produced if the imported data-type fits one of the yet
 untested cases.
 If this is the case try to use the import provided by the manufacturer
 (see above).
\end_layout

\begin_layout Paragraph*
Observer XT compatible
\end_layout

\begin_layout Paragraph*
NeuroScan
\end_layout

\begin_layout Paragraph*
BioSemi
\end_layout

\begin_layout Paragraph*
Eyelink
\end_layout

\begin_layout Standard
Eyelink output files (with extension *.edf) must first be converted to ASCII
 format (extension *.asc).
 This is done with the utility edf2asc.exe (normally included in the Eyelink
 software in <Path to Program Files>
\backslash
SR Research
\backslash
EyeLink
\backslash
EDF_Access_API
\backslash
).
 Otherwise there is a Data viewer, available at 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://www.sr-research.com/dv.html
\end_layout

\end_inset

 (registration needed), which installs a utility called 'Visual EDF2ASC'.
 This also allows the conversion and does not require a license.
 The composition of channels depends on the acquisition settings.
 Available channels are Pupil L, Pupil R, x L, y L, x R, y R, Blink L, Blink
 R, Saccade L, Saccade R.
 The channels will be imported according to a known data structure, therefore
 channel ids passed to the import function or set in the Batch will be ignored.
 If the import function defines PsPM file channels that are not available
 in the data file, these channels will be filled with NaN values.
 Periods of blinks and saccades will be set to NaN in the gaze and pupil
 channels.
 To reduce the impact of loss of fixation on recorded pupil size, we recommend
 setting ELCL_PROC to ELLIPSE during acquisition.
\end_layout

\begin_layout Subparagraph*
Pupil Channels and Eyetracker distance 
\end_layout

\begin_layout Standard
Distance between eyetracker camera and recorded eyes in length units.
 If the given eyetracker distance is given as a positive numeric value,
 it enables the pupil data to be converted from arbitrary area or diameter
 units to diameter (mm) and then to the length unit of the eyetracker distance.
 If eyetracker distance is not given, or if it is not a positive numeric
 value, then the conversion to mm is disabled.
 In this case, pupil data will be imported in arbitrary (Eyelink) units.
 (Use only if you are interested in relative values)
\end_layout

\begin_layout Standard
The relation between arbitrary units (a.u.) and diameter is assumed to be
 linear such that for diameter data
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
d=m_{diameter}\cdot\frac{dist}{dist_{ref}}\cdot d_{a.u.}
\]

\end_inset


\end_layout

\begin_layout Standard
and for area data 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
d=m_{area}\cdot\frac{dist}{dist_{ref}}\cdot\sqrt{d_{a.u.}}
\]

\end_inset


\end_layout

\begin_layout Standard
for data 
\begin_inset Formula $d$
\end_inset

 in mm, data 
\begin_inset Formula $d_{a.u.}$
\end_inset

 in arbitrary units, reference camera-eye distance 
\begin_inset Formula $dist_{ref}$
\end_inset

 in mm, used camera-eye distance 
\begin_inset Formula $dist$
\end_inset

 in mm and a proportionality factor 
\begin_inset Formula $m$
\end_inset

 in mm.
 In our equations, 
\begin_inset Formula $m_{area}/dist_{ref}$
\end_inset

ratio corresponds to the scaling factor in 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

.
 For area-based conversion, we use the scaling factor 
\begin_inset Formula $\alpha=1.70\times10^{-4}$
\end_inset

as given in 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

.
 For a reference distance of 700 mm this translates to 
\begin_inset Formula $m_{area}=0.119$
\end_inset

 mm.
 For diameter-based conversion, we determined reference distance and the
 proportionality factor in a simpler calibration with three different artificial
 pupil sizes setting using linear regression.
 We note that for a different Eyelink eye-tracker setup, conversion with
 these values yielded results with slight deviance from the expected value,
 such that they are either not entirely precise, or there may be small differenc
es between different eyetrackers.
 The table below summarises all coefficients:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Float table
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Coefficients Used for Eyelink Data Conversion
\end_layout

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Coefficient
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Variable in 
\family typewriter
\series default
pspm_get_eyelink.m
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Unit
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $dist_{ref}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
reference_distance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
700
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{diameter}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
diameter_multiplicator
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00087743
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{area}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
area_multiplicator
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.119
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tab:eyelink_coefficients
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For custom setups reference distance (field 
\family typewriter
reference_distance
\family default
) and proportionality factor (
\family typewriter
diameter_multiplicator
\family default
 or 
\family typewriter
area_multiplicator
\family default
) can be set at the top of 
\family typewriter
pspm_get_eyelink.m 
\family default
file.
\end_layout

\begin_layout Subparagraph*
Gaze Channels
\end_layout

\begin_layout Standard
Gaze channels are reported exactly as given in the datafile without any
 conversion.
 Gaze channel units are pixels.
\end_layout

\begin_layout Subparagraph*
Distance unit
\end_layout

\begin_layout Standard
The length unit in which the eyetracker distance is given.
 It can be mm, cm, m or inches.
\end_layout

\begin_layout Subparagraph*
Blink/Saccade Edge Discard
\end_layout

\begin_layout Standard
Samples surrounding a blink or saccade period may be noisy.
 For this reason, Eyelink import provides a parameter that allows users
 to specify the amount of samples they want to discard on each side of every
 blink and saccade period.
 This value is multiplied by the sampling rate of the recording to determine
 the number of samples to discard from one end.
 Therefore, for each blink/saccade period, 
\begin_inset Formula $2\cdot factor\cdot F_{sampling}$
\end_inset

 many samples are discarded in total, and effectively blink/saccade period
 is extended.
\end_layout

\begin_layout Standard
This value also corresponds to the duration of samples to discard on one
 end in seconds.
 For example, when it is 0.01, we discard 10 ms worth of data on each end
 of every blink/saccade period.
\end_layout

\begin_layout Standard
The default value has been changed to 0 in PsPM revision r803 to reduce
 the amount of discarded data.
 Note that this might result in noisy samples around blink/saccade points.
 Therefore, it is highly recommended to perform pupil size data preprocessing
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Pupil-Preprocessing"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and gaze data filtering 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Find-valid-fixations"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Paragraph*
SMI (SensoMotoric Instruments)
\end_layout

\begin_layout Standard
SMI output files (with extension *.idf) must first be converted to ASCII
 format (extension *.txt) using IDF converter.
\end_layout

\begin_layout Standard
SMI iView X EyeTracker sample and optionally also event files can be imported.
 The SMI sample file contains pupil, gaze and position related information.
 The SMI event file contains information about blink/saccade events.
 Available channels to import are Pupil L, Pupil R, Gaze x L, Gaze x R,
 Gaze y L, Gaze y R, Blink L, Blink R, Saccade L, Saccade R, Marker, Custom.
 All channels except custom are imported according to a known data structure.
 Therefore, there is no need to specify the column indices of channels.
 If specified channels are not available, they will be filled with NaN values.
 If an event file is given so that blinks/saccades are available, blink
 and saccade periods will be set to NaN.
\end_layout

\begin_layout Standard
There are multiple ways to specify pupil information in SMI sample files.
 Instead of importing all the channels for a given eye, PsPM selects only
 one of the available ones according to the following precedence order:
\end_layout

\begin_layout Enumerate
Mapped Diameter (mm)
\end_layout

\begin_layout Enumerate
Dia X (mm)
\end_layout

\begin_layout Enumerate
Dia (squared mm)
\end_layout

\begin_layout Enumerate
Dia X (px)
\end_layout

\begin_layout Enumerate
Dia (squared px)
\end_layout

\begin_layout Standard
If the chosen pupil channel is in squared px or squared mm, then it is converted
 to diameter by assuming the shape is a circle.
 However, no conversion from pixels to milimeters is performed for pupil
 channels.
 Therefore, if a pixel or squared pixel channel is chosen, it is returned
 in pixel units.
\end_layout

\begin_layout Standard
Returned gaze coordinates assume that (0, 0) point of the calibration area
 is the top left corner.
 
\begin_inset Formula $x$
\end_inset

 coordinates increase towards right and 
\begin_inset Formula $y$
\end_inset

 coordinates increase downwards.
 If the resolution of the whole stimulus window is given, the gaze values
 are returned in the desired target unit.
 Otherwise, they are returned in pixels.
 It is important to note that the values can be negative or larger than
 the sides of the screen, if gaze is outside the calibration area.
\end_layout

\begin_layout Standard
Gaze values are reported in pixels by SMI.
 The conversion from pixels to milimeters is performed by using the size
 and the resolution of the stimulus window to calculate 
\begin_inset Formula $px/mm$
\end_inset

 ratio, and then using this ratio for scaling.
\end_layout

\begin_layout Paragraph*
Viewpoint (Arrington Research)
\end_layout

\begin_layout Standard
Arrington Research ViewPoint EyeTracker files can be imported into PsPM.
 Available channels to import are Pupil L, Pupil R, Gaze x L, Gaze x R,
 Gaze y L, Gaze y R, Blink L, Blink R, Saccade L, Saccade R, Marker, Custom.
 Currently, blink and saccade events can only be imported if they are stored
 as asynchronous messages in the datafile.
 This is enabled by 
\begin_inset Quotes eld
\end_inset

Include Events in Datafile
\begin_inset Quotes erd
\end_inset

 option in ViewPoint EyeTracker software.
 All channels except custom are imported according to a known data structure;
 therefore, there is no need to specify the column indices of channels.
 If specified channels are not available, they will be filled with NaN values.
\end_layout

\begin_layout Standard
ViewPoint reports data for eye A in monocular mode and for eyes A and B
 in binocular mode.
 PsPM performs the following mapping from A/B to L/R:
\end_layout

\begin_layout Enumerate
If only one eye is specified by user (only L or only R) and there is only
 eye A in data, then data for eye A is returned as the eye specified by
 user
\end_layout

\begin_layout Enumerate
In all other cases, eye A is mapped to eye R and eye B is mapped to eye
 L.
\end_layout

\begin_layout Standard
All gaze and diameter values are reported as ratios by ViewPoint:
\end_layout

\begin_layout Enumerate
Gaze value for a given axis is the ratio of the gaze coordinate to the length
 of that axis.
\end_layout

\begin_layout Enumerate
Pupil diameter is the ratio of pupil width to the EyeCamera window width.
\end_layout

\begin_layout Standard
Since ViewPoint data files contain the size of the stimulus window in milimeters
, PsPM converts normalized gaze values to values in milimeter.
 This is performed by multiplying the ratio with the length of the corresponding
 stimulus window axis.
 Returned gaze coordinates assume that (0, 0) point of the stimulus window
 is the top left corner.
 
\begin_inset Formula $x$
\end_inset

 coordinates increase towards right and 
\begin_inset Formula $y$
\end_inset

 coordinates increase downwards.
 The gaze values are returned in the desired target unit.
 It is important to note that the values can be negative or larger than
 side of the screen which correspond to looking outside the stimulus window.
\end_layout

\begin_layout Standard
Pupil diameter is returned as ratio without any conversion.
\end_layout

\begin_layout Paragraph
European Data Format (EDF)
\end_layout

\begin_layout Paragraph
Philips Scanphyslog
\end_layout

\begin_layout Standard
This functions imports psychophysiology files from Philips MRI scanners.
 The physlog ascii file contains 6 channels with physiological measurements:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Channel id
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Event type
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ECG1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ECG2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ECG3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ECG4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pulse oxymeter
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Respiration
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

Depending on your scanner settings, there are 10 trigger channels (see complete
 list below) of which channel 6 marks time t of the last slice recording.
 After importing, a time window from t minus 
\begin_inset Formula $(\#\,volumes)*(repetition\:time)$
\end_inset

 seconds until t should be used for trimming or splitting of sessions to
 constrain data in the imported file to the EPI recording window and easier
 matching with experimental events from a separate source.
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

Available trigger channels are:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Channel id
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Event type
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Trigger ECG
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Trigger PPU
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Trigger Respiration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Measurement ('slice onset')
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Start of scan sequence
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
End of scan sequence
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Trigger external
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Calibration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Manual start
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Reference ECG Trigger
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Subsubsection*
Data File(s)
\end_layout

\begin_layout Standard
Specify which data file(s) to import.
 You can import multiple files that all have the same structure.
\end_layout

\begin_layout Subsubsection*
New Channel
\end_layout

\begin_layout Standard
Define each channel that you want to import.
\end_layout

\begin_layout Paragraph*
Channel Type
\end_layout

\begin_layout Standard
Specify the type of data in this channel.
 Currently supported data types: SCR, ECG, heart beat markers, interpolated
 heart rate, interpolated heart period, respiration traces, interpolated
 respiration period, pupil size, EMG, marker channels.
 
\end_layout

\begin_layout Paragraph*
Channel /Column Number
\end_layout

\begin_layout Standard
Specify where in the original file to find the data - depending on your
 data type this will be a channel or column number.
 You can either specify a number (i.
 e.
 the n-th channel in the file), or (for many data types) search for this
 channel by its name.
 Note: the channel number refers to the n-th recorded channel, not to its
 number during acquisition: if you did not save all recorded channels, these
 might be different for some data types.
 
\end_layout

\begin_layout Itemize
Search [if available]: Search for channel by its name – this only works
 if the channel names are unambiguous, and not for all data types.
\end_layout

\begin_layout Itemize
Specify Channel Number [if required according to data type, otherwise a
 default channel number will be assigned]: Specify the n-th channel.
 This counts the number of channels actually recorded.
\end_layout

\begin_layout Paragraph*
Sample Rate [if required]
\end_layout

\begin_layout Standard
Sample rate in Hz (i.
 e.
 samples per second).
 For most data types, this is read from the original data file.
\end_layout

\begin_layout Paragraph*
SCR Transfer Function [for SCR data only]
\end_layout

\begin_layout Standard
Enter the conversion from recorded data to Microsiemens.
 
\end_layout

\begin_layout Standard
The transfer function supports two recording systems, which are either a
 conductance based system (default) or a resistance based system.
 Depending on the recording system the relation between measured conductance
 
\begin_inset Formula $G$
\end_inset

 in 
\begin_inset Formula $\mu S$
\end_inset

 to recorded voltage 
\begin_inset Formula $U$
\end_inset

 in 
\begin_inset Formula $V$
\end_inset

 is either
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
G=\frac{1}{\frac{c}{U-offset}-R_{s}*10^{-6}},\label{eq:Voltage from Skin conductance}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
or
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
G=\frac{1}{\frac{U-offset}{c}-R_{s}*10^{-6}}.\label{eq:Voltage from Skin resistance}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For a transfer constant 
\begin_inset Formula $c$
\end_inset

 in 
\begin_inset Formula $V/\mu S$
\end_inset

 (for 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Voltage from Skin conductance"

\end_inset

) or in 
\begin_inset Formula $V/M\Omega$
\end_inset

 (for 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Voltage from Skin resistance"

\end_inset

), series resistor 
\begin_inset Formula $R_{s}$
\end_inset

 in Ohm, and a fixed offset in 
\begin_inset Formula $V$
\end_inset

 which was added to the initially measured voltage.
 If there is no offset and series resistor, this is equivalent to 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
G=\frac{U}{c},\,U=cG
\]

\end_inset


\end_layout

\begin_layout Standard
or 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
G=\frac{c}{U},\,U=cR=\frac{c}{G},
\]

\end_inset


\end_layout

\begin_layout Standard
There are three options how to enter this information:
\end_layout

\begin_layout Itemize
File: Enter the name of the .mat file that contains the variables: 'c', 'Rs'
 (in Ohm) and 'offset', 'recsys' (possible values: 'conductance' or 'resistance'
).
\end_layout

\begin_layout Itemize
Input: Enter the transfer constants manually.
\end_layout

\begin_layout Itemize
None: No transfer function.
 Use this only if you are not interested in absolute values, and if the
 recording settings were the same for all subjects.
\end_layout

\begin_layout Subsection
Trim
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_trim
\end_layout

\begin_layout Standard
Trim away unnecessary data, for example before an experiment started, or
 after it ended.
 Trim points can be defined in seconds with respect to start of the data
 file, in seconds with respect to first and last marker (if markers exist),
 or in seconds with respect to a user-defined marker.
 The resulting data will be written to a new file, prepended with 't'.
\end_layout

\begin_layout Subsubsection*
Data file
\end_layout

\begin_layout Standard
Choose the data file you want to trim.
\end_layout

\begin_layout Subsubsection*
Reference
\end_layout

\begin_layout Standard
Choose your reference for trimming: file start, first/last marker, or a
 user-defined marker.
 All trimming is defined in seconds after this reference – choose negative
 values if you want to trim before the reference.
\end_layout

\begin_layout Paragraph*
File
\end_layout

\begin_layout Standard
Trim from xx seconds after file start to xx seconds after file start.
\end_layout

\begin_layout Itemize
From (seconds after file start): Choose a positive value.
\end_layout

\begin_layout Itemize
Trim To (seconds after file start): Choose a positive value larger than
 the 'from' value.
\end_layout

\begin_layout Paragraph*
First/Last Marker
\end_layout

\begin_layout Standard
Trim from xx seconds after first marker to xx seconds after last marker.
\end_layout

\begin_layout Itemize
From: (seconds after first marker): Choose a positive (after first marker)
 or negative (before first marker) value.
\end_layout

\begin_layout Itemize
To: (seconds after last marker): Choose a positive (after last marker) or
 negative (before last marker) value.
\end_layout

\begin_layout Itemize
Marker Channel: If you have more than one marker channel, choose the reference
 marker channel (default: use the first marker channel in the file) 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- Default (first marker channel=0)
\end_layout

\begin_layout Standard
- Number
\end_layout

\end_deeper
\begin_layout Paragraph*
Any Marker
\end_layout

\begin_layout Standard
Trim from xx seconds after any marker of your choice to xx seconds after
 any marker of your choice.
\end_layout

\begin_layout Itemize
From: Choose marker number and trimming point in seconds after this marker.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- Marker Number x: Choose an integer value.
\end_layout

\begin_layout Standard
- Seconds after Marker x: Choose a positive (after this marker) or negative
 (before this marker) value.
\end_layout

\end_deeper
\begin_layout Itemize
To: Choose marker number and trimming point in seconds after this marker.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- Marker Number y: Choose an integer value.
\end_layout

\begin_layout Standard
- Seconds after Marker y: Choose a positive (after this marker) or negative
 (before this marker) value.
\end_layout

\end_deeper
\begin_layout Itemize
Marker Channel: If you have more than one marker channel, choose the reference
 marker channel (default: use the fist marker channel in the file)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- Default (first marker channel=0)
\end_layout

\begin_layout Standard
- Number
\end_layout

\end_deeper
\begin_layout Paragraph*
Marker according to values or names
\end_layout

\begin_layout Standard
Trim from nn seconds after first marker with value or name x, to mm seconds
 after first marker with value or name y.
\end_layout

\begin_layout Itemize
From: Choose first marker with value or name x, and trimming point in seconds
 after this marker.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- First marker with value or name x: Either choose a numeric marker value
 or a marker name.
\end_layout

\begin_layout Standard
- Seconds after marker with value/name x: Choose a positive (after this
 marker) or negative (before this marker) value.
\end_layout

\end_deeper
\begin_layout Itemize
To: Choose first marker with value or name y, and trimming point in seconds
 after this marker.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- First Marker with value or name y: Either choose a numeric marker value
 or a marker name.
\end_layout

\begin_layout Standard
- Seconds after marker with value/name y: Choose a positive (after this
 marker) or negative (before this marker) value.
\end_layout

\end_deeper
\begin_layout Itemize
Marker Channel: If you have more than one marker channel, choose the reference
 marker channel (default: use the fist marker channel in the file)
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- Default (first marker channel=0)
\end_layout

\begin_layout Standard
- Number
\end_layout

\end_deeper
\begin_layout Subsubsection*
Overwrite Existing File
\end_layout

\begin_layout Standard
Choose 
\begin_inset Quotes eld
\end_inset

yes
\begin_inset Quotes erd
\end_inset

 if you want to overwrite existing file(s) with the same name.
 Default: no.
\end_layout

\begin_layout Section
Data preprocessing
\end_layout

\begin_layout Subsection
Preprocess heart data
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_ecg2hb, pspm_ecg2hb_amri, pspm_hb2hp, pspm_ppu2hb
\end_layout

\begin_layout Standard
Convert ECG to heart beat (Pan & Tompkins) detects QRS complexes in ECG
 data and write timestamps of detected R spikes into a new heart beat channel.
 This function uses an algorithm adapted from 
\begin_inset CommandInset citation
LatexCommand cite
key "Pan:1985aa"
literal "true"

\end_inset

 (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:QRS-detection"

\end_inset

).
 Hidden options for minimum and maximum heart rate become visible when the
 job is saved as a script and should only be used if the algorithm fails.
\end_layout

\begin_layout Standard
Convert ECG to heart beat (AMRI) similary detects QRS complexes in ECG data
 nad write timestamps of detected R peaks into a new heart beat channel.
 The algorithm used is described in 
\begin_inset CommandInset citation
LatexCommand cite
key "liu2012statistical"
literal "false"

\end_inset

.
 The algorithm is obtained using the software link described in this paper.
\end_layout

\begin_layout Standard
Convert Heart Beat to heart period interpolates heart beat time stamps into
 continuous heart period data and writes to a new channel.
 This function uses heart period rather than heart rate because heart period
 varies linearly with ANS input into the heart.
 
\end_layout

\begin_layout Standard
Convert Peripheral pulse oximetry to heart beat first creates a template
 from non-ambiguous heart beats.
 The signal is then cross correlated with the template and maxima are identified
 as heart beats.
 
\end_layout

\begin_layout Standard
Convert ECG to heart period allows to directly convert continuous ECG data
 into continuous heart period data.
 This function is a combination of the two functions “Convert ECG to heart
 beat” and “Convert Heart Beat to heart period”.
 
\end_layout

\begin_layout Standard
If, for ECG conversions, the semi automatic mode is enabled, the ECG editor
 will be shown.
 This allows manual inspection and correction of potentially wrong HB events.
 If the semi automatic mode is disabled, the conversion is done automatically,
 without showing the ECG editor.
 See ECG editor (
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:ECG-editor"

\end_inset

) for further information.
 
\end_layout

\begin_layout Subsubsection*
Data File
\end_layout

\begin_layout Standard
Specify data file.
\end_layout

\begin_layout Subsubsection*
Preprocessing
\end_layout

\begin_layout Standard
Add different preprocessing steps here.
 The converted data will be written into a new channel in the same file.
\end_layout

\begin_layout Subsubsection*
Convert ECG to Heart Beat (Pan & Tompkins)
\end_layout

\begin_layout Standard
Convert ECG data into Heart beat time stamps using modified Pan & Tompkins
 algorithm.
\end_layout

\begin_layout Paragraph*
Channel
\end_layout

\begin_layout Standard
Number of ECG channel (default: first ECG channel).
\end_layout

\begin_layout Paragraph*
Options
\end_layout

\begin_layout Itemize
Semi automatic mode: Allows manual correction of all potential beat intervals
 (default: off).
\end_layout

\begin_layout Subsubsection*
Convert ECG to Heart Beat (AMRI)
\end_layout

\begin_layout Standard
Convert ECG data into heart beat timestamps using AMRI algorithm 
\begin_inset CommandInset citation
LatexCommand cite
key "liu2012statistical"
literal "false"

\end_inset

.
 The algorithm performs template matching to classify candidate R-peaks
 after filtering the data and applying Teager Energy Operator (TEO).
\end_layout

\begin_layout Paragraph*
Channel
\end_layout

\begin_layout Standard
Number of the channel to preprocess (default: first ECG channel found in
 the datafile)
\end_layout

\begin_layout Paragraph*
Options
\end_layout

\begin_layout Itemize
Signal to use: Which signal to feed to the core heartbeat detection procedure.
 'ecg' corresponds to filtered ECG signal.
 'teo' corresponds to the signal obtained by filtering the ECG signal even
 more and applying the Teager Enery Operator.
 'auto' option picks the one of these two options that results in higher
 autocorrelation.
\end_layout

\begin_layout Itemize
Feasible heartrate range: Define the minimum and maximum possible heartrates
 for your data.
\end_layout

\begin_layout Itemize
ECG bandpass filter: Define the cutoff frequencies (Hz) for bandpass filter
 applied to raw ECG signal.
\end_layout

\begin_layout Itemize
TEO bandpass filter: Define the cutoff frequencies (Hz) for bandpass filter
 applied to filtered ECG signal before applying TEO.
\end_layout

\begin_layout Itemize
TEO order: Define the order 
\begin_inset Formula $k$
\end_inset

 of TEO.
 Note that for signal 
\begin_inset Formula $x(t)$
\end_inset

, 
\begin_inset Formula $TEO[x(t);k]=x(t)x(t)-x(t-k)x(t+k)$
\end_inset

.
\end_layout

\begin_layout Itemize
Minimum cross correlation: Define the minimum cross correlation between
 a candidate R-peak and the found template such that the candidate is classified
 as an R-peak.
\end_layout

\begin_layout Itemize
Minimum relative amplitude: Define the minimum relative amplitude of a candidate
 R-peak such that it is classified as an R-peak.
\end_layout

\begin_layout Subsubsection*
Convert Heart Beat to Heart Period
\end_layout

\begin_layout Standard
Convert heart beat time stamps into interpolated heart period time series.
 You can use the output of the ECG to Heart beat conversion, or directly
 work on heart beat time stamps, for example obtained by a pulse oxymeter.
\end_layout

\begin_layout Paragraph*
Channel
\end_layout

\begin_layout Standard
Number of Heart Beat channel (default: first Heart Beat channel).
\end_layout

\begin_layout Itemize
Default: First Heart Beat channel
\end_layout

\begin_layout Itemize
Number
\end_layout

\begin_layout Itemize
Processed channel: Convert a channel already preprocessed with ECG to Heart
 beat.
 Specify the preprocessed channel with a number corresponding to the position
 in the list of preprocessings.
\end_layout

\begin_layout Paragraph*
Sample rate
\end_layout

\begin_layout Standard
Sample rate for the interpolated time series (default: 10 Hz).
\end_layout

\begin_layout Paragraph*
Limit
\end_layout

\begin_layout Standard
Define unrealistic values which should be ignored and interpolated.
\end_layout

\begin_layout Itemize
Upper limit: Values bigger than this value (in seconds) will be ignored
 and interpolated.
 Default: 2
\end_layout

\begin_layout Itemize
Lower limit: Values smaller than this value (in seconds) will be ignored
 and interpolated.
 Default: 0.2
\end_layout

\begin_layout Subsubsection*
Convert ECG to Heart Period
\end_layout

\begin_layout Paragraph*
Channel
\end_layout

\begin_layout Standard
Number of ECG channel (default: first ECG channel).
\end_layout

\begin_layout Paragraph*
Options
\end_layout

\begin_layout Itemize
Semi automatic mode: Allows manual correction of all potential beat intervals
 (default: off).
\end_layout

\begin_layout Paragraph*
Sample rate
\end_layout

\begin_layout Standard
Sample rate for the interpolated time series (default: 10 Hz).
\end_layout

\begin_layout Paragraph*
Limit
\end_layout

\begin_layout Standard
Define unrealistic values which should be ignored and interpolated.
\end_layout

\begin_layout Itemize
Upper limit: Values bigger than this value (in seconds) will be ignored
 and interpolated.
 Default: 2
\end_layout

\begin_layout Itemize
Lower limit: Values smaller than this value (in seconds) will be ignored
 and interpolated.
 Default: 0.2
\end_layout

\begin_layout Subsubsection*
Convert Peripheral pulse oximetry to Heart Beat
\end_layout

\begin_layout Paragraph*
Channel
\end_layout

\begin_layout Standard
Number of Peripheral pulse oximetry channel (default: first Peripheral pulse
 oximetry channel)
\end_layout

\begin_layout Subsubsection*
Channel action
\end_layout

\begin_layout Standard
Choose whether to add the new channels or replace a channel previously added
 by this method.
 (default: replace)
\end_layout

\begin_layout Subsection
ECG editor 
\begin_inset CommandInset label
LatexCommand label
name "subsec:ECG-editor"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_ecg_editor
\end_layout

\begin_layout Standard
The ECG editor is integrated into the QRS detection and can also be used
 offline, after QRS detection.
 It allows to graphically inspect and correct (if necessary) the detected
 QRS markers.
 To faciliate QRS inspection in data sets with known artefact epochs, the
 user can load epoch files which define such artefact periods.
 This allows the editor to either ignore or even remove QRS markers which
 fall into artefact periods.
\end_layout

\begin_layout Subsubsection*
Startup
\end_layout

\begin_layout Standard
The ECG editor can be started from the PsPM window, from the Matlabbatch
 window or from the command line.
\end_layout

\begin_layout Standard
From the command line the ECG editor can be started by typing 
\family typewriter
pspm_ecg_editor(argument)
\family default
 into the Matlab command line.
 For this the PsPM folder has to be added to the matlab path beforehand.
 Arguments are either a data struct (generated usually by 
\family typewriter
pspm_ecg2hb
\family default
) or a path to a PsPM file.
\end_layout

\begin_layout Subsubsection*
Data modes
\end_layout

\begin_layout Standard
Similar to the data editor the ECG editor supports two types of operation
 modes, which depend on the startup arguments.
 
\end_layout

\begin_layout Paragraph*
File mode
\end_layout

\begin_layout Standard
Is entered when the editor is started from the PsPM window, from the Matlabbatch
 or when a file path or no argument is specified at the command line startup.
 If the first argument is a file path, a second (ECG channel) and a third
 argument (Options struct) is possible.
 The second argument specifies the ECG channel to be plotted.
 The third argument is expected to be a struct with the following fields:
\end_layout

\begin_layout Itemize
hb - specifies a HB channel which contains the QRS markers to be inspected
\end_layout

\begin_layout Itemize
factor - specifies the minimum factor faulty QRS markers should deviate
 from the standard deviation (default is 2)
\end_layout

\begin_layout Itemize
semi - specifies whether to navigate between potentially wrong hb events
 only (semi mode), or between all hb events (manual mode; semi mode is enabled
 by default).
\end_layout

\begin_layout Itemize
limits - with fields 'lower' and 'upper' defines hard limits for the faulty
 detection (default is 120bpm [upper] and 40bpm [lower])
\end_layout

\begin_layout Standard
The second and third argument is optional.
 In file mode the 'Input / Output' panel on the bottom of the left side
 is visible.
 It allows to specifiy and change input files and channels (ECG and HB)
 and allows to choose whether the edited data should be added as a new HB
 channel or replace the existing HB channel.
 
\end_layout

\begin_layout Paragraph*
Inline mode
\end_layout

\begin_layout Standard
The inline mode is usually used together with 
\family typewriter
pspm_ecg2hb
\family default
.
 Therefore a struct which is generated by the latter function is expected.
 The following fields are needed for the editor:
\end_layout

\begin_layout Itemize
settings
\end_layout

\begin_deeper
\begin_layout Itemize
.outfact - specifies to which factor faulty QRS markers should deviate from
 the standard deviation
\end_layout

\begin_layout Itemize
.sr - specifies the sample rate of the data
\end_layout

\end_deeper
\begin_layout Itemize
data
\end_layout

\begin_deeper
\begin_layout Itemize
.x - contains the ecg data values
\end_layout

\begin_layout Itemize
.r - contains n x 4 vector where n corresponds to the ecg data values and
 columns 1-4 tell whether there is a QRS marker (column 1-4) and whether
 a QRS marker is faulty (column 2).
 Columns 3 and 4 are ignored and regenerated during data inspection
\end_layout

\end_deeper
\begin_layout Itemize
set
\end_layout

\begin_deeper
\begin_layout Itemize
.R - contains sample ids of all the QRS markers
\end_layout

\end_deeper
\begin_layout Subsubsection*
Editor output
\end_layout

\begin_layout Standard
The output always contains as a first argument a status (sts).
 If the status equals 1 no error happend while creating the output.
 Otherwise the editor could not successfully create the output.
 The second output depends on the data mode and in file mode contains the
 channel id of the written channel.
 In inline mode the second output argument is a data vector which contains
 the sample ids of the resulting QRS markers.
\end_layout

\begin_layout Subsubsection*
Data inspection
\end_layout

\begin_layout Paragraph*
Navigation
\end_layout

\begin_layout Standard
The ECG editor uses QRS markers as anchor points for the navigation.
 One option to navigate between QRS markers is to use the listbox placed
 in 'Heart beat events' on the right side of the plot.
 Selecting a QRS marker in the listbox will cause the plot to center the
 selected marker with some space left before and after depending on the
 zoom state.
 If manual mode is active, the listbox contains all QRS markers available
 (all colors), otherwise it will only contain QRS markers marked as faulty
 (orange).
 The navigation buttons ('<<' and '>>') below the listbox allow moving back
 and forth in the plot.
 In manual mode the step size equals the size of the plot window.
 If manual mode is inactive, the next/previous step equals jumping to the
 next/previous faulty QRS marker.
\end_layout

\begin_layout Paragraph*
Zooming
\end_layout

\begin_layout Standard
The zoom buttons are placed on the upper right.
 Zooming in will cause the time window to be shortened by the factor of
 two.
 Zooming out will cause the time window to be extended by the factor of
 two.
\end_layout

\begin_layout Paragraph*
Add QRS marker
\end_layout

\begin_layout Standard
The button for this is placed on the upper right side.
 Once clicked the cursor will turn into a crosshair.
 After that, clicking on the plot will cause an additional QRS marker to
 be added at that position (a green QRS marker appears).
\end_layout

\begin_layout Paragraph*
Remove QRS marker
\end_layout

\begin_layout Standard
The button is also placed on the upper right side.
 The cursor aswell will turn into a crosshair but different to adding QRS
 markers, clicking on the plot (without releasing the mouse-button) will
 cause a selection rectangle to be drawn.
 Upon release of the mouse-button all QRS markers which lie in the selection
 rectangle will be marked for removal (violet).
\end_layout

\begin_layout Subsubsection*
Artefact epochs
\end_layout

\begin_layout Standard
Settings for the artefact epochs can be found in the 'Artefact epochs' panel.
\end_layout

\begin_layout Paragraph*
Load / Disable
\end_layout

\begin_layout Standard
Clicking the 'Load' button causes a file dialog to appear, which allows
 to choose a PsPM epoch/timing file containing the definition of artefact
 epochs.
 The button 'Disable' will cause the artefact epochs to be unloaded and
 artefact settings to be disabled.
 Once an artefact epoch file is loaded, QRS marker stems and listbox font
 color will turn grey if they lie within an artefact epoch.
\end_layout

\begin_layout Paragraph*
Display settings
\end_layout

\begin_layout Standard
There are three different display options on how to deal with QRS markers
 which fall into artefact epochs.
\end_layout

\begin_layout Itemize
use all QRS markers - do nothing; all markers will be displayed and used
 for faulty detection
\end_layout

\begin_layout Itemize
exclude artefact periods from faulty QRS detection - still all markers will
 be displayed but QRS markes in artefact periods will be ignored for faulty
 detection
\end_layout

\begin_layout Itemize
hide QRS markers during artefact periods - QRS markers in artefact periods
 will be hidden and ignored for faulty detection
\end_layout

\begin_layout Paragraph*
Output settings
\end_layout

\begin_layout Standard
There are two different output options on how to deal with QRS markes which
 fall into artefact epochs.
\end_layout

\begin_layout Itemize
include QRS during artefact periods - all markers (faulty and valid) including
 those lying in artefact periods will be either returned or written to the
 new HB channel.
\end_layout

\begin_layout Itemize
remove QRS during artefact periods - only markes (faulty and valid) outside
 of artefact periods will be either returned or written to the new HB channel.
\end_layout

\begin_layout Subsubsection*
Faulty detection
\end_layout

\begin_layout Standard
Settings for faulty detection can be changed in the 'Heart beat events'
 panel.
 The following settings are possible.
\end_layout

\begin_layout Itemize
Detection factor - specifies the minimum factor faulty QRS markers should
 deviate from the standard deviation
\end_layout

\begin_layout Itemize
Upper limit - Heart rates higher than the upper limit will be marked as
 faulty
\end_layout

\begin_layout Itemize
Lower limit - Heart rates lower than the lower limit will be marked as faulty
\end_layout

\begin_layout Standard
When changed settings should be applied, clicking 'Find faulty' will cause
 the plot to be refreshed.
\end_layout

\begin_layout Subsubsection*
Color coding
\end_layout

\begin_layout Paragraph*
Stem / Listbox background colors
\end_layout

\begin_layout Itemize
Valid QRS marker ⇒ blue
\end_layout

\begin_layout Itemize
Faulty QRS marker ⇒ orange
\end_layout

\begin_layout Itemize
Added QRS marker ⇒ green
\end_layout

\begin_layout Itemize
Removed QRS marker ⇒ violet
\end_layout

\begin_layout Paragraph*
Artefact periods
\end_layout

\begin_layout Standard
The color of QRS markers lying in artefact periods will be converted to
 greyscale.
 This applys for the marker stems (not the tips) and the listbox font color.
\end_layout

\begin_layout Subsubsection*
Matlabbatch
\end_layout

\begin_layout Standard
Possible options when the ECG editor is started from Matlabbatch.
\end_layout

\begin_layout Paragraph*
Data file
\end_layout

\begin_layout Standard
Specify the PsPM datafile containing the ECG data
\end_layout

\begin_layout Paragraph*
ECG channel
\end_layout

\begin_layout Standard
Specify the channel containing the ECG data.
\end_layout

\begin_layout Itemize
Default
\end_layout

\begin_layout Itemize
Number
\end_layout

\begin_layout Paragraph*
HB channel
\end_layout

\begin_layout Standard
Specify the channel containing the HB data.
\end_layout

\begin_layout Itemize
None
\end_layout

\begin_layout Itemize
Number
\end_layout

\begin_layout Paragraph*
Artefact Epochs
\end_layout

\begin_layout Standard
Specify a PsPM timing file defining artefact epochs.I
\end_layout

\begin_layout Itemize
Disabled
\end_layout

\begin_layout Itemize
File
\end_layout

\begin_layout Paragraph*
Faulty detection settings
\end_layout

\begin_layout Standard
Settings for the faulty detection.
\end_layout

\begin_layout Itemize
Factor: The minimum factor potentially wrong QRS complexes should deviate
 from the standard deviation.
\end_layout

\begin_layout Itemize
Limit: Define hard limits for the faulty detection.
\end_layout

\begin_deeper
\begin_layout Itemize
Upper limit: Values bigger than this value (in bpm) will be marked as faulty.
 Default: 120.
\end_layout

\begin_layout Itemize
Lower limit: Values smaller than this value (in bpm) will be marked as faulty.
 Default: 40.
\end_layout

\end_deeper
\begin_layout Subsection
Preprocess respiration data
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_resp_pp
\end_layout

\begin_layout Standard
Convert continuous respiration traces into interpolated respiration period,
 amplitude, or RFR, or into time stamps indicating the start of inspiration.
 This function detects the beginning of inspiration (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Breathing-cycle-detection"

\end_inset

), assigns period/amplitude/RFR of the last cycle to this data point, and
 interpolates data (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Interpolation-and-Filtering-Resp"

\end_inset

).
 This function outputs respiration period rather than respiration rate in
 analogy to heart period models - heart period linearly varies with ANS
 input to the heart.
 RFR (respiratory flow rate) is the integral of the absolute thorax excursion
 per respiration cycle, divided by the cycle period.
 Converted data are written into new channel(s).
\end_layout

\begin_layout Subsubsection*
Data File
\end_layout

\begin_layout Standard
Specify data file.
 The processed respiration data will be written to a new channel in this
 file.
\end_layout

\begin_layout Subsubsection*
Sample Rate
\end_layout

\begin_layout Standard
Sample rate for the new channel.
 Default: 10 Hz.
 Will be ignored for datatype "respiration time stamps".
\end_layout

\begin_layout Subsubsection*
Channel
\end_layout

\begin_layout Standard
Number of respiration channel (default: first respiration channel).
\end_layout

\begin_layout Subsubsection*
Options
\end_layout

\begin_layout Paragraph*
System type
\end_layout

\begin_layout Standard
Type of the measuring system: bellows or cushion (default: bellows).
\end_layout

\begin_layout Paragraph*
Datatype
\end_layout

\begin_layout Standard
Choose for each possible process datatype either yes or no (default: yes):
\end_layout

\begin_layout Itemize
Respiration period: Create a channel with interpolated respiration period
\end_layout

\begin_layout Itemize
Respiration amplitude: Create a channel with interpolated respiration amplitude
\end_layout

\begin_layout Itemize
Respiratory flow rate: Create a channel with interpolated respiratory flow
 rate
\end_layout

\begin_layout Itemize
Respiration time: Create a channel with respiration time stamp
\end_layout

\begin_layout Paragraph*
Diagnostic plot
\end_layout

\begin_layout Standard
Specify whether a respiratory cycle detection plot should be created (Yes)
 or not (No) (default: No).
\end_layout

\begin_layout Subsubsection*
Channel action
\end_layout

\begin_layout Standard
Choose whether to add the new channels or replace a channel previously added
 by this method.
 (default: add)
\end_layout

\begin_layout Subsection
Prepare illuminance GLM
\begin_inset CommandInset label
LatexCommand label
name "subsec:Prepare-illuminance-GLM"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_process_illuminance
\end_layout

\begin_layout Standard
Transform an illuminance time series into a convolved pupil response time
 series to be used as nuisance file in a GLM.
 This allows you to partial out illuminance contributions to pupil responses
 evoked by cognitive inputs.
 Alternatively you can analyse the illuminance responses themselves, by
 extracting parameter estimates relating to the regressors from the GLM.
 
\end_layout

\begin_layout Standard
The illuminance file should be a .mat file with a vector variable called
 Lx.
 In order to fulfill the requirements of a later nuisance file there must
 be as many values as there are data values in the data file.
 The data must be given in lux (lm/m²) to account for the non-linear mapping
 from illuminance to steady-state pupil size.
 A function to transform luminace (cd/m²) to illuminace values is provided
 under PsPM > Data processing > Pupil & Eyetracking.
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset


\end_layout

\begin_layout Subsubsection*
Illuminance file
\end_layout

\begin_layout Standard
Select a file that contains illuminance data.
 The file should contain a variable 'Lx' which should be an n x 1 numeric
 vector containing the illuminance values.
\end_layout

\begin_layout Subsubsection*
Sample rate
\end_layout

\begin_layout Standard
Specify the sample rate of the illuminance data.
\end_layout

\begin_layout Subsubsection*
Basis function options
\end_layout

\begin_layout Standard
Specify options for the basis functions.
\end_layout

\begin_layout Itemize
Duration: Specify the duration of the basis function in seconds (default:
 20 s).
 
\end_layout

\begin_layout Itemize
Offset: Specify an offset of the basis function in seconds (default: 0.2
 s).
\end_layout

\begin_layout Itemize
Dilation: Specify the basis function to model the dilation response.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
LDRF_GM: Use gamma probability density function to model the dilation response
 (default).
\end_layout

\begin_layout Itemize
LDRF_GU: Use a smoothed gaussian function to model the dilation response.
\end_layout

\end_deeper
\begin_layout Itemize
Constriction: Specify the basis function to model the constriction response.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
LCRF_GM: Use gamma probability density function to model the constriction
 response (default).
\end_layout

\end_deeper
\begin_layout Subsubsection*
Output directory
\end_layout

\begin_layout Standard
Specify the directory where the .mat file with the resulting nuisance data
 will be written.
\end_layout

\begin_layout Subsubsection*
Filename for output
\end_layout

\begin_layout Standard
Specify the name for the resulting nuisance file.
\end_layout

\begin_layout Subsubsection*
Overwrite existing file
\end_layout

\begin_layout Standard
Choose “yes” if you want to overwrite an existing file with the same name.
 (Default: No) 
\end_layout

\begin_layout Subsection
Find valid fixations
\begin_inset CommandInset label
LatexCommand label
name "subsec:Find-valid-fixations"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_find_valid_fixations
\end_layout

\begin_layout Standard
Pupil data time series can contain missing values due to blinks and head
 movements.
 Additionally, pupil measurements obtained from a video-based eye tracker
 depend on the gaze angle, therefore breaks of fixation can be excluded.
 Valid fixations can be determined by setting an a priori threshold with
 respect to the fixation point (in degree visual angle) for x- or y-gaze-positio
ns.
 The input are x- and y-gaze positions converted to length units (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Convert-data"

\end_inset

).
 The output is a time series with NaN values during invalid fixations (discrimin
ated according to parameters passed to the function).
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a,Hayes:2015a"
literal "true"

\end_inset


\end_layout

\begin_layout Subsubsection*
Data file
\end_layout

\begin_layout Standard
Specify the PsPM datafile containing the gaze recordings in length units.
\end_layout

\begin_layout Subsubsection*
Eyes
\end_layout

\begin_layout Standard
Choose eyes which should be processed.
 If ‘All eyes’ is selected, all eyes which are present in the data will
 be processed.
 Otherwise only the chosen eye will be processed.
 (All eyes [Default], Left eye, Right eye)
\end_layout

\begin_layout Subsubsection*
Validation method
\end_layout

\begin_layout Standard
You can either validate the data by indicating a range on the screen (in
 degree visual angle) and fixation point(s) or by passing a bitmap representing
 the screen and holding a 1 for all the fixations that are valid.
\end_layout

\begin_layout Itemize

\series bold
Validation settings
\series default
: Settings to validate fixations within a given range on the screen (in
 degree visual angle).
\end_layout

\begin_deeper
\begin_layout Itemize

\shape slanted
Visual angle:
\shape default
 Range of valid fixations (around a fixation point).
 The value has to be in degree visual angle.
\end_layout

\begin_layout Itemize

\shape slanted
Distance
\shape default
: Distance between eyes and screen in in length units.
\end_layout

\begin_layout Itemize

\shape slanted
Unit
\shape default
: Unit in which the distance is given.
\end_layout

\begin_layout Itemize

\shape slanted
Resolution
\shape default
: Resolution to which the fixation point refers (maximum value of the x-
 and y-coordinates).
 This can be the resolution set in cogent / psychtoolbox (e.g.
 [1280 1024]) or the width and height of the screen in length units (e.g.
 [50 40]).
\end_layout

\begin_layout Itemize

\shape slanted
Fixation point: 
\shape default
X- and y-coordinates for the point of fixation with respect to the given
 resolution.
\end_layout

\begin_deeper
\begin_layout Itemize
Default: If default is set, the middle of the screen will be defined as
 fixation point.
\end_layout

\begin_layout Itemize
File: .mat file containing a variable F with an n x 2 matrix.
 N should have the length of the recorded data and each row should define
 the fixation point for the respective recorded data row.
\end_layout

\begin_layout Itemize
Point: If the fixation point does not change during the acquisition, specify
 x- and y-coordinates of the constant fixation point.
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize

\series bold
Bitmap file
\series default
: .mat file containing a variable called 'bitmap', which is an n x m matrix.
 The bitmap represents the display (n=height and m = width) and holds for
 each position a 1, where a gaze point is valid, and a 0 otherwise.
 Gaze data at invalid positions (indicated by bitmap or outside the display)
 are set to NaN.
\end_layout

\begin_layout Subsubsection*
Channels
\end_layout

\begin_layout Standard
Enter a list of channels (numbers or names) to work on.
 Default is pupil channels.
 Channels which depend on eyes will automatically be expanded.
 E.g.
 pupil becomes pupil_l.
\end_layout

\begin_layout Subsubsection*
Missing
\end_layout

\begin_layout Standard
If enabled an additional channel containing additional information about
 valid data points will be written.
 Data points equal to 1 describe epochs which have been discriminated as
 invalid during validation (=missing).
 Data points equal to 0 describe epochs of valid data.
 This function may be enabled in combination with enabled interpolation.
\end_layout

\begin_layout Paragraph*
Enabled
\end_layout

\begin_layout Standard
Missing is enabled.
\end_layout

\begin_layout Paragraph*
Disabled
\end_layout

\begin_layout Standard
Missing is disabled.
\end_layout

\begin_layout Subsubsection*
Output settings
\end_layout

\begin_layout Standard
Define how the validated data should be stored.
\end_layout

\begin_layout Paragraph*
File output
\end_layout

\begin_layout Standard
Write data to a new file or overwrite original data file.
\end_layout

\begin_layout Itemize
Overwrite original file: Overwrite original data file.
\end_layout

\begin_layout Itemize
Create new file: Write data into given file.
 The original data will be copied to the given file and the new data channels
 will, according to the channel output, either be added or replace the original
 channels.
\end_layout

\begin_deeper
\begin_layout Itemize
File path: Path to new file.
\end_layout

\begin_layout Itemize
File name: Name of new file.
\end_layout

\end_deeper
\begin_layout Paragraph*
Channel action
\end_layout

\begin_layout Standard
Choose whether to add the new channels or replace a channel previously added
 by this method.
 (default: add)
\end_layout

\begin_layout Subsection
Pupil Foreshortening Error Correction 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Pupil-Foreshortening-Error"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_pupil_correct, pspm_pupil_correct_eyelink
\end_layout

\begin_layout Paragraph*

\series medium
Perform pupil foreshortening error correction using the equations described
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

.
 To perform correction, we define the coordinate system centered on the
 pupil.
 In this system, 
\begin_inset Formula $x$
\end_inset

 coordinates grow towards right for a person looking forward in an axis
 perpendicular to the screen.
 
\begin_inset Formula $y$
\end_inset

 coordinates grow upwards and 
\begin_inset Formula $z$
\end_inset

 coordinates grow towards the screen.
\end_layout

\begin_layout Standard
In order to perform PFE, we need both pupil and gaze data.
 If the gaze data in the given file is in pixels, we need information about
 the screen dimensions and resolution to calculate the pixel to milimeter
 ratio.
 On the other hand, if the gaze data is in mm, cm, inches, etc., there is
 no need to enter any screen size related information.
 If the gaze data is in pixels and screen information is not given, the
 function emits a warning and exits early.
 
\end_layout

\begin_layout Subsubsection*
Data file
\end_layout

\begin_layout Standard
Specify the PsPM datafile containing the pupil and gaze recordings.
\end_layout

\begin_layout Subsubsection*
Screen resolution
\end_layout

\begin_layout Standard
Specify screen resolution ([width height]) in pixels.
 Screen resolution is required only if at least one gaze channel is in pixels.
\end_layout

\begin_layout Subsubsection*
Screen size
\end_layout

\begin_layout Standard
Specify screen size ([width height]) in milimeters.
 Screen size is required only if at least one gaze channel is in pixels.
\end_layout

\begin_layout Subsubsection*
Correction method
\end_layout

\begin_layout Standard
Choose the correction method:
\end_layout

\begin_layout Itemize
auto: In auto mode, you need to enter 
\begin_inset Formula $C_{z}$
\end_inset

 value.
 Other values will be set using the optimized parameters in reference paper.
 
\series bold
Note that you should only use auto mode if your geometric setup matches
 exactly one of the layouts given in
\series default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

.
 For ease of reference, we include the page from 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

 that describes the three layouts below.
\end_layout

\begin_layout Itemize
manual: In manual mode, you need to enter all values defining the geometry.
\end_layout

\begin_layout Subsubsection*
Geometry Setup
\end_layout

\begin_layout Standard
To perform correction, we define the coordinate system centered on the pupil.
 In this system, x coordinates grow towards right for a person staring at
 the screen.
 y coordinates grow upwards and z coordinates grow towards the screen.
\end_layout

\begin_layout Itemize
\begin_inset Formula $C_{x}:$
\end_inset

Horizontal displacement of the camera with respect to the eye.
 (Unit: milimeters).
\end_layout

\begin_layout Itemize
\begin_inset Formula $C_{y}$
\end_inset

: Vertical displacement of the camera with respect to the eye.
 (Unit: milimeters).
\end_layout

\begin_layout Itemize
\begin_inset Formula $C_{z}$
\end_inset

: Eye to camera Euclidean distance if they are on the same x and y coordinates.
 (Unit: milimeters).
\end_layout

\begin_layout Itemize
\begin_inset Formula $S_{x}$
\end_inset

: Horizontal displacement of the top left corner of the screen with respect
 to the eye.
 (Unit: milimeters).
\end_layout

\begin_layout Itemize
\begin_inset Formula $S_{y}$
\end_inset

: Vertical displacement of the top left corner of the screen with respect
 to the eye.
 (Unit: milimeters).
\end_layout

\begin_layout Itemize
\begin_inset Formula $S_{z}$
\end_inset

: Eye to top left screen corner distance if they are on the same x and y
 coordinates.
 (Unit: milimeters).
\end_layout

\begin_layout Standard
Refer to the geometry setup from 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{figure}
\end_layout

\begin_layout Plain Layout

	
\backslash
centering
\end_layout

\begin_layout Plain Layout

	
\backslash
includegraphics[width=
\backslash
linewidth]{Figures/Hayes-Petrov2016_Article_MappingAndCorrectingTheInfluen_svg.pd
f}
\end_layout

\begin_layout Plain Layout

	
\backslash
caption{Hayes 
\backslash
& Petrov, 2015, page 5}
\end_layout

\begin_layout Plain Layout


\backslash
end{figure}
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Channel to correct
\end_layout

\begin_layout Itemize
Channel definition: Choose the channel definition.
 Only the last channel in the file corresponding to the selection will be
 corrected.
\end_layout

\begin_layout Itemize
Channel number: Number of the pupil channel in the PsPM file.
\end_layout

\begin_layout Subsubsection*
Channel action
\end_layout

\begin_layout Itemize
add: Add a new preprocessed channel to the PsPM file.
 The new channel type will contain a 'pp' suffix at the end if the input
 channel did not contain a 'pp' suffix.
\end_layout

\begin_layout Itemize
replace: Replace previously existing preprocessed channel.
 If no preprocessed channel exists, this option behaves the same way as
 add option.
 (default)
\end_layout

\begin_layout Subsection
Pupil Preprocessing 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Pupil-Preprocessing"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_pupil_pp, pspm_pupil_pp_options
\end_layout

\begin_layout Subparagraph*

\series medium
Pupil size preprocessing using the steps described in 
\begin_inset CommandInset citation
LatexCommand cite
key "kret2018preprocessing"
literal "false"

\end_inset

.
 This function allows users to preprocess two eyes simultaneously and average
 them in addition to offering single eye preprocessing.
 Further, users can define segments on which statistics such as min, max,
 mean, etc.
 will be computed.
 We shortly describe the steps performed below:
\end_layout

\begin_layout Enumerate
Pupil preprocessing is performed in two main steps.
 In the first step, the 
\begin_inset Quotes eld
\end_inset

valid
\begin_inset Quotes erd
\end_inset

 samples are determined.
 The samples that are not valid are not used in the second step.
 Determining valid samples is done by
\end_layout

\begin_deeper
\begin_layout Enumerate
Range filtering: Pupil size values outside a predefined range are considered
 invalid.
 This range is configurable.
\end_layout

\begin_layout Enumerate
Speed filtering: Speed is computed as the 1st difference of pupil size array
 normalized by the temporal separation.
 Samples with speed higher than a threshold are considered invalid.
 The threshold is configurable.
\end_layout

\begin_layout Enumerate
Edge filtering: Samples at both sides of temporal gaps in the data are considere
d invalid.
 Both the duration of gaps and the invalid sample duration before/after
 the gaps are configurable.
\end_layout

\begin_layout Enumerate
Trendline filtering: A data trend is generated by smoothing and interpolating
 the data.
 Then, samples that are too far away from this trend are considered invalid.
 These two steps are performed multiple times in an iterative fashion.
 Note that the generated trend is 
\series bold
not
\series default
 the final result of this function.
 The smoothing, invalid threshold and the number of passes are configurable.
\end_layout

\begin_layout Enumerate
Isolated sample filtering: Isolated and small sample islands are considered
 invalid.
 The size of the islands and the temporal separation are configurable.
\end_layout

\end_deeper
\begin_layout Enumerate
In the second step, output smooth signal is generated using the valid samples
 found in the previous step.
 This is done by performing filtering, upsampling and interpolation.
 The parameters of the filtering and upsampling are configurable.
\end_layout

\begin_layout Subsubsection*
Data file
\end_layout

\begin_layout Standard
Specify the PsPM datafile containing the pupil and gaze recordings.
\end_layout

\begin_layout Subsubsection*
Channel to correct
\end_layout

\begin_layout Itemize
Channel definition: Choose the channel definition.
 Only the last channel in the file corresponding to the selection will be
 corrected.
\end_layout

\begin_layout Itemize
Channel number: Number of the pupil channel in the PsPM file.
\end_layout

\begin_layout Subsubsection*
Channel to combine
\end_layout

\begin_layout Standard
Optionally choose the additional channel to use so that a new, combined
 preprocessed channel can be constructed using the two input channels.
 The combined channel is created by computing the mean of the two preprocessed
 channels.
 Note that main and combined input channels 
\series bold
must
\series default
 correspond to different eyes.
\end_layout

\begin_layout Itemize
Channel definition: Choose the channel definition.
 Only the last channel in the file corresponding to the selection will be
 corrected.
\end_layout

\begin_layout Itemize
Channel number: Number of the pupil channel in the PsPM file.
\end_layout

\begin_layout Subsubsection*
Channel action
\end_layout

\begin_layout Itemize
add: Add a new preprocessed channel to the PsPM file.
 The new channel type will contain a 'pp' suffix at the end if the input
 channel did not contain a 'pp' suffix.
\end_layout

\begin_layout Itemize
replace: Replace a previously existing preprocessed channel.
 If no preprocessed channel exists, this option behaves the same way as
 add option.
 (default)
\end_layout

\begin_layout Subsubsection*
Settings
\end_layout

\begin_layout Itemize
default: Use the default settings provided in the underlying preprocessing
 implementation.
\end_layout

\begin_layout Itemize
custom: In custom settings mode, you can specify any of the settings below
 according to your preferences.
\end_layout

\begin_deeper
\begin_layout Itemize
Minimum allowed pupil diameter: Minimum allowed pupil diameter.
 (Unit: in the same unit as the pupil channel)
\end_layout

\begin_layout Itemize
Maximum allowed pupil diameter: Maximum allowed pupil diameter.
 (Unit: in the same unit as the pupil channel)
\end_layout

\begin_layout Itemize
Island separation min distance: Minimum distance used to consider samples
 'separated'.
 Separated samples can later be considered invalid depending on other parameters.
 (Unit: ms)
\end_layout

\begin_layout Itemize
Min valid island width: Minimum temporal width required to still consider
 a sample island valid.
 If the temporal width of the island is less than this value, all the samples
 in the island will be marked as invalid.
 (Unit: ms)
\end_layout

\begin_layout Itemize
Number of medians in speed filter: Number of median to use as the cutoff
 threshold when applying the speed filter.
\end_layout

\begin_layout Itemize
Max gap to compute speed: Only calculate the speed when the gap between
 samples is smaller than this value.
 (Unit: ms)
\end_layout

\begin_layout Itemize
Min missing data width: Minimum width of a missing data section that causes
 it to be classified as a gap.
 (Unit: ms)
\end_layout

\begin_layout Itemize
Max missing data width: Maximum width of a missing data section that causes
 it to be classified as a gap.
 (Unit: ms)
\end_layout

\begin_layout Itemize
Reject before missing data: The section right before the start of a gap
 within which samples are to be rejected.
 (Unit: ms)
\end_layout

\begin_layout Itemize
Reject after missing data: The section right after the end of a gap within
 which samples are to be rejected.
 (Unit: ms)
\end_layout

\begin_layout Itemize
Deviation filter passes: Number of passes deviation filter makes.
\end_layout

\begin_layout Itemize
Number of medians in deviation filter: The multiplier used when defining
 the threshold.
 Threshold equals this multiplier times the median.
 After each pass, all the input samples that are outside the threshold are
 removed.
 Note that all samples (even the ones which may have been rejected by the
 previous devation filter pass) are considered.
\end_layout

\begin_layout Itemize
Butterworth sampling frequency: 
\begin_inset Formula $F_{S}$
\end_inset

 for first order Butterworth filter.
 (Unit: Hz)
\end_layout

\begin_layout Itemize
Butterworth cutoff frequency: Cutoff frequency for first order Butterworth
 filter.
 (Unit: Hz)
\end_layout

\begin_layout Itemize
Store intermediate steps: If true, intermediate filter data will be stored
 for plotting.
 Set to false to save memory and improve plotting performance.
\end_layout

\begin_layout Itemize
Interpolation upsampling frequency: The upsampling frequency used to generate
 the smooth signal.
 (Unit: Hz)
\end_layout

\begin_layout Itemize
Lowpass filter cutoff frequency: Cutoff frequency of the lowpass filter
 used during final smoothing.
 (Unit: Hz)
\end_layout

\begin_layout Itemize
Lowpass filter order: Filter order of the lowpass filter used during final
 smoothing.
\end_layout

\begin_layout Itemize
Interpolation max gap: Maximum gap in the used (valid) raw samples to interpolat
e over.
 Sections that were interpolated over distances larger than this value will
 be set to NaN.
 (Unit: ms)
\end_layout

\end_deeper
\begin_layout Subsubsection*
Segments
\end_layout

\begin_layout Standard
Optionally define any number of segments.
 Simple statistics for each segment will be calculated.
 These segments will be stored in the output channel and also will be shown
 if plotting is enabled.
\end_layout

\begin_layout Itemize
Segment start: Start of the segment in seconds.
\end_layout

\begin_layout Itemize
Segment stop: End of the segment in seconds.
\end_layout

\begin_layout Itemize
Segment name: Name of the segment.
\end_layout

\begin_layout Subsubsection*
Plot data
\end_layout

\begin_layout Standard
Choose whether to plot the result of preprocessing and possibly various
 filtering steps performed.
\end_layout

\begin_layout Subsection
Convert data
\begin_inset CommandInset label
LatexCommand label
name "subsec:Convert-data"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_convert_area2mm, pspm_convert_pixel2unit
\end_layout

\begin_layout Standard
Provides conversion functions for the specified data (e.g.
 pupil data).
 Currently conversions from area to diameter and from pixel to length units
 are available.
\end_layout

\begin_layout Subsubsection*
Data file
\end_layout

\begin_layout Standard
Specify the PsPM datafile containing the channels to be converted.
\end_layout

\begin_layout Subsubsection*
Conversions
\end_layout

\begin_layout Paragraph*
Channel
\end_layout

\begin_layout Standard
Specify the channel which should be converted.
 If 0, functions are executed on all channels.
\end_layout

\begin_layout Paragraph*
Mode
\end_layout

\begin_layout Standard
Choose conversion mode.
\end_layout

\begin_layout Itemize

\shape italic
Area to diameter
\end_layout

\begin_layout Itemize

\shape italic
Pixel to unit
\shape default
: Convert pupil gaze coordinates from pixel values to unit values.
 The unit values can be distance units or degree visual angle.
 In the latter case, the data are first converted into distance units and
 then to visual angle.
 Visual angle is expressed in spherical coordinates as two-element vector
 where the first element refers to the azimuth angle and the second to the
 elevation angle.
 The azimuth angle is the counterclockwise angle in the x-y plane measured
 in degree from the positive x-axis (This axis is parallel to the screen
 pointing toward your right).
 The elevation angle is the angle in degree from the x-y plane in z-axis
 direction.
 The range for the azimuth indicates the angle of the left left edge of
 the screen to the angle of the right edge of the screen.
 The range for the elevation indicates the angle of the bottom edge of the
 screen to the angle of the top edge of the screen.
 (mathworks.com/help/matlab/ref/cart2sph.html ).
\end_layout

\begin_deeper
\begin_layout Itemize
Width: Width of the display window.
 Unit is 'mm' if 'degree' is chosen, otherwise Unit.
 
\end_layout

\begin_layout Itemize
Height: Height of the display window.
 Unit is 'mm' if 'degree' is chosen, otherwise Unit.
 
\end_layout

\begin_layout Itemize
Unit: Unit to which the measurements should be converted.
 The value can contain any length unit (mm, cm, inches, etc.) or 'degree'.
 In this case the corresponding data is firstly convertet into 'mm ' and
 afterwards the visual angles are computed.
\end_layout

\end_deeper
\begin_layout Itemize

\shape italic
Visual angle to scanpath speed:
\shape default
 Takes pairs of channels with gaze data in spherical coordinates (i.e.
 visual angle) and computes scanpath speed (i.e.
 scalar distance per second).
 Saves the result into a new channel with chaneltype 'sps' (Scanpath speed).
\end_layout

\begin_deeper
\begin_layout Itemize
Eyes: Indicates on which eyes the function should be evaluated.
\end_layout

\end_deeper
\begin_layout Subsubsection*
Channel action
\end_layout

\begin_layout Standard
Choose whether to ‘replace’ the given channel or ‘add’ the converted data
 as a new channel.
 (default: replace)
\end_layout

\begin_layout Subsection
Find startle sound onsets
\begin_inset CommandInset label
LatexCommand label
name "subsec:Find-startle-sound"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_find_sounds
\end_layout

\begin_layout Standard
Translate continuous sound data into an event marker channel.
 The function adds a new marker channel to the given data file containing
 the sound data and returns the added channel number.
 The option threshold, passed in percent to the maximum amplitude of the
 sound data, allows to specify the minimum amplitude of a sound to be accepted
 as an event.
\end_layout

\begin_layout Subsubsection*
Data file
\end_layout

\begin_layout Standard
Specify the PsPM datafile containing the imported startle sound data.
\end_layout

\begin_layout Subsubsection*
Channel
\end_layout

\begin_layout Standard
Number of channel containing the startle sounds (default: first sound channel).
\end_layout

\begin_layout Subsubsection*
Threshold
\end_layout

\begin_layout Standard
Percent of the maximum sound amplitude still being accepted as belonging
 to a sound (important for defining the sound onset).(Default: 0.1 [= 10%]).
\end_layout

\begin_layout Subsubsection*
Region of interest
\end_layout

\begin_layout Standard
Region of interest for discovering sounds.
 Only sounds between the 2 timestamps will be considered.
\end_layout

\begin_layout Itemize
Whole file
\end_layout

\begin_layout Itemize
Region
\end_layout

\begin_layout Subsubsection*
Output
\end_layout

\begin_layout Paragraph*
Create channel
\end_layout

\begin_layout Standard
The new data channel contains by default all marker onsets found in the
 specified data file.
 If you want specific sounds defined by a marker, use the diagnostics option.
\end_layout

\begin_layout Itemize
Channel action: Add will append the new marker channel as additional channel
 to the specified PsPM file.
 Replace will overwrite the last marker channel of the PsPM file (be careful
 with reference markers).
 (Default: ‘add’) 
\end_layout

\begin_layout Paragraph*
Diagnostic
\end_layout

\begin_layout Standard
Analyze delays between existing marker channel and detected sound onsets.
\end_layout

\begin_layout Itemize
Diagnostics output
\end_layout

\begin_deeper
\begin_layout Itemize
Text only: Output delay statistics as text (amount, mean, stddev).
\end_layout

\begin_layout Itemize
Histogram & plot: Display a histogram of the delays found and a plot with
 the detected sound, the marker event and the onset of the sound events.
 Color codes are green (smallest delay) and red (longest delay).
\end_layout

\end_deeper
\begin_layout Itemize
Create channel with specific sounds: Create new data channel which contains
 only marker onsets which could have been assigned to a marker in the specified
 marker channel (Default: No).
\end_layout

\begin_deeper
\begin_layout Itemize
Channel action: Add will append the new marker channel as additional channel
 to the specified PsPM file.
 Replace will overwrite the last marker channel of the PsPM file (be careful
 with reference markers).
 (Default: ‘add’) 
\end_layout

\end_deeper
\begin_layout Itemize
Marker channel
\end_layout

\begin_layout Itemize
Max delay: Upper limit in seconds of the window in which sounds are accepted
 to belong to a marker.
 Default: 3 s
\end_layout

\begin_layout Itemize
Min delay: Lower limit in seconds of the window in which sounds are accepted
 to belong to a marker.
 Default: 0 s
\end_layout

\begin_layout Itemize
Expected sound count: Checks for correct number of detected sounds.
 If too few sounds are found, threshold is lowered until specified count
 is reached.
\end_layout

\begin_layout Subsection
Preprocess startle eyeblink EMG
\begin_inset CommandInset label
LatexCommand label
name "subsec:Preprocess-startle-eyeblink"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_emg_pp
\end_layout

\begin_layout Standard
Preprocess startle eyeblink EMG data for further analysis.
 Noise in EMG data will be removed in three steps: Initially the data is
 filtered with a 4th order Butterworth filter with cutoff frequencies 50
 Hz and 470 Hz.
 Then, Mains frequency will be removed using a notch filter at 50 Hz (can
 be changed).
 Finally, the data is smoothed and rectified using a 4th order Butterworth
 low-pass filter with a time constant of 3 ms (= cutoff at 53.05 Hz).
 The applied filter settings are according to the literature
\begin_inset CommandInset citation
LatexCommand cite
key "Khemka:2016a"
literal "true"

\end_inset

.
 While the input data must be an 'emg' channel, the output will be an 'emg_pp'
 channel which is the requirement for startle eyeblink GLM.
\end_layout

\begin_layout Subsubsection*
Data file
\end_layout

\begin_layout Standard
Specify the PsPM datafile containing the EMG data channel.
 
\end_layout

\begin_layout Subsubsection*
Options
\end_layout

\begin_layout Paragraph*
Channel
\end_layout

\begin_layout Standard
Channel ID of the channel containing the unprocessed EMG data.
\end_layout

\begin_layout Paragraph*
Mains frequency
\end_layout

\begin_layout Standard
The frequency of the alternating current (AC) which will be filtered out
 using bandstop filter.
\end_layout

\begin_layout Paragraph*
Channel action
\end_layout

\begin_layout Standard
Defines whether the processed data should be added as a new channel or replace
 the last existing channel of the same data type.
 After preprocessing the data will be stored as 'emg_pp' channel.
 (default: add)
\end_layout

\begin_layout Section
First level
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sec:General-GLM"

\end_inset

GLM (modality-independent options)
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
General linear convolution models (GLM) are powerful for analysing evoked
 responses in various modalities that follow an event with (approximately)
 fixed latency.
 This is similar to standard analysis of fMRI data.
 The user specifies events for different conditions.
 These are used to estimate the mean response amplitude per condition.
 These mean amplitudes can later be compared, using the contrast manager.
\end_layout

\begin_layout Subsubsection*
Model Filename & output directory
\end_layout

\begin_layout Standard
Specify file name and directory where the *.mat file with the resulting model
 will be written.
\end_layout

\begin_layout Subsubsection*
Modality specific Channel
\end_layout

\begin_layout Standard
Indicate the channel containing the modality specific data.
 By default the 
\series bold
last
\series default
 modality specific channel is assumed to contain the data for this model.
 If the last modality specific channel does not contain the data for this
 model (e.
 g.
 there are two modality specific channels), indicate the channel number
 (within the modality specific file) that contains the data for this model.
\end_layout

\begin_layout Standard
Note: If modality is pupil, the function loads the channels according to
 a precedence order and then uses the last channel among all these loaded
 ones.
 The precedence order is given below:
\end_layout

\begin_layout Enumerate
Combined pupil channels (by definition also preprocessed): These channels
 are constructed by averaging the data from both left and right eye after
 performing pupil preprocessing on both of these channels.
\end_layout

\begin_layout Enumerate
Preprocessed pupil channels corresponding to best eye: Best eye is defined
 as the channel having less amount of missing data.
 If there is only one eye in PsPM file, then that eye is defined as the
 best eye.
\end_layout

\begin_layout Enumerate
Preprocessed pupil channels: In case there are two eyes and the best eye
 channel is not preprocessed, then PsPM prefers the preprocessed channel.
\end_layout

\begin_layout Enumerate
Best eye pupil channels: When there is no preprocessed channels, PsPM prefers
 the best eye channel.
\end_layout

\begin_layout Subsubsection*
Time Units
\end_layout

\begin_layout Standard
Indicate the time units on which the specification of the conditions will
 be based.
 Time units can be specified in ‘seconds’, number of ‘markers’, or number
 of data ‘samples’ .
 Time units refer to the beginning of the data file and not to the beginning
 of the original recordings e.
 g.
 if data were trimmed.
\end_layout

\begin_layout Paragraph*
Option for marker channels: 
\end_layout

\begin_layout Itemize
Marker Channel: Indicate the marker channel.
 By default the first marker channel is assumed to contain the relevant
 markers.
 Markers are only used if you have specified the time units as ‘markers’.
 
\end_layout

\begin_layout Subsubsection*
Data & Design
\end_layout

\begin_layout Standard
Add the required number of data files or sessions here.
 These will be concatenated for analysis.
\end_layout

\begin_layout Paragraph*
Data File
\end_layout

\begin_layout Standard
Add the data file containing the modality specific data (and potential marker
 information).
 If you have trimmed your data, add the file containing the trimmed data.
\end_layout

\begin_layout Paragraph*
Missing Epochs
\end_layout

\begin_layout Standard
Indicate epochs in your data in which the modality specific signal is missing
 or corrupted (e.g., due to artifacts).
 NaN values in the signal will be interpolated for filtering and downsampling
 and later automatically removed from data and design matrix.
 
\end_layout

\begin_layout Itemize
No Missing Epochs: The whole time series will be analyzed (default).
\end_layout

\begin_layout Itemize
Define Missing Epochs: Define the start and end points of the missing epochs
 either as epoch files or manually.
 Missing epochs will be excluded from the design matrix.
 Start and end points have to be defined in seconds starting from the beginning
 of the session.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- Missing Epoch File: Indicate an epoch file specifying the start and end
 points of missing epochs.
 The mat file has to contain a variable ‘epochs’, which is an m x 2 array,
 where m is the number of missing epochs.
 The first column marks the start points of the epochs that are excluded
 from the analysis and the second column the end points.
\end_layout

\begin_layout Standard
- Enter Missing Epochs Manually (m: nr.
 of epochs): Enter the start and end points of missing epochs manually.
 Specify an m x 2 array, where m is the number of missing epochs.
 The first column marks the start points of the epochs that are excluded
 from the analysis and the second column the end points.
 
\end_layout

\end_deeper
\begin_layout Paragraph*
Design
\end_layout

\begin_layout Standard
Specify the timing of the events within the design matrix.
 Timing can be specified in ‘seconds’, ‘markers’ or ‘samples’ with respect
 to the beginning of the data file.
 See ‘Time Units’ settings.
 Conditions can be specified manually or by using multiple condition files
 (i.e., an SPM-style mat file).
 There are several possibilities to specify the design.
 All of them require you to state, for each condition:
\end_layout

\begin_layout Itemize
Name of the experimental condition
\end_layout

\begin_layout Itemize
Onsets: vector of event onsets for this condition, expressed in seconds,
 marker numbers, or samples, as specified in time units.
 If seconds, do use precise values according to the data type (e.
 g.
 at least 0.1 s time resolution for SCR)
\end_layout

\begin_layout Itemize
Durations (optional, default 0): vector of durations of each event for this
 condition.
 You need to use 'seconds' or 'samples' as time units
\end_layout

\begin_layout Itemize
Parametric modulators: this is used to specify regressors that specify how
 responses in an experimental condition depend on a parameter to model the
 effect e.g.
 of habituation, reaction times, or stimulus ratings.
 For each parametric modulator a new regressor is included in the design
 matrix.
 To create this column, the normalized parameters are multiplied with the
 respective onset regressors.
 Parametric modulators require:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Names for each parametric modulator for this condition
\end_layout

\begin_layout Itemize
Actual values: a vector for each parameter for this condition, containing
 as many numbers as there are onsets
\end_layout

\begin_layout Itemize
Polynomial degree.
 A value of 1 leaves the parametric modulator unchanged and thus corresponds
 to a linear change over the values of the parametric modulator (first-order).
 Higher order modulation introduces further columns that contain the non-linear
 parametric modulators [e.g., second-order: (squared), third-order (cubed),
 etc].
\end_layout

\end_deeper
\begin_layout Itemize
Condition File: Create a file with the following variables:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
names: a cell array of string for the names of all experimental conditions
\end_layout

\begin_layout Itemize
onsets: a cell array of number vectors for the event onsets with the same
 number of elements as names
\end_layout

\begin_layout Itemize
durations (optional, default 0): a cell array of vectors for the duration
 of each event
\end_layout

\begin_layout Itemize
pmod (optional): a struct array with the same number of elements as names,
 and containing the fields
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
name: cell array of names for each parametric modulator for this condition
\end_layout

\begin_layout Itemize
param: cell array of vectors for each parameter for this condition, containing
 as many numbers as there are onsets
\end_layout

\begin_layout Itemize
poly (optional, default 1): specifies the polynomial degree
\end_layout

\end_deeper
\begin_layout Itemize
e.g.
 produce a simple multiple condition file by typing: 
\family typewriter
names = {'condition a', 'condition b'}; onsets = {[1 2 3], [4 5 6]}; save('testf
ile', 'names', 'onsets');
\end_layout

\end_deeper
\begin_layout Itemize
Enter conditions manually: 
\end_layout

\begin_deeper
\begin_layout Itemize
Name: Specify the name of the condition.
\end_layout

\begin_layout Itemize
Onsets: Specify a vector of onsets.
 
\end_layout

\begin_layout Itemize
Durations: Typically, a duration of 0 is used to model an event onset.
 If all events included in this condition have the same length specify just
 a single number.
 If events have different durations, specify a vector with the same length
 as the vector for onsets.
\end_layout

\begin_layout Itemize
Parametric Modulator(s) [optional] (n: nr.
 of pmods): If you want to include a parametric modulator, specify a vector
 with the same length as the vector for onsets.
 
\end_layout

\begin_deeper
\begin_layout Enumerate
Name: Specify the name of the parametric modulator.
\end_layout

\begin_layout Enumerate
Polynomial Degree: Specify an exponent that is applied to the parametric
 modulator.
 
\end_layout

\begin_layout Enumerate
Parameter Values: Specify a vector with the same length as the vector for
 onsets.
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
Define conditions from distinct values or names of event markers: This option
 defines event onsets according to the values or names of events stored
 in the a marker channel.
 These values or names are imported for some data types.
\end_layout

\begin_deeper
\begin_layout Itemize
Condition-defining values/names 
\end_layout

\begin_layout Itemize
Name: the names of the conditions in the same order as the conditioning-defining
 values/names 
\end_layout

\end_deeper
\begin_layout Itemize
No condition - If there is no condition, it is mandatory to specify a nuisance
 file (e.
 g.
 for illuminance GLM, see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prepare-illuminance-GLM"

\end_inset

).
\end_layout

\begin_layout Paragraph*
Nuisance File (optional)
\end_layout

\begin_layout Standard
You can include nuisance parameters such as motion parameters in the design
 matrix.
 Nuisance parameters are not convolved with the canonical response function.
 This is also used for the illuminance GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prepare-illuminance-GLM"

\end_inset

).
 The file has to be either a .txt file containing the regressors in columns,
 or a .mat file containing the regressors in a matrix variable called R.
 There must be as many values for each column of R as there are data values
 in your data file.
 PsPM will call the regressors pertaining to the different columns R1, R2,
 ...
 
\end_layout

\begin_layout Subsubsection*
Normalize
\end_layout

\begin_layout Standard
Specify if you want to z-normalize the modality specific data for each subject.
 For within-subjects designs, this is highly recommended, but for between-subjec
ts designs it needs to be set to false.
 
\end_layout

\begin_layout Subsubsection*
Centering
\end_layout

\begin_layout Standard
Specify if you want to mean centering the convoluted X data.
 By default this centering is applied to every model but for some specific
 cases such as some scanpath length analysis it has to be set to 0 (i.e.
 False).
\end_layout

\begin_layout Subsubsection*
Filter Settings
\end_layout

\begin_layout Standard
Specify how you want filter the modality specific data.
\end_layout

\begin_layout Paragraph*
Default
\end_layout

\begin_layout Standard
Standard settings for the Butterworth bandpass filter.
 These are the optimal settings for the modaliy specific data.
\end_layout

\begin_layout Paragraph*
Edit Settings
\end_layout

\begin_layout Standard
Create your own filter settings (not encouraged).
\end_layout

\begin_layout Itemize
Low-Pass Filter
\end_layout

\begin_deeper
\begin_layout Itemize
Enable
\end_layout

\begin_deeper
\begin_layout Enumerate
Cutoff Frequency: Specify the low-pass filter cutoff in Hz.
\end_layout

\begin_layout Enumerate
Filter Order: Specify the low-pass filter order.
\end_layout

\end_deeper
\begin_layout Itemize
Disable
\end_layout

\end_deeper
\begin_layout Itemize
High-Pass Filter
\end_layout

\begin_deeper
\begin_layout Itemize
Enable
\end_layout

\begin_deeper
\begin_layout Enumerate
Cutoff Frequency: Specify the high-pass filter cutoff in Hz.
\end_layout

\begin_layout Enumerate
Filter Order: Specify the high-pass filter order.
\end_layout

\end_deeper
\begin_layout Itemize
Disable
\end_layout

\end_deeper
\begin_layout Itemize
New Sampling Rate: Specify the sampling rate in Hz to down sample modality
 specific data.
 Enter NaN to leave the sampling rate unchanged.
\end_layout

\begin_layout Itemize
Filter Direction {uni, bi}, (default: uni): A unidirectional filter is applied
 twice in the forward direction.
 A ‘bidirectional’ filter is applied once in the forward direction and once
 in the backward direction to correct the temporal shift due to filtering
 in forward direction.
\end_layout

\begin_layout Subsubsection*
Create information on missing data values
\end_layout

\begin_layout Standard
Option to extract information over missing values in each condition of the
 GLM.
 This option extracts the ratio of NaN-values over all trials for each condition
, and whether this ratio exceeds a cutoff value.
 The information is stored in the GLM structure and will be used in future
 releases for excluding values during extraction and first-level contrasts.
 
\end_layout

\begin_layout Itemize

\shape italic
No
\end_layout

\begin_layout Itemize

\shape italic
Yes
\shape default
: Need to define the segment length and a cutoff value 
\end_layout

\begin_deeper
\begin_layout Itemize
Segment length: Length of segments.
  
\end_layout

\begin_layout Itemize
Cutoff: Value which represents upperbound for the ratio of NaN-values in
 the trials.
 
\end_layout

\end_deeper
\begin_layout Subsubsection*
Overwrite Existing File
\end_layout

\begin_layout Standard
Specify whether you want to overwrite existing mat files.
\end_layout

\begin_layout Subsection
GLM for SCR
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM [
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2009aa,Bach:2010ad,Bach:2013aa,Bach:2014aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
 Standard is to use a canonical skin conductance response function (SCRF)
 with time derivative for later reconstruction of the response peak.
 
\end_layout

\begin_layout Paragraph*
SCRF0
\end_layout

\begin_layout Standard
SCRF without derivatives.
\end_layout

\begin_layout Paragraph*
SCRF1
\end_layout

\begin_layout Standard
SCRF with time derivative (default).
 This is the recommended option based on the publication 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2014aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph*
SCRF2
\end_layout

\begin_layout Standard
SCRF with time and dispersion derivative.
\end_layout

\begin_layout Paragraph*
FIR
\end_layout

\begin_layout Standard
Uninformed finite impulse response (FIR) model: specify the number and duration
 of time bins to be estimated.
\end_layout

\begin_layout Itemize
Arguments
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- N: Number of Time Bins: Number of time bins.
\end_layout

\begin_layout Standard
- D: Duration of Time Bins: Duration of time bins (in seconds).
\end_layout

\end_deeper
\begin_layout Subsection
GLM for evoked HPR
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM[
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

].
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
\end_layout

\begin_layout Paragraph*
HPRF_E
\end_layout

\begin_layout Itemize
Arguments
\end_layout

\begin_deeper
\begin_layout Itemize
Number of basis functions
\end_layout

\end_deeper
\begin_layout Paragraph*
FIR
\end_layout

\begin_layout Standard
Uninformed finite impulse response (FIR) model: specify the number and duration
 of time bins to be estimated.
\end_layout

\begin_layout Itemize
Arguments
\end_layout

\begin_deeper
\begin_layout Itemize
N: Number of Time Bins: Number of time bins.
\end_layout

\begin_layout Itemize
D: Duration of Time Bins: Duration of time bins (in seconds).
\end_layout

\end_deeper
\begin_layout Subsection
GLM for fear-conditioned HPR
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM[
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
\end_layout

\begin_layout Paragraph*
Function
\end_layout

\begin_layout Subparagraph*
HPRF_FC0
\end_layout

\begin_layout Standard
HPRF_FC without derivatives.
\end_layout

\begin_layout Subparagraph*
HPRF_FC1
\end_layout

\begin_layout Standard
HPRF_FC with time derivative.
\end_layout

\begin_layout Paragraph*
SOA
\end_layout

\begin_layout Standard
Specify custom SOA for response function.
 Tested values are 3.5 s, 4 s and 6 s.
 Default: 3.5 s
\end_layout

\begin_layout Subsection
GLM for fear-conditioned PSR
\begin_inset CommandInset label
LatexCommand label
name "subsec:GLM-for-fear-conditioned"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM[
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
\end_layout

\begin_layout Paragraph*
PSRF_FC0
\end_layout

\begin_layout Standard
PSRF_FC with CS only and without derivatives.
\end_layout

\begin_layout Paragraph*
PSRF_FC1
\end_layout

\begin_layout Standard
PSRF_FC with CS and derivatives for CS (default).
\end_layout

\begin_layout Paragraph*
PSRF_FC2
\end_layout

\begin_layout Standard
PSRF_FC with CS and US.
 Without derivatives.
\end_layout

\begin_layout Paragraph*
PSRF_FC3
\end_layout

\begin_layout Standard
PSRF_FC with US only and without derivatives.
\end_layout

\begin_layout Subsubsection*
Default Channel
\end_layout

\begin_layout Paragraph*
Best eye
\end_layout

\begin_layout Standard
Use eye with the fewest NaN values.
\end_layout

\begin_layout Paragraph*
First left eye
\end_layout

\begin_layout Standard
Look for first left eye channel.
\end_layout

\begin_layout Paragraph*
First right eye
\end_layout

\begin_layout Standard
Look for first right eye channel.
\end_layout

\begin_layout Subsection
GLM for evoked RAR
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM[
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
\end_layout

\begin_layout Paragraph*
RARF_E0
\end_layout

\begin_layout Standard
RARF_E without time derivative.
\end_layout

\begin_layout Paragraph*
RARF_E1
\end_layout

\begin_layout Standard
RARF_E with time derivative (default).
\end_layout

\begin_layout Subsection
GLM for fear-conditioned RAR
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM[
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 References: .
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
\end_layout

\begin_layout Paragraph*
RARF_FC0
\end_layout

\begin_layout Standard
RARF_FC early and late response.
\end_layout

\begin_layout Paragraph*
RARF_FC1
\end_layout

\begin_layout Standard
RARF_FC early response with derivative.
\end_layout

\begin_layout Subsection
GLM for evoked RPR
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM[
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
\end_layout

\begin_layout Paragraph*
RPRF_E0
\end_layout

\begin_layout Standard
RPRF_E without time derivative.
\end_layout

\begin_layout Paragraph*
RPRF_E1
\end_layout

\begin_layout Standard
RPRF_E with derivative.
\end_layout

\begin_layout Subsection
GLM for evoked RFRR
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM[
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
\end_layout

\begin_layout Paragraph*
RFRRF_E0
\end_layout

\begin_layout Standard
RFRRF_E without time derivative.
\end_layout

\begin_layout Paragraph*
RFRRF_E1
\end_layout

\begin_layout Standard
RFRRF_E with derivative.
\end_layout

\begin_layout Subsection
GLM for SEBR
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM [
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Khemka:2016a"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection*
Latency
\end_layout

\begin_layout Standard
Latency is either ‘fixed’ or ‘free’.
 If latency is ‘free’, the model estimates the best latency within the given
 time window for each regressor (using a dictionary matching algorithm)
 and then inverts the GLM with these latencies.
 See 
\begin_inset CommandInset citation
LatexCommand cite
key "Khemka:2016a"
literal "true"

\end_inset

 in the context of SEBR.
\end_layout

\begin_layout Paragraph*
Fixed latency
\end_layout

\begin_layout Paragraph*
Free latency
\end_layout

\begin_layout Itemize
Time window - In seconds, specifies over which time window latencies should
 be evaluated.
 Positive values mean that the response function is shifted to later time
 points, negative values that it is shifted to earlier time points.
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
\end_layout

\begin_layout Paragraph*
SEBRF0
\end_layout

\begin_layout Standard
SEBRF without time derivative (default).
\end_layout

\begin_layout Paragraph*
SEBRF1
\end_layout

\begin_layout Standard
SEBRF with derivative.
\end_layout

\begin_layout Subsection
GLM for SPS
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_glm, pspm_glm_recon, pspm_get_timing
\end_layout

\begin_layout Standard
This section only covers modality specific topics for GLM.
 Settings applying to all modalities are discussed in the general section
 GLM [
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

].
 
\end_layout

\begin_layout Subsubsection*
Basis Function
\end_layout

\begin_layout Standard
Basis functions for the peripheral model.
\end_layout

\begin_layout Paragraph*
Average scanpath speed
\end_layout

\begin_layout Standard
This option implements a boxcar function over the SOA, and yields the average
 scan path speed over that interval (i.e.
 the scan path length over that interval, divided by the SOA).
 (default).
\end_layout

\begin_layout Paragraph*
SPSRF_FC
\end_layout

\begin_layout Standard
This option implements a gamma function for fear-conditioned scan path speed
 responses, time-locked to the end of the CS-US interval.
\end_layout

\begin_layout Paragraph*
SOA
\end_layout

\begin_layout Standard
Specify custom SOA for response function.
 Tested values are 3.5 s and 4 s.
 Default: 3.5 s
\end_layout

\begin_layout Subsection
Non-Linear Model for SCR
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_dcm, pspm_dcm_inv
\end_layout

\begin_layout Standard
Non-linear models for SCR are powerful if response timing is not precisely
 known and has to be estimated.
 A typical example are anticipatory SCR in fear conditioning – they must
 occur at some point within a time-window of several seconds duration, but
 that time point may vary over trials.
 Dynamic causal modelling (DCM) is the framework for parameter estimation.
 PsPM implements an iterative trial-by-trial algorithm.
 Different from GLM, response parameters are estimated per trial, not per
 condition, and the algorithm must not be informed about the condition.
 Trial-by-trial response parameters can later be summarized across trials,
 and compared between conditions, using the contrast manager.
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010aa,Staib:2015aa"
literal "true"

\end_inset


\end_layout

\begin_layout Subsubsection*
Model Filename & Output directory
\end_layout

\begin_layout Standard
Specify file name for the resulting model.
 Specify directory where the mat file with the resulting model will be written.
\end_layout

\begin_layout Subsubsection*
SCR channel
\end_layout

\begin_layout Standard
Indicate the channel containing the SCR data.
 By default the first SCR channel is assumed to contain the data for this
 model.
 If the first SCR channel does not contain the data for this model (e.
 g.
 there are two SCR channels), indicate the channel number (within the SCR
 file) that contains the data for this model.
 
\end_layout

\begin_layout Subsubsection*
Data & design
\end_layout

\begin_layout Standard
Add the appropriate number of data files or sessions here.
 Results will be concatenated.
\end_layout

\begin_layout Paragraph*
Data File
\end_layout

\begin_layout Standard
Add the data file containing the SCR data.
 If you have trimmed your data, add the file containing the trimmed data.
\end_layout

\begin_layout Paragraph*
Design
\end_layout

\begin_layout Standard
Specify the timings of individual events from your design either by creating
 a timing file or by entering the timings manually.
 The DCM framework allows you to specify two types of events:
\end_layout

\begin_layout Standard
Fixed latency (evoked): An event is assumed to elicit an immediate response.
 The amplitude of the sympathetic arousal will be estimated, while the latency
 and duration of the response are fixed.
 This event type is meant to model evoked responses.
\end_layout

\begin_layout Standard
Flexible latency and duration (event-related): An event is assumed to elicit
 sympathetic arousal within a known response window, but with unknown amplitude,
 latency and duration.
 For each event of this type, specify a time window in which the response
 is expected.
 PsPM will then estimate the amplitude, duration and latency of the response.
 An example for this type of event is an anticipatory response which might
 vary in timing between trials (e.
 g.
 in fear conditioning).
 
\end_layout

\begin_layout Itemize
Timing File: The timing file has to be a .mat file containing a cell array
 called 'events'.
 For a design with n trials and m events per trial (n × m events in total),
 the cell array has to be structured in the following way: Create m cells
 in the cell array (one per event type that occurs in each trial).
 Each cell defines either a fixed or a flexible event type.
 A cell that defines a fixed event type has to contain a vector with n entries,
 i.e.
 one time point per trial, in seconds, samples or markers.
 A cell that defines a flexible type has to contain an array with n rows
 and two columns.
 The first column specifies the onsets of the time windows for each trial,
 while the second column specifies the offsets of the time windows.
 It is assumed that all trials have the same structure, i.e.
 the same number of fixed and flexible event types.
 For individual trials with a different structure you can enter negative
 values as time information to omit estimation of a response.
 For later comparison between trials of different conditions, it is absolutely
 mandatory that they contain the same types of events, to avoid bias.
 Hence, if one condition omits an event (e.
 g.
 unreinforced trials in conditioning experiments), the omitted event needs
 to be modelled as well.
 
\end_layout

\begin_layout Itemize
Enter Timing Manually: In the DCM framework, a session is structured in
 n individual trials.
 Each trial contains m fixed and/or flexible event types.
 All trials need to have the same structure.
 Create event types to define the structure of a trial and enter the timings
 for all events.
 
\end_layout

\begin_deeper
\begin_layout Itemize
Name (optional): Enter a name of the event.
 This name can later be used for display and export.
\end_layout

\begin_layout Itemize
Onsets: For events with a fixed response, specify a vector of onsets.
 The length of the vector corresponds to the number of trials (n).
 For events with a flexible response, specify a two column array.
 The first column defines the onset of the time window in which the response
 occurs.
 The second column defines the offset.
 The number of rows of the array corresponds to the number of trials (n).
 All timings are specified in seconds.
 
\end_layout

\end_deeper
\begin_layout Paragraph*
Conditions (optional)
\end_layout

\begin_layout Standard
Specify the conditions that the individual trials belong to.
 This information is not used for the parameter estimation, but it allows
 you to later access the conditions in the contrast manager.
 
\end_layout

\begin_layout Itemize
Name: Specify the name of the condition.
\end_layout

\begin_layout Itemize
Index: Specify a vector of trial indices between 1 and n.
 The length of the vector corresponds to the number of events included in
 this condition.
\end_layout

\begin_layout Paragraph*
Missing epochs
\end_layout

\begin_layout Standard
Indicate epochs in your data in which the signal is missing or corrupted
 (e.g., due to artifacts).
 Data around missing epochs are split into subsessions and are evaluated
 independently if the missing epoch is at least as long as subsession threshold.
 NaN periods within the evaluated subsessions will be interpolated for averages
 and principal response components.
\end_layout

\begin_layout Itemize
No Missing Epochs: Missing epochs are detected automatically according to
 the data option ‘Subsession threshold’.
\end_layout

\begin_layout Itemize
Define Missing Epochs: Define the start and end points of the missing epochs
 either as epoch files or manually.
 Start and end points have to be defined in seconds starting from the beginning
 of the session.
\end_layout

\begin_deeper
\begin_layout Itemize
Missing Epoch File: Indicate an epoch file specifying the start and end
 points of missing epochs (m).
 The mat file has to contain a variable ‘epochs’, which is an m x 2 array,
 where m is the number of missing epochs.
 The first column marks the start points of the epochs that are excluded
 from the analysis and the second column the end points.
\end_layout

\begin_layout Itemize
Enter Missing Epochs Manually: Enter the start and end points of missing
 epochs (m) manually.
 Specify an m x 2 array, where m is the number of missing epochs.
 The first column marks the start points of the epochs that are excluded
 from the analysis and the second column the end points.
 
\end_layout

\end_deeper
\begin_layout Standard

\shape italic
Note: pspm_dcm calculates the inter-trial intervals as the duration between
 the end of a trial and the start of the next one.
 ITI value for the last trial in a session is calculated as the duration
 between the end of the last trial and the end of the whole session.
 Since this value may differ significantly from the regular ITI duration
 values, it is not used when computing the minimum ITI duration of a session.
\end_layout

\begin_layout Standard

\shape italic
Minimum of session specific min ITI values is used 
\end_layout

\begin_layout Enumerate

\shape italic
when computing mean SCR signal
\end_layout

\begin_layout Enumerate

\shape italic
when computing the PCA from all the trials in all the sessions.
\end_layout

\begin_layout Standard

\shape italic
In case of case (2), after each trial, all the samples in the period with
 duration equal to the just mentioned overall min ITI value is used as a
 row of the input matrix.
 Since this minimum does not use the min ITI value of the last trial in
 each session, the sample period may be longer than the ITI value of the
 last trial.
 In such a case, pspm_dcm is not able to compute the PCA and emits a warning.
\end_layout

\begin_layout Standard

\shape italic
The rationale behind this behaviour is that we observed that ITI value of
 the last trial in a session might be much smaller than the usual ITI values.
 For example, this can happen when a long missing data section starts very
 soon after the beginning of a trial.
 If this very small ITI value is used to define the sample periods after
 each trial, nearly all the trials use much less than available amount of
 samples in both case (1) and (2).
 Instead, we aim to use as much data as possible in (1), and perform (2)
 only if this edge case is not present.
 
\end_layout

\begin_layout Subsubsection*
Data Options
\end_layout

\begin_layout Paragraph*
Normalization
\end_layout

\begin_layout Standard
Specify if you want to normalize the SCR data for each subject.
 For within-subjects designs, this is highly recommended.
 During analysis, data are always z-transformed, but the parameter estimates
 are transformed back if this is set to false.
\end_layout

\begin_layout Paragraph*
Filter Settings
\end_layout

\begin_layout Standard
Specify if you want filter the SCR data.
\end_layout

\begin_layout Itemize
Default: Standard settings for the Butterworth bandpass filter.
 These are the optimal settings from 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

: bidirectional Butterworth band pass filter with cutoff frequencies of
 0.0159 Hz and 5 Hz, downsampling to 10 Hz.
\end_layout

\begin_layout Itemize
Edit Settings: Create your own filter (discouraged).
\end_layout

\begin_deeper
\begin_layout Itemize
Low-Pass Filter
\end_layout

\begin_deeper
\begin_layout Enumerate
Enable
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- Cutoff Frequency: Specify the low-pass filter cutoff in Hz.
\end_layout

\begin_layout Standard
- Filter Order: Specify the low-pass filter order.
\end_layout

\end_deeper
\begin_layout Enumerate
Disable
\end_layout

\end_deeper
\begin_layout Itemize
High-Pass Filter
\end_layout

\begin_deeper
\begin_layout Enumerate
Enable
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
- Cutoff Frequency: Specify the high-pass filter cutoff in Hz.
\end_layout

\begin_layout Standard
- Filter Order: Specify the high-pass filter order.
\end_layout

\end_deeper
\begin_layout Enumerate
Disable
\end_layout

\end_deeper
\begin_layout Itemize
New Sampling Rate: Specify the sampling rate in Hz to down sample SCR data.
 Enter NaN to leave the sampling rate unchanged.
\end_layout

\begin_layout Itemize
Filter Direction {uni, bi}, (default: bi): A unidirectional filter is applied
 twice in the forward direction.
 A ‘bidirectional’ filter is applied once in the forward direction and once
 in the backward direction to correct the temporal shift due to filtering
 in forward direction.
\end_layout

\end_deeper
\begin_layout Paragraph*
Subsession threshold
\end_layout

\begin_layout Standard
Specify the minimum duration (in seconds) of NaN periods to be considered
 as missing epochs.
 Data around missing epochs is then split into subsessions, which are evaluated
 independently.
 This setting is ignored for sessions having set missing epochs manually.
\end_layout

\begin_layout Paragraph*
Constrained model 
\end_layout

\begin_layout Standard
This option can be set to one if the flexible responses have fixed dispersion
 (0.3 s SD) but flexible latency.
 If the option is set, the value must be 0 or 1.
 The default value is 0.
 
\end_layout

\begin_layout Subsubsection*
Response Function Options
\end_layout

\begin_layout Paragraph*
Estimate the Response Function from The Data 
\end_layout

\begin_layout Standard
A response function can be estimated from the data and used instead of the
 canonical response function (default 0 for fully flexible and 1 for fix
 and flex/fix paradigms).
 This is not normally recommended unless you have long inter trial intervals
 in the range of 20-30 s 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph*
Only Estimate RF (Do Not Do Trial-Wise DCM)
\end_layout

\begin_layout Standard
This option can be used to estimate an individual response function to be
 used in analysis of another experiment.
\end_layout

\begin_layout Paragraph*
Call External File to Provide Response Function 
\end_layout

\begin_layout Standard
Call an external file to provide a response function, which was previously
 estimated using the option "only estimate RF".
\end_layout

\begin_layout Subsubsection*
Inversion Options
\end_layout

\begin_layout Paragraph*
Number of Trials to Invert at The Same Time (default: 2 s)
\end_layout

\begin_layout Standard
The iterative DCM algorithm accounts for response overlap by considering
 several trials at a time.
 This can be set here.
\end_layout

\begin_layout Paragraph*
SF-Free Window Before First Event [s] (default: 2 s)
\end_layout

\begin_layout Standard
The DCM algorithm automatically models spontaneous fluctuations in inter
 trial intervals.
 Here, you can define a time window before the first event in every trial
 in which no spontaneous fluctuation will be estimated.
\end_layout

\begin_layout Paragraph*
SF-Free Window After Last Event [s] (default: 5 s)
\end_layout

\begin_layout Standard
The DCM algorithm automatically models spontaneous fluctuations in inter
 trial intervals.
 Here, you can define a time window after the last event in every trial
 in which no spontaneous fluctuation will be estimated.
\end_layout

\begin_layout Paragraph*
Maximum Frequency of SF in ITIs [Hz] (default: 0.5 Hz)
\end_layout

\begin_layout Standard
The DCM algorithm automatically models spontaneous fluctuations in inter
 trial intervals.
 Here you can define the minimal delay between two subsequent spontaneous
 fluctuations.
\end_layout

\begin_layout Paragraph*
SCL-Change-Free Window Before First Event [s] (default: 2 s)
\end_layout

\begin_layout Standard
The DCM algorithm automatically models baseline drifts in inter trial intervals.
 Here, you can define a window before the first event in every trial in
 which no change of the skin conductance level will be assumed.
\end_layout

\begin_layout Paragraph*
SCL-Change-Free Window After Last Event [s] (default: 5 s)
\end_layout

\begin_layout Standard
The DCM algorithm automatically models baseline drifts in inter trial intervals.
 Here, you can define a window after the last event in every trial in which
 no change of the skin conductance level will be assumed.
\end_layout

\begin_layout Subsubsection*
Display Options
\end_layout

\begin_layout Paragraph
Display Progress Window
\end_layout

\begin_layout Standard
Show a on-line diagnostic plot for each iteration of the estimation process.
\end_layout

\begin_layout Paragraph*
Display Intermediate Windows
\end_layout

\begin_layout Standard
Show small plots displaying the progress of each iteration in the estimation
 process.
\end_layout

\begin_layout Subsection
SF models
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_sf
\end_layout

\begin_layout Standard
This suite of models is designed for analysing spontaneous fluctuations
 (SF) in skin conductance as a marker for tonic arousal.
 SF are analysed over time windows that typically last 60 s and should at
 least be 15 s long.
 PsPM implements 3 different models: (1) Skin conductance level (SCL): this
 is the mean signal over the epoch (2) Area under the curve (AUC): this
 is the time-integral of the above-minimum signal, divided by epoch duration.
 This is designed to be independent from SCL and ideally represents the
 number x amplitude of SF in this time window.
 (3) Number of SF estimated by DCM (Dynamic Causal Modelling) or MP (Matching
 Pursuit): this is a non-linear estimation of the number of SF, and is the
 most sensitive indicator of tonic arousal.
 It relies on absolute data values as it implements and absolute threshold
 for data peaks.
 References: 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2011a,Bach:2015aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
The parameter estimates of these different methods have interpretable physical
 units: (1) SCL parameters have the same units as the input data, most often
 
\begin_inset Formula $\mu S$
\end_inset

, (2) AUC parameters have the same units as the input data, most often 
\begin_inset Formula $\mu S$
\end_inset

, and (3) DCM and MP parameters are the frequency of above-threshold SF,
 stated in 
\begin_inset Formula $Hz=1/s$
\end_inset

.
\end_layout

\begin_layout Subsubsection*
Data File
\end_layout

\begin_layout Standard
Add the data file containing the SCR data (and potential marker information).
 If you have trimmed your data, add the file containing the trimmed data.
\end_layout

\begin_layout Subsubsection*
Model Filename & Output directory
\end_layout

\begin_layout Standard
Specify file name for the resulting model.
 Specify directory where the mat file with the resulting model will be written.
\end_layout

\begin_layout Subsubsection*
Method 
\end_layout

\begin_layout Standard
Choose the method for estimating tonic sympathetic arousal: AUC (equivalent
 to number x amplitude of spontaneous fluctuations), SCL (tonic skin conductance
 level), DCM or MP.
 The latter two estimate the number of spontaneous fluctuations, requiring
 absolute data units as both methods implement an absolute amplitude threshold.
 In theory, DCM provides highest sensitivity but is slow 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2011a"
literal "true"

\end_inset

.
 MP is a very fast approximation to the DCM results, and comparable in sensitivi
ty for analysis of empirical data 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2015aa"
literal "true"

\end_inset

.
 In simulations, it is less accurate when the expected number of SF exceeds
 10/min.
\end_layout

\begin_layout Subsubsection*
Time Units
\end_layout

\begin_layout Standard
Indicate the time units on which the specification of the conditions will
 be based.
 Time units can be specified in ‘seconds’, number of ‘markers’, or number
 of data ‘samples’ .
 Time units refer to the beginning of the data file and not to the beginning
 of the original recordings e.
 g.
 if data were trimmed.
 Choose 'seconds', 'markers', 'samples', or 'whole' to analyse the entire
 data file as one epoch.
 
\end_layout

\begin_layout Paragraph*
Seconds/Markers/Samples
\end_layout

\begin_layout Itemize
Epochs - define data epochs to analyse
\end_layout

\begin_deeper
\begin_layout Itemize
Epoch File
\end_layout

\begin_layout Itemize
Enter Epochs Manually
\end_layout

\end_deeper
\begin_layout Paragraph*
Markers
\end_layout

\begin_layout Itemize
Marker Channel (default: 0): Indicate the marker channel.
 By default the first marker channel is assumed to contain the relevant
 markers.
 Markers are only used if you have specified the time units as ‘markers’.
 
\end_layout

\begin_layout Subsubsection*
Filter Settings
\end_layout

\begin_layout Standard
Specify if you want filter the SCR data.
\end_layout

\begin_layout Paragraph*
Default
\end_layout

\begin_layout Standard
Standard settings for the Butterworth bandpass filter: unidirectional Butterwort
h bandpass filter with cut off frequencies of 0.0159 Hz and 5 Hz, down sampling
 to 10 Hz.
\end_layout

\begin_layout Paragraph*
Edit Settings
\end_layout

\begin_layout Standard
Create your own filter (discouraged).
\end_layout

\begin_layout Itemize
Low-Pass Filter
\end_layout

\begin_deeper
\begin_layout Itemize
Enable
\end_layout

\begin_deeper
\begin_layout Enumerate
Cutoff Frequency: Specify the low-pass filter cutoff in Hz.
\end_layout

\begin_layout Enumerate
Filter Order: Specify the low-pass filter order.
\end_layout

\end_deeper
\begin_layout Itemize
Disable
\end_layout

\end_deeper
\begin_layout Itemize
High-Pass Filter
\end_layout

\begin_deeper
\begin_layout Itemize
Enable
\end_layout

\begin_deeper
\begin_layout Enumerate
Cutoff Frequency: Specify the high-pass filter cutoff in Hz.
\end_layout

\begin_layout Enumerate
Filter Order: Specify the high-pass filter order.
\end_layout

\end_deeper
\begin_layout Itemize
Disable
\end_layout

\end_deeper
\begin_layout Itemize
New Sampling Rate: Specify the sampling rate in Hz to down sample SCR data.
 Enter NaN to leave the sampling rate unchanged.
\end_layout

\begin_layout Itemize
Filter Direction): A unidirectional filter is applied twice in the forward
 direction.
 A ‘bidirectional’ filter is applied once in the forward direction and once
 in the backward direction to correct the temporal shift due to filtering
 in forward direction.
\end_layout

\begin_layout Subsubsection*
Channel
\end_layout

\begin_layout Standard
Indicate the channel containing the SCR data.
 By default the first SCR channel is assumed to contain the data for this
 model.
 If the first SCR channel does not contain the data for this model (e.
 g.
 there are two SCR channels), indicate the channel number (within the SCR
 file) that contains the data for this model.
 
\end_layout

\begin_layout Subsubsection*
Overwrite Existing File
\end_layout

\begin_layout Standard
Specify whether you want to overwrite existing mat file.
\end_layout

\begin_layout Subsubsection*
Threshold (used for DCM and MP only)
\end_layout

\begin_layout Standard
Threshold for SN detection - default 0.1 µS.
\end_layout

\begin_layout Subsubsection*
Display Progress Window (used for DCM and MP only)
\end_layout

\begin_layout Standard
Show a on-line diagnostic plot for each iteration of the estimation process
 (DCM) or for the result of the estimation process (MP).
\end_layout

\begin_layout Subsubsection*
Display Intermediate Windows (used for DCM only)
\end_layout

\begin_layout Standard
Show small plots displaying the progress of each iteration in the estimation
 process.
\end_layout

\begin_layout Subsection
Review First-Level Model (via Batch editor)
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_review
\end_layout

\begin_layout Standard
This module allows you to look at the first-level (within-subject) model
 to investigate model fit and potential estimation problems.
 This is not necessary for standard analyses.
 Further processing can be performed directly on the second level after
 first-level model estimation.
\end_layout

\begin_layout Subsubsection*
Model File
\end_layout

\begin_layout Standard
Choose model file to review.
\end_layout

\begin_layout Subsubsection*
Model Type
\begin_inset CommandInset label
LatexCommand label
name "subsec:Model-Type"

\end_inset


\end_layout

\begin_layout Standard
Specify the type of model.
\end_layout

\begin_layout Paragraph*
GLM
\end_layout

\begin_layout Standard
Specify the plot that you wish to display:
\end_layout

\begin_layout Itemize
Design matrix 
\end_layout

\begin_layout Itemize
Orthogonality 
\end_layout

\begin_layout Itemize
Predicted & Observed 
\end_layout

\begin_layout Itemize
Regressor names 
\end_layout

\begin_layout Itemize
Reconstructed
\end_layout

\begin_layout Paragraph*
Non-linear model
\end_layout

\begin_layout Itemize
Inversion results for one trial: Non-linear SCR model (DCM) - Review individual
 trials or sequences of trials inverted at the same time.
\end_layout

\begin_deeper
\begin_layout Itemize
Session Number (Default 1): Data session.
 Must be 1 if there is only one session in the file.
\end_layout

\begin_layout Itemize
Trial Number: Trial to review.
\end_layout

\end_deeper
\begin_layout Itemize
Predicted & Observed for all trials: Non-linear SCR model for event-related
 responses - Review summary plot of all trials.
 
\end_layout

\begin_deeper
\begin_layout Itemize
Session Number
\end_layout

\begin_layout Itemize
Figure Name [optional]: Adding a figure name saves the figure as .fig file.
\end_layout

\end_deeper
\begin_layout Itemize
SCRF: Non-linear model for event-related responses - review SCRF (useful
 if SCRF was estimated from the data).
\end_layout

\begin_layout Paragraph*
SF
\end_layout

\begin_layout Standard
Non-linear model for spontaneous fluctuations: Show inversion results for
 one episode
\end_layout

\begin_layout Itemize
Epoch Number: Epoch to review.
\end_layout

\begin_layout Paragraph*
Contrasts
\end_layout

\begin_layout Standard
Display contrast names for any first level model.
\end_layout

\begin_layout Subsection
First-Level Model Review Manager (via GUI)
\begin_inset CommandInset label
LatexCommand label
name "sec:First-Level-Model-RevGUI"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_review
\end_layout

\begin_layout Standard
Display information stored in a model file through an easily accessible
 interface.
 Add a model file to the menu via 
\emph on
Add Models
\emph default
.
 Available content of a highlighted model is listed on the right hand side
 under 
\emph on
Figure Selection
\emph default
.
 For non-linear models, you can select the session number by entering its
 index in the field 
\emph on
Session number
\emph default
; GLMs are inverted and displayed across all sessions.
 Click on any 
\emph on
Display
\emph default
 or 
\emph on
Show
\emph default
 button to visualize information.
 Details for each model type are listed in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Model-Type"

\end_inset

.
\end_layout

\begin_layout Subsection
First-Level Contrasts (via Batch editor)
\begin_inset CommandInset label
LatexCommand label
name "sec:First-Level-Contrasts-(via"

\end_inset


\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_con1
\end_layout

\begin_layout Standard
Define within-subject contrasts here for testing on the second level.
 Contrasts can be between conditions (GLM), epochs (SF) or trials (Non-linear
 SCR models).
 Contrast weights should add up to 0 (for testing differences between conditions
/epochs/trials) or to 1 (for testing global/intercept effects across conditions/
epochs/trials).
 Example: an experiment realises a 2 (Factor 1: a, A) x 2 (Factor 2: b,
 B) factorial design and consists of 4 conditions: aa, aB, Ab, AB.
 Testing the following contrasts is equivalent to a full ANOVA model: Main
 effect factor 1: [1 1 -1 -1], Main effect factor 2: [1 -1 1 -1], Interaction
 factor 1 x factor 2: [1 -1 -1 1].
 To test condition effects in non-linear models, assign the same contrast
 weight to all trials from the same condition.
 
\end_layout

\begin_layout Subsubsection*
Model File(s)
\end_layout

\begin_layout Standard
Specify the model file for which to compute contrasts.
\end_layout

\begin_layout Subsubsection*
Specify Contrasts on Datatype
\end_layout

\begin_layout Standard
Contrasts are usually specified on parameter estimates.
 For GLM, you can also choose to specify them on conditions or reconstructed
 responses per condition.
 In this case, your contrast vector needs to take into account only the
 first basis function.
 For non-linear SCR models, you can specify contrasts based on conditions
 as well.
 This will average within conditions.
 Use the review manager to extract condition names and their order.
 This argument will be ignored for other first-level models.
 
\end_layout

\begin_layout Standard
- Parameter: Use all parameter estimates.
\end_layout

\begin_layout Standard
- Condition: Contrasts formulated in terms of conditions in a GLM, automatically
 detects number of basis functions and uses only the first one (i.e.
 without derivatives), or based on assignment of trials to conditions in
 DCM.
\end_layout

\begin_layout Standard
- Reconstructed: Contrasts formulated in terms of conditions in a GLM, reconstru
cts estimated response from all basis functions and uses the peak of the
 estimated response.
 
\end_layout

\begin_layout Subsubsection*
Contrast(s)
\end_layout

\begin_layout Paragraph*
Contrast Name
\end_layout

\begin_layout Standard
This name identifies the contrast in tables and displays.
\end_layout

\begin_layout Paragraph*
Contrast Vector
\end_layout

\begin_layout Standard
This is a vector on all included conditions (GLM), trials (non-linear SCR
 model for event-related responses), or epochs (non-linear model for SF).
 Shorter vectors will be appended with zeros.
 To specify a condition or trial difference, the contrast weights must add
 up to zero (e.
 g.
 was sympathetic arousal in condition A larger than in condition B: c =
 [1 -1]).
 To specify a summary of conditions or trials, the contrast weights should
 add up to 1 to retain proper scaling (e.
 g.
 was non-zero sympathetic arousal elicited in combined conditions A and
 B: c = [0.5 0.5]) .
\end_layout

\begin_layout Subsubsection*
Delete Existing Contrasts 
\end_layout

\begin_layout Standard
Deletes existing contrasts from the model file.
\end_layout

\begin_layout Subsubsection*
Z-Scoring
\end_layout

\begin_layout Standard
Use parameter estimates across all conditions for each parameter/event type,
 subtract the mean and divide by the standard deviation, before computing
 the contrast.
 This option is only available for models with trial-wise parameter estimates.
 (default: false)
\end_layout

\begin_layout Subsection
First level contrast manager (via GUI)
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_con1
\end_layout

\begin_layout Standard
The Manager guides you through the setup of pre-defined within-subject contrasts
 applied to the parameter estimates of your model.
\end_layout

\begin_layout Paragraph*
Load Model
\end_layout

\begin_layout Standard
Import a model file from a subject containing parameter estimates for which
 to compute contrasts.
\end_layout

\begin_layout Paragraph*
Define Contrast Name
\end_layout

\begin_layout Standard
Enter a name to identify a contrast.
 By pressing 
\emph on
New Contrast
\emph default
, the contrast is added to the box 
\emph on
Contrasts
\emph default
.
 You can reset existing contrasts by highlighting a contrast and pressing
 
\emph on
Clear Contrast
\emph default
 or you can remove contrasts from your model file by pressing 
\emph on
Delete Contrast.
\end_layout

\begin_layout Paragraph*
Define Stats Type
\end_layout

\begin_layout Standard
Depending on the model (GLM, spontaneous fluctuation or non-linear model),
 different data types are available (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:First-Level-Contrasts-(via"

\end_inset

 for details).
 Choose the type you want to be entered into a statistical test.
\end_layout

\begin_layout Paragraph*
\noindent
Define Test
\end_layout

\begin_layout Standard
\noindent
Three pre-defined types of statistics can be computed on your estimates.
 Parameter estimates for individual conditions or trials are grouped by
 the user to compute test contrasts.
 
\begin_inset Quotes eld
\end_inset

Group
\begin_inset Quotes erd
\end_inset

 refers to groups of conditions/trials, not to groups of individuals or
 datasets.
 After choosing the test, you can add or remove conditions/trials to a group
 by clicking on them in the 
\emph on
Names
\emph default
 window.
 The color will indicate to which group they belong.
\end_layout

\begin_layout Itemize
\noindent
Test of intercept: Compute the average of conditions entered in 
\emph on
Group 1
\emph default
.
 This option is suitable if you are interested in the main effect of one
 or across several conditions.
\end_layout

\begin_layout Itemize
\noindent
Test of condition differences: Compute the difference between the averages
 of conditions/trials in 
\emph on
Group 1
\emph default
 and conditions/trials 
\emph on
Group 2
\emph default
.
\end_layout

\begin_layout Itemize
\noindent
Test of quadratic effects: Here you compute the combined effect of 
\emph on
Group 1
\emph default
 and 
\emph on
Group 3
\emph default
 against 
\emph on
Group 2
\emph default
.
 This option requires at least three conditions/trials.
\end_layout

\begin_layout Paragraph*
Run
\end_layout

\begin_layout Standard
Execute computation of statistics.
 The contrasts are stored in your model files and can be reviewed any time
 using the Review Manager (Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:First-Level-Model-RevGUI"

\end_inset

).
\end_layout

\begin_layout Subsection
Export Statistics 
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_exp
\end_layout

\begin_layout Standard
Export first level statistics to a file for further analysis in statistical
 software, or to the screen.
\end_layout

\begin_layout Subsubsection*
Model File(s)
\end_layout

\begin_layout Standard
Specify file from which to export statistics.
\end_layout

\begin_layout Subsubsection*
Stats type
\end_layout

\begin_layout Standard
Normally, all parameter estimates are exported.
 For GLM, you can choose to only export the first basis function per condition,
 or the reconstructed response per condition.
 For DCM, you can specify contrasts based on conditions as well.
 This will average within conditions.
 This argument cannot be used for other models.
\end_layout

\begin_layout Itemize
Parameter: Export all parameter estimates.
\end_layout

\begin_layout Itemize
Condition: Export all conditions in a GLM, automatically detects number
 of basis functions and export only the first one (i.e.
 without derivatives), or export condition averages in DCM.
 
\end_layout

\begin_layout Itemize
Reconstructed: Export all conditions in a GLM, reconstructs estimated response
 from all basis functions and export the peak of the estimated response.
 
\end_layout

\begin_layout Subsubsection*
Exclude conditions with too many NaN
\end_layout

\begin_layout Standard
Exclude statistics from conditions with too many NaN values.
 This option can only be used for GLM file for which the corresponding option
 was used during model setup.
 Otherwise this argument is ignored.
\end_layout

\begin_layout Subsubsection*
Target
\end_layout

\begin_layout Standard
Export to screen or to file?
\end_layout

\begin_layout Subsubsection*
Delimiter for Output File
\end_layout

\begin_layout Standard
Select a delimiter for the output file.
 Default is 'tab', you can select from a choice of several options or specify
 as free text.
\end_layout

\begin_layout Section
Second level
\end_layout

\begin_layout Subsection
Define Second-Level Model
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_con2
\end_layout

\begin_layout Standard
Define one-sample and two-sample t-tests on the between-subject (second)
 level.
 A one-sample t-test is normally used to test within-subject contrasts and
 is equivalent to t-contrasts in an ANOVA model A two-sample t-test is required
 for between-subjects contrasts or interactions.
 This module sets up the model but does not report results.
\end_layout

\begin_layout Subsubsection*
Test Type
\end_layout

\begin_layout Standard
Specify the test type.
 
\end_layout

\begin_layout Paragraph*
One Sample T-Test
\end_layout

\begin_layout Itemize
Model File(s)
\end_layout

\begin_layout Paragraph*
Two Sample T-Test
\end_layout

\begin_layout Itemize
Model File(s) 1: Model files for group 1.
\end_layout

\begin_layout Itemize
Model File(s) 2: Model files for group 2.
\end_layout

\begin_layout Subsubsection*
Output directory
\end_layout

\begin_layout Standard
Specify directory where the mat file with the resulting model will be written.
\end_layout

\begin_layout Subsubsection*
Filename for Output Model
\end_layout

\begin_layout Standard
Specify name for the resulting model.
\end_layout

\begin_layout Subsubsection*
Define Contrasts
\end_layout

\begin_layout Standard
Define which contrasts to use from the model files, and the second level
 contrast names.
 Names can be read from the first model file, or just be numbered.
\end_layout

\begin_layout Paragraph*
Read from First Model File
\end_layout

\begin_layout Itemize
All Contrasts
\end_layout

\begin_layout Itemize
Contrast Vector: Index of first-level contrasts to use.
\end_layout

\begin_layout Paragraph*
Number Contrasts
\end_layout

\begin_layout Itemize
All Contrasts
\end_layout

\begin_layout Itemize
Contrast Vector: Index of first-level contrasts to use.
\end_layout

\begin_layout Subsubsection*
Overwrite Existing File
\end_layout

\begin_layout Standard
Specify whether you want to overwrite existing mat file.
\end_layout

\begin_layout Subsection
Report Second-Level Results 
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_rev2
\end_layout

\begin_layout Standard
Result reporting for second level model.
\end_layout

\begin_layout Subsubsection*
Model File
\end_layout

\begin_layout Standard
Specify 2nd level model file.
\end_layout

\begin_layout Subsubsection*
Contrast Vector (only accessible from Batch Editor)
\end_layout

\begin_layout Standard
Index of contrasts to be reported (optional).
\end_layout

\begin_layout Section
Tools
\end_layout

\begin_layout Subsection
Display Data
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_display
\end_layout

\begin_layout Standard
Display PsPM data file in a new figure.
\end_layout

\begin_layout Subsubsection*
Data File
\end_layout

\begin_layout Standard
Specify data file to display.
\end_layout

\begin_layout Subsection
Data editor
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_data_editor
\end_layout

\begin_layout Standard
The data editor allows you to visualize data time series and mark epochs,
 for example to mark artefacts that should be excluded, for example to be
 used as missing epochs in GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:General-GLM"

\end_inset

).
 
\end_layout

\begin_layout Subsubsection*
Startup
\end_layout

\begin_layout Standard
The Data edtior can be started from the PsPM window, the Matlabbatch and
 from the Matlab command line.
 The command line startup requires the PsPM folder to be added to the Matlab
 path.
 Once that is done, the data editor can be started by typing '
\family typewriter
pspm_data_editor(argument)
\family default
' in the Matlab command line.
 The command accepts two types of arguments.
 (i) a path to file, which causes the editor to open the specified file
 and to work in the '
\series bold
file mode
\series default
' or (ii) a data vector which causes the editor to plot the passed data
 vector and to work in the '
\series bold
inline mode
\series default
'.
 If no argument is specified, the editor is stared in 'file mode'.
\end_layout

\begin_layout Subsubsection*
Data modes
\end_layout

\begin_layout Standard
The data editor differs between two data modes.
 The data mode depends on the specified startup argument.
\end_layout

\begin_layout Paragraph*
File mode
\end_layout

\begin_layout Standard
Is entered when called from the PsPM window, the Matlabbatch or a file path
 or no argument is speciefied at command line startup.
 File input/output settings aswell as the Channel view are visible on the
 left.
 The latter can be used to select the plotted channel.
 Multiple selection is possible and the color of the plot corresponds to
 the color in the channel list.
 File input settings can be used to change the file to be edited, while
 the output settings specify where the edited data should be stored to.
 It is also possible to specify the output file from when calling the data
 editor using Matlabbatch or the argument options.output_file from the Matlab
 command line.
\end_layout

\begin_layout Paragraph
Inline mode
\end_layout

\begin_layout Standard
Is entered when a data vector is specified as command line startup argument.
 Channel view and file input/output settings are hidden.
 Once the user exits, the editor returns either the interpolated data or
 the selected epochs in a PsPM epoch format.
\end_layout

\begin_layout Subsubsection*
Data navigation
\end_layout

\begin_layout Standard
Data navigation can be done by zooming (
\begin_inset Graphics
	filename Figures/icons/button_zoom.PNG

\end_inset

) and panning (
\begin_inset Graphics
	filename Figures/icons/button_pan.PNG

\end_inset

).
 Zooming does only change the horizontal axis.
 After zooming axis limits remain fixed when changing the selected channel.
 This sometimes may cause data not to be plotted because the data points
 are out of the visible range.
 Zooming out will make the data appear again.
 Panning allows the rearrangement of the plot horizontally and vertically.
 After panning the axis limits remain fixed as well and data may disappear
 when changing the selected channel.
 
\end_layout

\begin_layout Subsubsection*
Epochs
\end_layout

\begin_layout Paragraph*
Add epochs
\end_layout

\begin_layout Standard
New epochs can be added by clicking the 'add epoch' button (
\begin_inset Graphics
	filename Figures/icons/button_add_epoch.PNG

\end_inset

).
 Once clicked the cursor will change to a crosshair and it is possible to
 select data in the plot, which will upon release create a new epoch in
 the selected range.
 The new epoch will appear on the right side in the epoch list and is marked
 in green on the plot.
\end_layout

\begin_layout Paragraph*
Remove epochs
\end_layout

\begin_layout Standard
Existing epochs can be removed by clicking the 'remove epoch' button (
\begin_inset Graphics
	filename Figures/icons/button_remove_epoch.PNG

\end_inset

).
 Once clicked the cursor will change to a crosshair and it is possible to
 select the range in which the epochs should be removed.
 If an epoch is selected partially, the rest of the epoch will remain.
 The epoch-list on the right side will be updated automatically.
\end_layout

\begin_layout Paragraph*
Epoch navigation
\end_layout

\begin_layout Standard
In order to navigate between epochs it is either possible to use the epoch
 list on the right side or the two epoch navigation buttons (
\begin_inset Graphics
	filename Figures/icons/button_navigate_epochs.PNG

\end_inset

).
 The selected epoch always corresponds to the selected epoch in the epoch-list
 and is marked in black in the plot.
\end_layout

\begin_layout Subsubsection*
Output format
\end_layout

\begin_layout Standard
There are two possible output formats.
 The output, depending on the data mode, will either be written to a specified
 output file (file mode) or will be returned as a data vector (first argument;
 inline mode).
\end_layout

\begin_layout Paragraph*
Epochs
\end_layout

\begin_layout Standard
If epochs is selected, the output will be a n x 2 vector, where n is the
 number of epochs.
 The first column marks the onset of the epoch, while the second column
 marks the offset of the epoch.
 The time unit is seconds.
 In file mode the data will be written into the specified mat file in the
 variable 'epochs'.
\end_layout

\begin_layout Paragraph*
Interpolated data
\end_layout

\begin_layout Standard
If interpolated data is selected, the output will be the specified data
 itself with the selected channels (in Channel view) interpolated during
 the selected epochs.
 In file mode the original channels will be replaced.
 If 'Display interpolated curve' is checked the interpolated data will be
 displayed in the plot as a dashed line.
\end_layout

\begin_layout Subsubsection*
Matlabbatch
\end_layout

\begin_layout Standard
Possible options when the Data editor is started from Matlabbatch.
\end_layout

\begin_layout Paragraph*
Data file
\end_layout

\begin_layout Standard
Specify the PsPM datafile to be edited.
\end_layout

\begin_layout Subsection
Rename File
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_ren
\end_layout

\begin_layout Standard
Rename PsPM data file.
 This renames the file and updates the file information.
\end_layout

\begin_layout Subsubsection*
File
\end_layout

\begin_layout Standard
Choose how many files to rename.
\end_layout

\begin_layout Paragraph*
File Name
\end_layout

\begin_layout Standard
Choose name of original file.
\end_layout

\begin_layout Paragraph*
New File Name
\end_layout

\begin_layout Standard
Choose new file name.
\end_layout

\begin_layout Subsection
Split Sessions
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_split_sessions
\end_layout

\begin_layout Standard
Split sessions, defined by trains of markers.
 This function is most commonly used to split fMRI sessions when a (slice
 or volume) pulse from the MRI scanner has been recorded.
 The function will identify trains of markers and detect breaks in these
 marker sequences.
 The individual sessions will be written to new files with a suffix '_sn',
 and the session number.
 You can choose a marker channel if several were recorded.
\end_layout

\begin_layout Subsubsection*
Data File
\end_layout

\begin_layout Standard
Choose the data file, in which you want to split sessions.
\end_layout

\begin_layout Subsubsection*
Marker Channel
\end_layout

\begin_layout Standard
If you have more than one marker channel, choose the marker channel used
 for splitting sessions (default: use first marker channel).
\end_layout

\begin_layout Itemize
Default
\end_layout

\begin_layout Itemize
Number
\end_layout

\begin_layout Subsubsection*
Split behaviour
\end_layout

\begin_layout Standard
Choose whether sessions should be detected automatically or if sessions
 should be split according to given marker id's.
\end_layout

\begin_layout Itemize
Automatic: Detect sessions according to longest distances between markers.
\end_layout

\begin_layout Itemize
Marker: Split sessions according to given marker id's.
\end_layout

\begin_layout Subsubsection*
Overwrite Existing File
\end_layout

\begin_layout Standard
Choose 
\begin_inset Quotes eld
\end_inset

yes
\begin_inset Quotes erd
\end_inset

 if you want to overwrite existing file(s) with the same name.
 
\end_layout

\begin_layout Subsection
Merge files
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_merge
\end_layout

\begin_layout Standard
Allows to merge two files by stacking channels.
 Multiple pairs of files are allowed and are processed in a sequential manner.
 Which means the first element of the second file set is merged into the
 first element of first file set and so on.
 Therefore first file se and second file set must have the same number of
 elements.
 Within each pair of files, they are aligned according to the first event
 of a given marker channel, or to the start of the file.
 The output file consists of an ‘m’ at the beginning and the name of the
 first file appended.
 
\end_layout

\begin_layout Subsubsection*
Datafiles
\end_layout

\begin_layout Standard
Specify the PsPM datafiles to be merged.
\end_layout

\begin_layout Paragraph*
First file(s)
\end_layout

\begin_layout Standard
Specify the first of the two files to be merged.
 This can be one file or a set of files.
 The output file will have the name of the first file prepended with an
 ‘m’.
\end_layout

\begin_layout Paragraph*
Second file(s)
\end_layout

\begin_layout Standard
Specify the second of the two files to be merged.
 This can be one file or a set of files.
 This set must have the same length as the set defined as first file(s).
\end_layout

\begin_layout Subsubsection*
Reference
\end_layout

\begin_layout Standard
Specify whether to align the files with respect to the first marker or with
 respect to the file start.
\end_layout

\begin_layout Subsubsection*
Options
\end_layout

\begin_layout Paragraph*
Marker channel
\end_layout

\begin_layout Standard
Specify for each file (first and second) a channel which should be used
 as marker reference.
 A 1x2 vector is expected.
 If equal to 0, the first marker channel is used.
 Default: [0 0]
\end_layout

\begin_layout Paragraph*
Overwrite existing file(s)
\end_layout

\begin_layout Standard
Specify whether existing files should be overwritten (Yes) or not (No).
 Default: No
\end_layout

\begin_layout Subsection
Artefact Removal
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_pp
\end_layout

\begin_layout Standard
This module offers a few basic artifact removal functions.
 Currently, median, butterworth filters as well as a simple SCR quality
 correction method 
\begin_inset CommandInset citation
LatexCommand cite
key "Kleckner:2017a"
literal "false"

\end_inset

 are implemented.
 The median filter is useful to remove short "spikes" in the data, for example
 from gradient switching in MRI.
 The Butterworth filter can be used to get rid of high frequency noise that
 is not sufficiently filtered away by the filters implemented on-the-fly
 during first level modelling.
\end_layout

\begin_layout Subsubsection*
Data File
\end_layout

\begin_layout Standard
Choose the data file.
\end_layout

\begin_layout Subsubsection*
Channel Number
\end_layout

\begin_layout Standard
Select the channel to work on.
\end_layout

\begin_layout Subsubsection*
Filter Type
\end_layout

\begin_layout Standard
Currently, median and Butterworth filters are implemented.
 A median filter is recommended for short spikes, generated for example
 in MRI scanners by gradient switching.
 A Butterworth filter is applied in most models; check there to see whether
 an additional filtering is meaningful.
\end_layout

\begin_layout Paragraph*
Median Filter
\end_layout

\begin_layout Itemize
Number of Time Points: Number of time points over which the median is taken.
\end_layout

\begin_layout Paragraph*
Butterworth Low pass Filter
\end_layout

\begin_layout Itemize
Cutoff Frequency: Cutoff frequency has to be at least 20Hz.
\end_layout

\begin_layout Paragraph*
Simple SCR quality correction
\end_layout

\begin_layout Itemize
Minimum value: Minimum SCR value in 
\begin_inset Formula $μS$
\end_inset

.
\end_layout

\begin_layout Itemize
Maximum value: Maximum SCR value in 
\begin_inset Formula $μS$
\end_inset

.
\end_layout

\begin_layout Itemize
Maximum slope: Maximum slope in 
\begin_inset Formula $\frac{μS}{s}$
\end_inset

.
\end_layout

\begin_layout Subsubsection*
Overwrite Existing File 
\end_layout

\begin_layout Standard
Choose 
\begin_inset Quotes eld
\end_inset

yes
\begin_inset Quotes erd
\end_inset

 if you want to overwrite existing file(s) with the same name.
 
\end_layout

\begin_layout Subsection
Downsample Data 
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_down
\end_layout

\begin_layout Standard
This function downsamples individual channels in a PsPM file to a required
 sampling rate, after applying an anti-aliasing Butterworth filter at the
 Nyquist frequency.
 The resulting data will be written to a new .mat file, prepended with 'd',
 and will contain all channels – also the ones that were not downsampled.
\end_layout

\begin_layout Subsubsection*
Data File
\end_layout

\begin_layout Standard
Name of the data files to be downsampled.
\end_layout

\begin_layout Subsubsection*
New Frequency
\end_layout

\begin_layout Standard
Required sampling frequency.
\end_layout

\begin_layout Subsubsection*
Channels To Downsample
\end_layout

\begin_layout Standard
Vector of channels to downsample, or all channels.
\end_layout

\begin_layout Subsubsection*
Overwrite Existing File 
\end_layout

\begin_layout Standard
Choose 
\begin_inset Quotes eld
\end_inset

yes
\begin_inset Quotes erd
\end_inset

 if you want to overwrite existing file(s) with the same name.
 
\end_layout

\begin_layout Subsection
Interpolate missing data
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_interpolate
\end_layout

\begin_layout Standard
The function interpolates missing values, either for all continuous channels
 in a specified PsPM data file (file mode), or for selected channel(s) only
 (channel mode).
 In file mode, the function writes all channels to a new file with the same
 name prepended by an ‘i’.
 In channel mode, the function interpolates data and either replaces a channel
 or writes the data to a new channel.
\end_layout

\begin_layout Subsubsection*
Data file
\end_layout

\begin_layout Standard
Select data files.
\end_layout

\begin_layout Subsubsection*
Work mode
\end_layout

\begin_layout Standard
Specify whether to work on a whole file or just on the specified channel(s).
 If whole file is specified, the data will be written to a new file with
 the same name prepended by an ‘i’.
 Otherwise the specified channel(s) will be written to a new channel or
 replace an existing channel in the same file.
\end_layout

\begin_layout Itemize
File mode
\end_layout

\begin_deeper
\begin_layout Itemize
Overwrite existing file: Choose 
\begin_inset Quotes eld
\end_inset

yes
\begin_inset Quotes erd
\end_inset

 if you want to overwrite existing file(s) with the same name (Default:
 No).
\end_layout

\end_deeper
\begin_layout Itemize
Channel mode
\end_layout

\begin_deeper
\begin_layout Itemize
Interpolate channel(s): Specify which channel(s) should be interpolated.
\end_layout

\begin_layout Itemize
Mode: Specify how to behave with the interpolated data.
\end_layout

\begin_deeper
\begin_layout Itemize
New channel: Always add as a new channel.
\end_layout

\begin_layout Itemize
Replace channel: Replace specified channel(s).
\end_layout

\end_deeper
\end_deeper
\begin_layout Subsection
Extract segments
\end_layout

\begin_layout Standard

\shape italic
Related function:
\shape default
 
\family typewriter
pspm_extract_segments
\end_layout

\begin_layout Standard
This function extracts data segments (e.g., for visual inspection of mean
 responses per condition).
\end_layout

\begin_layout Subsubsection*
Mode
\end_layout

\begin_layout Standard
Either extract all information from a GLM or DCM model structure/file or
 define the relevant information manually.
 
\end_layout

\begin_layout Itemize

\series bold
Automatically read from GLM or DCM
\series default
: Extracts all relevant information from a GLM or DCM model structure/file.
 To distinguish between conditions in a DCM, trialnames must be specified
 in the DCM definition (before running it).
\end_layout

\begin_deeper
\begin_layout Itemize

\shape italic
GLM or DCM 
\shape default
structure/file: Give a GLM or DCM structure already loaded to MATLAB or
 give the filepath to a GLM or DCM model.
\end_layout

\begin_deeper
\begin_layout Itemize
When filepath is given, GLM or DCM structure will be loaded to MATLAB automatica
lly.
 (From now on called the model)
\end_layout

\begin_layout Itemize
When the model corresponds to GLM, the data used for segment extraction
 is 
\family typewriter
model.input.data
\family default
.
 This corresponds to the unfiltered input data passed to GLM model fitting
 part.
\end_layout

\begin_layout Itemize
When the model corresponds to GLM, duration of each onset must be given
 in 
\family typewriter
model.timing.durations
\family default
 as seconds
\family typewriter
.
\end_layout

\begin_layout Itemize
When the model corresponds to DCM, the data used for segment extraction
 is 
\family typewriter
model.input.scr
\family default
.
\end_layout

\begin_layout Itemize
When the model corresponds to DCM, the trials that should belong to the
 same condition should have the same trial name.
 By default, DCM generates different trial names for each trial.
 If the input trial names are all different, then all the trials are assumed
 to be in the same case.
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize

\series bold
Manual:
\series default
 Specify all the settings manually.
\end_layout

\begin_deeper
\begin_layout Itemize

\shape italic
Data files
\shape default
: PsPM files from which data segments should be extracted.
\end_layout

\begin_layout Itemize

\shape italic
Channel
\shape default
: Channel in specified data file from which the segments should be extracted.
\end_layout

\begin_layout Itemize

\shape italic
Conditions
\shape default
:
\end_layout

\begin_deeper
\begin_layout Itemize
Condition files: Should be in the format of the conditions defined in a
 GLM model.
 Required fields are names, onsets, duration.
\end_layout

\begin_layout Itemize
Enter conditions manually: Specify the conditions that you want to include
 in your design matrix.
\end_layout

\begin_deeper
\begin_layout Itemize
Name: Specify the name of the condition.
\end_layout

\begin_layout Itemize
Onsets: Specify a vector of onsets.
 The length of the vector corresponds to the number of events included in
 this condition.
 Onsets have to be indicated in the specified time unit (‘seconds’, ‘samples’).
\end_layout

\begin_layout Itemize
Duration: Specify the length of the condition.
\end_layout

\end_deeper
\end_deeper
\end_deeper
\begin_layout Itemize

\series bold
Raw:
\series default
 Specify all the settings manually (i.e.
 choose manual mode) and provide raw data
\end_layout

\begin_deeper
\begin_layout Itemize

\shape italic
Data
\shape default
: Numeric raw data or a cell array of numeric raw data.
\end_layout

\begin_layout Itemize

\shape italic
Sampling rate
\shape default
: One sampling rate or an array of sampling rates of the corresponding 
\shape italic
Data
\shape default
.
\end_layout

\begin_layout Itemize

\shape italic
Conditions
\shape default
:
\end_layout

\begin_deeper
\begin_layout Itemize
Condition files: Should be in the format of the conditions defined in a
 GLM model.
 Required fields are names, onsets, duration.
\end_layout

\begin_layout Itemize
Enter conditions manually: Specify the conditions that you want to include
 in your design matrix.
\end_layout

\begin_deeper
\begin_layout Itemize
Name: Specify the name of the condition.
\end_layout

\begin_layout Itemize
Onsets: Specify a vector of onsets.
 The length of the vector corresponds to the number of events included in
 this condition.
 Onsets have to be indicated in the specified time unit (‘seconds’, ‘samples’).
\end_layout

\begin_layout Itemize
Duration: Specify the length of the condition.
\end_layout

\end_deeper
\end_deeper
\end_deeper
\begin_layout Subsubsection*
Options
\end_layout

\begin_layout Standard
Change values of optional settings.
\end_layout

\begin_layout Itemize

\series bold
Timeunit
\series default
: The timeunit in which conditions should be interpreted.
\end_layout

\begin_deeper
\begin_layout Itemize
Seconds
\end_layout

\begin_layout Itemize
Samples
\end_layout

\begin_layout Itemize
Markers
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Marker channel
\series default
: Channel containing the markers referenced in the conditions.
 Only needed if option 'Timeunit' is set to 'markers'.
\end_layout

\begin_layout Itemize

\series bold
Segment length
\series default
: Length of segments.
 If set durations of trials in conditions will be ignored.
\end_layout

\begin_layout Itemize

\series bold
NaN-output
\series default
: Option to visualize the ratio of NaN values for each trial for each condition.
 Possibilities of visualization:
\end_layout

\begin_deeper
\begin_layout Itemize
None 
\end_layout

\begin_layout Itemize
Screen: a table of the NaN-ratios is printed on the MATLAB command window.
 
\end_layout

\begin_layout Itemize
File output : a table of the NaN-ratios is saved in a file (Attention: already
 existing files get overwritten)
\end_layout

\begin_deeper
\begin_layout Itemize
File name: defines the name of the file 
\end_layout

\begin_layout Itemize
Path to File: defines the path where the file should be stored 
\end_layout

\end_deeper
\begin_layout Standard
The table printed in the option 'Screen' or 'File output' has the conditions
 as columns and all the trials as rows.
 For each row there exists only one non-NaN value, which represents the
 propotion of the NaN values in the correspondig trial for the corresponding
 condition.
 The last row indicates the proportion of NaN-values over all trials for
 each condition.
 
\end_layout

\end_deeper
\begin_layout Subsubsection*
Output
\end_layout

\begin_layout Standard
Output settings.
\end_layout

\begin_layout Itemize

\series bold
Output file
\series default
: Where to store the extracted segments.
\end_layout

\begin_deeper
\begin_layout Itemize
File path: Path to file.
\end_layout

\begin_layout Itemize
File name: Name of file.
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Overwrite existing file
\series default
: Overwrite existing segment files.
\end_layout

\begin_layout Itemize

\series bold
Plot
\series default
: Plot means over conditions with standard error of the mean.
\end_layout

\begin_layout Subsection
Segment mean
\end_layout

\begin_layout Standard
This function creates means over extracted data segments (as extracted in
 ‘Extract segments’).
\end_layout

\begin_layout Subsubsection*
Segment files
\end_layout

\begin_layout Standard
Specify the segment files which have been created with the ‘extract segment’
 function.
\end_layout

\begin_layout Subsubsection*
Output file
\end_layout

\begin_layout Standard
Where to store the segment mean across the specified files.
\end_layout

\begin_layout Paragraph*
File path
\end_layout

\begin_layout Standard
Path to file.
\end_layout

\begin_layout Paragraph*
File name
\end_layout

\begin_layout Standard
Name of file.
\end_layout

\begin_layout Subsubsection*
Adjust method
\end_layout

\begin_layout Standard
How to deal with different sample rates across segment files.
 ‘interpolate’ data segments to highest or ‘downsample’ data segments to
 lowest sampling rate.
\end_layout

\begin_layout Subsubsection*
Overwrite existing file
\end_layout

\begin_layout Standard
Overwrite existing segment mean files.
 
\end_layout

\begin_layout Subsubsection*
Plot
\end_layout

\begin_layout Standard
Plot means over segment files with standard error of the mean.
\end_layout

\begin_layout Subsection
Extract event marker info
\end_layout

\begin_layout Standard
Allows to extract additional marker information for further processing.
 The information can be used to distinguish between different types of events
 or for other purposes.
 This is usually used to extract marker information from EEG-style data
 files such as BrainVision or NeuroScan.
\end_layout

\begin_layout Subsubsection*
Data file
\end_layout

\begin_layout Standard
Specify the PsPM datafile containing a marker channel with a markerinfo
 field.
\end_layout

\begin_layout Subsubsection*
Marker channel
\end_layout

\begin_layout Standard
Specify which marker channel should be used for marker info extraction.
\end_layout

\begin_layout Subsubsection*
Output
\end_layout

\begin_layout Paragraph*
File
\end_layout

\begin_layout Standard
Specify the output file to which the marker info should be written to.
\end_layout

\begin_layout Paragraph*
Overwrite existing file
\end_layout

\begin_layout Standard
Overwrite existing marker info files.
\end_layout

\begin_layout Section
Convenience functions
\end_layout

\begin_layout Standard
This section is about function which do not directly belong to PsPM but
 may have at some point.
 There is no support for these functions.
 They are kept because they might be useful for some tasks or may serve
 as skeleton for other functions.
 Convenience functions are located in '<pspm-folder>/backroom'.
\end_layout

\begin_layout Itemize

\shape italic
pspm_axpos
\shape default
: Creates position vectors for axes() commands, which can be passed along
 the 'Position' argument.
 
\end_layout

\begin_layout Itemize

\shape italic
pspm_bf_Fourier
\shape default
: Fourier response function for GLM.
\end_layout

\begin_layout Itemize

\shape italic
pspm_convert_
\shape default
...: Conversion functions for
\end_layout

\begin_deeper
\begin_layout Itemize
Illuminance to luminance
\end_layout

\begin_layout Itemize
Lux to candela
\end_layout

\begin_layout Itemize
mm to visual degree
\end_layout

\end_deeper
\begin_layout Itemize

\shape italic
pspm_find_data_epochs
\shape default
: Find epochs of non-zero values in the given data.
\end_layout

\begin_layout Itemize

\shape italic
pspm_get_transfer_function
\shape default
: Tries to estimate a SCR transfer function.
\end_layout

\begin_layout Itemize

\shape italic
pspm_ledalab
\shape default
: Wrapper for Ledalab analysis from within SCRalyze / PsPM.
\end_layout

\begin_layout Itemize

\shape italic
pspm_peakscore
\shape default
: Calculate event-related responses by scoring the peak response against
 a pre-stiumulus baseline.
\end_layout

\begin_layout Itemize

\shape italic
pspm_predval
\shape default
: Computes evidence for a predictive model.
\end_layout

\begin_layout Itemize

\shape italic
pspm_scr2ledalab
\shape default
: Export SCRalyze / PsPM files to ledalab.
\end_layout

\begin_layout Itemize

\shape italic
pspm_sf_get_theta
\shape default
: Create parameters for f_SF, given some SCR data.
\end_layout

\begin_layout Itemize

\shape italic
pspm_transfer_fit
\shape default
: Calculates the mean squared error for pulse rates.
\end_layout

\begin_layout Itemize

\shape italic
SCR_f_amplitude_check
\shape default
: Check the scaling of SCR/SF amplitudes in functions f_SF and f_SCR.
\end_layout

\begin_layout Section
Troubleshooting and known problems
\end_layout

\begin_layout Subsection
Path
\end_layout

\begin_layout Standard
If the PsPM folder is added to the path with all subfolders, the batch editor
 will not work.
 Only put the PsPM main folder (containing the function pspm.m) to the path.
\end_layout

\begin_layout Subsection
Diagnostic graphics for non-linear model inversion
\end_layout

\begin_layout Standard
During non-linear model inversion, a diagnostic window is displayed for
 each trial.
 Between two trials, there is a short period of time during which several
 tabs appear in that window.
 If you click on one of the hidden tabs in that moment, model inversion
 will fail due to a display error.
\end_layout

\begin_layout Subsection
Export statistics into text format with tab delimiter
\end_layout

\begin_layout Standard
The tab delimiter in the exported files is not correctly interpreted by
 text editors like MS Word.
 Nonetheless, the data can be imported into softwares such as Excel or SPSS.
\end_layout

\begin_layout Part
Tutorial
\end_layout

\begin_layout Standard

\shape italic
Contributed by Christoph Korn & Matthias Staib.
\end_layout

\begin_layout Section
GLM for SCR tutorial: Appraisal data 
\begin_inset CommandInset label
LatexCommand label
name "sec:tutorial_GLM"

\end_inset


\end_layout

\begin_layout Standard
Here, we analyze SCR data using a general linear model (GLM).
 The example data set comprises SCR data from 15 participants and can be
 downloaded from 
\begin_inset CommandInset href
LatexCommand href
name "https://bachlab.github.io/PsPM/software/"
target "https://bachlab.github.io/PsPM/software/"
literal "false"

\end_inset

.
 Results from this data set have been previously published 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa,Bach:2014aa"
literal "true"

\end_inset

.
 Each participant saw 45 neutral and 45 aversive pictures within one session
 that included two short breaks.
 SCR data were recorded using a 0.5 V coupler, optical (wave to pulse) transducer
, and CED Spike, with a minimum sampling rate of 100 Hz.
 Be aware that this example uses functions from the MATLAB Signal Processing
 Toolbox, make sure to have it installed before starting the tutorial.
\end_layout

\begin_layout Subsection
Import
\end_layout

\begin_layout Standard
We import the SCR data and the corresponding marker data.
 We first import data from one subject.
\end_layout

\begin_layout Itemize
In the batch editor go to 
\emph on
PsPM 
\begin_inset Formula $\rightarrow$
\end_inset

 Data Preparation 
\begin_inset Formula $\rightarrow$
\end_inset

 Import
\emph default
.
\end_layout

\begin_layout Itemize
Specify the Data Type.
 Several data formats are available.
 The current data set is in the smr format.
\end_layout

\begin_layout Itemize
Select the SCR Data File of the first subject 
\family typewriter
trsp_1_25.smr
\family default
.
\end_layout

\begin_layout Itemize
Specify the 
\emph on
Channels
\emph default
.
 We need one SCR channel and one marker channel.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
The 
\emph on
Channel Number
\emph default
 of the SCR channel is 2.
\end_layout

\begin_layout Itemize
For the 
\emph on
Transfer Function
\emph default
 choose 
\emph on
None
\emph default
.
\end_layout

\begin_layout Itemize
For the 
\emph on
Channel Number
\emph default
 of the marker channel put in 
\emph on
Search
\emph default
 to test the automatic search (otherwise you can specify the number of the
 marker channel manually.
 In this data set, the marker channel is 6).
\end_layout

\end_deeper
\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:import"

\end_inset

 for a picture of the final batch editor.
 We recommend saving the batch and script so that you can easily re-run
 your analyses at a later time point (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Adapting-scripts-for"

\end_inset

).
 Run the batch.
 A mat file with the name 
\family typewriter
pspm_trsp_1_25.mat
\family default
 will be created in the same folder as the original data file.
\end_layout

\begin_layout Standard
You can have a look at the imported data by loading this file into MATLAB.
 The cell array data contains two structures.
 The first one contains the SCR data and the second one the marker data
 (this data set contains 96 markers).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/YY1_import.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Batch editor for importing raw SCR data.
\begin_inset CommandInset label
LatexCommand label
name "fig:import"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Trim
\end_layout

\begin_layout Standard
Most of the time, the SCR recording is switched on some time before the
 actual experiment starts and is switched off some time after it ends.
 These parts of the time series may contain large artifacts from subject
 motion, setting up the equipment, etc.
 Trimming excludes these parts from the analyses.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/YY2_trim.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Batch editor for trimming SCR data.
\begin_inset CommandInset label
LatexCommand label
name "fig:trim"

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In the batch editor go to 
\emph on
PsPM 
\begin_inset Formula $\rightarrow$
\end_inset

 Data Preparation 
\begin_inset Formula $\rightarrow$
\end_inset

Trim
\emph default
.
\end_layout

\begin_deeper
\begin_layout Itemize
Select the currently imported file as Data File.
 Alternatively, you can use the 
\emph on
Dependency
\emph default
 button.
\end_layout

\end_deeper
\begin_layout Itemize
You can choose different References to specify how data should be trimmed.
 Here, select 
\emph on
First/Last Marker
\emph default
 and
\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
From (seconds after first marker)
\emph default
: +110 (In the current data set the first 2 minutes are a task-relevant
 baseline period and are thus trimmed.
 Note that a positive number will delete at least the first marker of the
 original data.
 Thus, make sure that a possible specification of the First-Level takes
 this into account.)
\end_layout

\begin_layout Itemize

\emph on
To (seconds after first marker)
\emph default
: 10 (The specified time window should be large enough to completely include
 the last trial.)
\end_layout

\end_deeper
\begin_layout Standard
You can also specify time points before the markers by using negative numbers
 (see above).
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:trim"

\end_inset

 for a picture of the final batch editor.
 Again, it is recommended to save the batch and script for future use.
 Run the batch.
 A mat file with the name 
\family typewriter
tpspm_trsp_1_25.mat
\family default
 will be created (i.e., a “t” will be prepended).
\end_layout

\begin_layout Subsection
First-Level
\end_layout

\begin_layout Standard
Now, we specify the GLM on the first (i.e., the subject-specific) level, estimatin
g average responses per experimental condition (this equivalent to averaging
 responses over trials in classical "peak scoring" analysis, or to performing
 a first level analysis in SPM).
\end_layout

\begin_layout Itemize
In the batch editor go to 
\emph on
PsPM 
\begin_inset Formula $\rightarrow$
\end_inset

 First Level 
\begin_inset Formula $\rightarrow$
\end_inset

 SCR 
\begin_inset Formula $\rightarrow$
\end_inset

GLM
\shape italic
\emph default
 for SCR
\shape default
.
\end_layout

\begin_layout Itemize

\emph on
Model Filename
\emph default
: This is the name of the resulting mat file containing the GLM.
 Here, we call it 
\family typewriter
glm_25
\family default
.
\end_layout

\begin_layout Itemize

\emph on
Output Directory
\emph default
: The resulting mat file containing the GLM will be saved in this folder.
\end_layout

\begin_layout Itemize

\emph on
Time Units
\emph default
 on which the specification of the conditions will be based.
 Here, we want to analyze with respect to Markers.
\end_layout

\begin_layout Itemize

\emph on
Session(s)
\emph default
: Similar to SPM, SCRalyze allows the specification of multiple sessions
 per subject.
 Here, we only have one session.
\end_layout

\begin_deeper
\begin_layout Itemize
Add the trimmed data (
\family typewriter
tpspm_trsp_1_25.mat
\family default
) as Data File.
 Alternatively, you can use the 
\emph on
Dependency
\emph default
 button.
\end_layout

\begin_layout Itemize

\emph on
Missing Epochs
\emph default
 allows the specification of time periods which you do not want to include
 in the analysis for example because they contain corrupted data.
 In the example data set, there are no missing epochs.
\end_layout

\begin_layout Itemize

\emph on
Data & Design
\emph default
: This option allows specifying the different conditions of the experiment.
 You need to provide the information when the different conditions started.
 This time information has to be in the unit specified above (see 
\emph on
Time Units
\emph default
).
 In the current data set, condition information is provided in Markers and
 is stored in the mat file 
\family typewriter
trSP_appraisal_01_25_onsets_1.mat
\family default
, which you should select as 
\emph on
Condition File
\emph default
.
 When you open this file in MATLAB, you will see that the file contains
 a 1x3 cell “names” and a 1x3 cell “onsets” specifying three conditions.
 The numbers in “onsets” correspond to the 
\begin_inset Formula $n$
\end_inset

th marker when the respective trial started.
\end_layout

\begin_layout Itemize

\emph on
Nuisance File
\emph default
 allows the inclusion of nuisance confounds such as motion or respiration
 parameters.
 Here, we leave it empty.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/YY3_glm.png
	scale 60

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Batch editor for First-Level analysis.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:firstlevel"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize

\emph on
Basis Function
\emph default
: We chose the default 
\emph on
SCRF 1
\emph default
, which is the version with time derivative.
 The default basis set follows the recommendations by 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Itemize

\emph on
Normalize
\emph default
: The design of the current data set is “within-subjects.” Therefore, we
 want to z-normalize the data.
\end_layout

\begin_layout Itemize

\emph on
Filter Settings
\emph default
: We choose the default filter settings, which follow the recommendations
 by 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

:
\end_layout

\begin_deeper
\begin_layout Itemize
first-order low-pass Butterworth filter with a cutoff frequency of 5 Hz
\end_layout

\begin_layout Itemize
first-order high-pass Butterworth filter with a cutoff frequency of 0.05
 Hz
\end_layout

\begin_layout Itemize
Data are resampled to 10 Hz.
\end_layout

\begin_layout Itemize
The filter direction is unidirectional.
\end_layout

\end_deeper
\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:firstlevel"

\end_inset

 for a picture of the final batch editor.
 Again, we recommend saving the batch and script for future use.
 Run the batch.
 A mat file with the specified name will be created in the specified folder.
 
\end_layout

\begin_layout Subsection
Review First-Level Model
\end_layout

\begin_layout Standard
You can have a look at plots related to the first-level model in the batch
 editor.
\end_layout

\begin_layout Itemize
In the batch editor go to 
\emph on
PsPM 
\begin_inset Formula $\rightarrow$
\end_inset

 First Level 
\begin_inset Formula $\rightarrow$
\end_inset

 Review First-level Model
\emph default
.
\end_layout

\begin_layout Itemize
Specify the Model file that you want to review.
 Select the mat file containing the GLM (e.g., 
\family typewriter
glm_25.mat
\family default
).
\end_layout

\begin_layout Itemize
The 
\emph on
Model Type
\emph default
 is of course GLM in the current example.
 You can set the following options to get different types of information:
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate

\emph on
Design matrix
\emph default
: On the x-axis, you see the number of regressors in the model.
 Here we have specified 7 regressors in total.
 On the y-axis, you see the time course of the experiment.
 Note that there are 7 regressors because the specification for the 
\emph on
Basis Function
\emph default
 was 
\emph on
SCRF with time derivative
\emph default
.
 That is, 3 (conditions times) x 2 (basis functions) + 1 (constant) = 7
 regressors.
 You can see that neutral and aversive are intermixed and fall into three
 blocks.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:review1"

\end_inset

.
\end_layout

\begin_layout Enumerate

\emph on
Orthogonality
\emph default
: On the x- and y-axes you see the specified regressors.
 Regressor names are additionally specified along the y-axes.
 The plot depicts the collinearity between regressors.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:review2"

\end_inset

.
\end_layout

\begin_layout Enumerate

\emph on
Predicted & Observed
\emph default
: You see the model fit including the observed response over the whole time
 series, which you can visually compare to the predicted time series by
 the specified model.
 Note that the predicted data will never follow the observed data very closely,
 because we estimated the average response per condition which will deviate
 from the response in each individual trial.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:review3"

\end_inset

.
\end_layout

\begin_layout Enumerate

\emph on
Regressor names
\emph default
: The names of the regressors as specified in the 
\emph on
Conditions File
\emph default
 under 
\emph on
Data & Design
\emph default
 are written to the MATLAB command window.
 The labels bf 1 and bf 2 refer to the two used basis functions (
\emph on
SCRF with time derivative
\emph default
).
\end_layout

\begin_layout Enumerate

\emph on
Reconstructed
\emph default
: Here you see the estimated responses per condition for the first basis
 function.
 These are estimates of the true responses which contain noise.
 The noise term can be negative but if all estimated responses across an
 entire group are negative it is a good idea to look for confounds or correlatio
ns in the design.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:review4"

\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/YY41_review.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Design matrix for sample participant.
 On the x-axis, you see the number of regressors in the model.
 There are 7 regressors (i.e., 3 (conditions times) x 2 (basis functions)
 + 1 (constant)).
 
\begin_inset CommandInset label
LatexCommand label
name "fig:review1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/YY42_review.png
	scale 35

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Design orthogonality plot for sample participant.
 On the x- and y-axes you see the 7 specified regressors.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:review2"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/YY43_review.png
	scale 35

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Model fit for sample participant.
 You see the observed response and the predicted response according to the
 model over the whole time series.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:review3"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/YY44_review.png
	scale 35

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Estimated responses per condition for sample participant.
 You see the estimated responses per condition for the first basis function.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:review4"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
First-Level Contrast Manager
\end_layout

\begin_layout Standard
We want to compare the difference between aversive and neutral pictures
 across participants (i.e., on the second level).
 This can be tested in a paired t-test.
 A paired t-test is a one-sample t-test on difference values between two
 conditions.
 The contrast manager allows you to compute such difference values, for
 each participant (i.e., on the first level).
\end_layout

\begin_layout Itemize
In the batch editor go to 
\emph on
PsPM 
\begin_inset Formula $\rightarrow$
\end_inset

 First-Level 
\begin_inset Formula $\rightarrow$
\end_inset

 First-Level Contrasts
\emph default
.
\end_layout

\begin_layout Itemize

\emph on
Model File(s)
\emph default
: Select the mat file containing the GLM (here 
\family typewriter
glm_25.mat
\family default
).
\end_layout

\begin_layout Itemize

\emph on
Stats type
\emph default
: You can choose between 3 different options to set up the contrasts.
 Here, we choose the option Condition, which specifies contrasts formulated
 in terms of conditions and automatically uses only the first basis function
 (i.e., without derivatives).
\end_layout

\begin_layout Itemize

\emph on
Contrast
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Contrast Name
\emph default
: Chose a name so that you can easily refer to the contrast (e.g., aversive>neutra
l)
\end_layout

\begin_layout Itemize

\emph on
Contrast Vector
\emph default
: Specify a vector of the contrast you want to test for.
 Here, we are interested in the difference between aversive and neutral
 pictures, i.e., the first and the second condition.
 Therefore, specify the vector [-1, 1, 0].
 You could also leave out the last zero because trailing zeros are automatically
 appended.
 (But you could not leave out the first zero in a contrast such as [0 -1
 1].)
\end_layout

\end_deeper
\begin_layout Subsection
Export Statistics
\end_layout

\begin_layout Standard
You can use this functionality to export all necessary parameters on the
 screen or into an extra file, which allows you to analyze the data in the
 statistics program of your choice.
 For details see 
\emph on
PsPM 
\begin_inset Formula $\rightarrow$
\end_inset

 First Level
\emph default
 
\emph on

\begin_inset Formula $\rightarrow$
\end_inset

 Export Statistics
\emph default
.
\end_layout

\begin_layout Subsection
Adapting scripts for multiple participants and second-level analyses 
\end_layout

\begin_layout Standard
For didactic purposes, we have so far only considered one participant.
 But in most experiments, you want to analyze data from multiple subjects
 (i.e., a second-level analysis).
 For a description on how to do this see Chapters 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Adapting-scripts-for"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Second-level-Contrast-Manager"

\end_inset

.
 You can find a script that runs the above described analyses for multiple
 participants at 
\begin_inset CommandInset href
LatexCommand href
name "pspm.sourceforge.net"
target "http://pspm.sourceforge.net"
literal "false"

\end_inset

 (import_trim_glm_contr_job_loop).
 
\end_layout

\begin_layout Section
Non-linear SCR tutorial: Delay fear conditioning data
\begin_inset CommandInset label
LatexCommand label
name "sec:Delay-fear-conditioning"

\end_inset


\end_layout

\begin_layout Standard
The example data set comprises SCR data from 20 participants, with 40 trials
 each, which can be downloaded from 
\begin_inset CommandInset href
LatexCommand href
name "https://bachlab.github.io/PsPM/software/"
target "https://bachlab.github.io/PsPM/software/"
literal "false"

\end_inset

 together with the result files of the model inversion.
 Participants underwent a differential delay fear conditioning paradigm
 where coloured circles were presented for 4 seconds each.
 Either the blue or orange coloured circles (balanced over participants)
 were probabilistically paired with an electric stimulation (unconditioned
 stimulus, US) that coterminated with the stimulus (conditioned stimulus,
 CS+) while the CS- were always presented alone.
\end_layout

\begin_layout Standard
Presenting the CS+ causes phasic sympathetic arousal in anticipation of
 an electric shock.
 This anticipatory reaction typically occurs with an unknown and variable
 latency after stimulus onset.
 For such cases, a GLM should not be used because it assumes that sympathetic
 arousal follows the stimulus with a fixed latency.
 In contrast, the non-linear model allows estimating (i) a variable onset
 within a user-specified time window and (ii) a variable duration of a sympathet
ic response.
 Additionally, the non-linear model includes estimation of spontaneous fluctuati
ons that occur between trials.
\end_layout

\begin_layout Standard
In this tutorial, the non-linear model is estimated.
 The estimated parameters can then be used to test the within-subject hypothesis
 that the sympathetic arousal between CS+ and CS- are different on a group
 level.
\end_layout

\begin_layout Subsection
Setup the Non-Linear Model
\end_layout

\begin_layout Standard
In this step you prepare the model estimation.
 For this, you need to provide timing information about the experimental
 events which can either be entered manually or as a Matlab file.
 For large numbers of events as in this experiment, a timing file can easily
 be created using a few lines of Matlab code.
 Here we use timing information saved in the trimmed PsPM file.
 In this file, a trigger was saved at every CS onset.
 For timing information from other sources, the code has to be adapted according
ly.
 Go to the Matlab command window and enter the following lines, but replace
 
\family typewriter
[insert path!]
\family default
 by the correct path where the filtered SCR data from 
\begin_inset CommandInset href
LatexCommand href
name "pspm.sourceforge.net"
target "http://pspm.sourceforge.net"
literal "false"

\end_inset

 is saved on your hard drive, e.g.
 
\family typewriter
C:
\backslash
PsPM_Tutorial
\backslash
nonlinear
\backslash

\family default
.
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout
\noindent

data_path = [insert path!]; % set the correct PsPM file path here!
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

p = 1; % the first participant
\end_layout

\begin_layout Plain Layout
\noindent

SOA = 3.5; % delay between CS and US onset in seconds
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

% load events of CS onsets from trimmed scr data
\end_layout

\begin_layout Plain Layout
\noindent

pname = fullfile(data_path,sprintf('tpspm_s%i.mat',p))
\end_layout

\begin_layout Plain Layout
\noindent

[sts, infos, data, filestruct] = pspm_load_data(pname,'events');
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

CS_onset = data{1, 1}.data; % recorded triggers of CS onset in seconds
\end_layout

\begin_layout Plain Layout
\noindent

US_onset = data{1, 1}.data + SOA; % US starts 3.5 seconds after CS
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

% variable latency for CS response between CS onset and US onset/omission
\end_layout

\begin_layout Plain Layout
\noindent

events{1} = [CS_onset US_onset]; % define an interval of 3.5 seconds for
 each trial
\end_layout

\begin_layout Plain Layout
\noindent

% constant onset for US response
\end_layout

\begin_layout Plain Layout
\noindent

events{2} = US_onset;
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

save(fullfile(data_path,sprintf('event_timings_s%i.mat',p)),'events')
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
\align left
The resulting file 
\family typewriter
event_timings_s1.mat
\family default
 contains the variable events with two cells.
\end_layout

\begin_layout Itemize
The first cell 
\emph on
events{1}
\emph default
 is a 40 x 2 matrix with the onset and offset of a time window for each
 trial in which we expect the response to the CS (both CS+ and CS- are treated
 the same here).
 We expect the response to the CS to occur with a variable onset in time.
 Note that the window for the CS response ends when the US starts (or is
 omitted), i.e.
 after 3.5 seconds.
\end_layout

\begin_layout Itemize
The second cell 
\emph on
events{2}
\emph default
 is a 40 x 1 vector that marks the onset of the electrical stimulation.
 For this event we expect an evoked response with constant latency after
 US occurrence.
 Importantly, we provide timings 
\emph on
both for the occurrence and the omission of the US
\emph default
.
 Modelling an unconditioned response in all trials is necessary to get unbiased
 estimates for the CS responses.
 In general, the trial structure should always be the same for all trials,
 across experimental conditions.
\end_layout

\begin_layout Standard
Now the non-linear model estimation can be set up (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Prepare-a-batch"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/Batch_nonlinear.png
	scale 65

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Prepare a batch to set up a non linear model for SCR analysis.
\begin_inset CommandInset label
LatexCommand label
name "fig:Prepare-a-batch"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In the batch editor go to 
\emph on
PsPM 
\emph default

\begin_inset Formula $\rightarrow$
\end_inset


\emph on
 First Level 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\rightarrow$
\end_inset


\family default
\series default
\shape default
\size default
\emph on
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 SCR 
\begin_inset Formula $\rightarrow$
\end_inset

 Non-Linear Model
\end_layout

\begin_layout Itemize

\emph on
Model Filename
\emph default
: dcm_s1
\end_layout

\begin_layout Itemize

\emph on
Output Directory
\emph default
: Specify a folder where the model will be saved
\end_layout

\begin_layout Itemize

\emph on
Chan
\emph default
nel: Default
\end_layout

\begin_layout Itemize

\emph on
Data & Design:
\begin_inset Formula $\rightarrow$
\end_inset

New: Session
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Data File
\emph default
: choose tscr_s1.mat from your hard drive
\end_layout

\begin_layout Itemize

\emph on
Design
\begin_inset Formula $\rightarrow$
\end_inset

Timing File
\begin_inset Formula $\rightarrow$
\end_inset


\emph default
Select the previously created 
\family typewriter
event_timings_s1.mat
\family default
 which was saved to your scr folder
\end_layout

\begin_layout Itemize

\emph on
Condition names: New Condition
\emph default
 here we can define conditions that each trial belongs to.
 Create three new conditions.
 Note that we split CS+ trials in reinforced (CS+|US+) and non-reinforced
 (CS+|US-) trials because CS+|US+ trials are excluded from some analyses.
\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Condition
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Name: CS+|US-
\end_layout

\begin_layout Itemize

\emph on
Index: 6 7 11 14 16 18 26 29 38 40
\end_layout

\end_deeper
\begin_layout Itemize

\emph on
Condition
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Name: CS+|US+
\end_layout

\begin_layout Itemize

\emph on
Index: 13 17 19 20 21 24 28 31 32 37
\end_layout

\end_deeper
\begin_layout Itemize

\emph on
Condition
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Name: CS-
\end_layout

\begin_layout Itemize

\emph on
Index: 1 2 3 4 5 8 9 10 12 15 22 23 25 27 30 33 34 35 36 39
\end_layout

\end_deeper
\end_deeper
\end_deeper
\begin_layout Itemize

\emph on
Display Options
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Display Progress Window
\emph default
: If you plan to run the estimation in the background, you can turn off
 the progress window with this option
\end_layout

\end_deeper
\begin_layout Itemize

\emph on
For the remaining fields you can keep the default settings
\end_layout

\begin_layout Standard
Save the batch and script as 
\family typewriter
batch_model_s1.m
\family default
 and press run.
 A window will be displayed that shows the progress of model estimation
 for each trial.
 The estimation for an entire session takes several minutes depending on
 your system.
 The file 
\family typewriter
dcm_s1.mat
\family default
 will be created.
 If you want to, you can review the first-level model by clicking 
\emph on
Review model
\emph default
 in the PsPM user interface.
 In the new window (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Use-Review-Model"

\end_inset

) add the non-linear model 
\family typewriter
dcm_s1.mat
\family default
 and choose 
\emph on
Display All trials for one session
\emph default
.
 A graphics window (Fig X) will display the original data (blue) together
 with the model estimation (green).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/Review_1stmodel1.PNG
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Use 
\emph on
Review Model
\emph default
 to inspect parameter estimation for one or multiple trials.
\begin_inset CommandInset label
LatexCommand label
name "fig:Use-Review-Model"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
First-level Contrasts
\end_layout

\begin_layout Standard
In this step you specify the hypothesis that a CS+ elicits a stronger sympatheti
c arousal than a CS- for an individual participant by providing a contrast
 weight vector.
\end_layout

\begin_layout Itemize
In the batch editor go to 
\emph on
PsPM
\begin_inset Formula $\rightarrow$
\end_inset

First Level
\begin_inset Formula $\rightarrow$
\end_inset

First-level Contrasts
\end_layout

\begin_layout Itemize

\emph on
Model File(s):
\emph default
 Select 
\family typewriter
dcm_s1.mat
\end_layout

\begin_layout Itemize

\emph on
Specify Contrasts on Datatype: param
\end_layout

\begin_layout Itemize

\emph on
Contrasts: New Contrast
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Contrast 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Name: Fear Learning
\end_layout

\begin_layout Itemize

\emph on
Contrast Vector: -1 -1 -1 -1 -1 2 2 -1 -1 -1 2 -1 0 2 -1 2 0 2 0 0 0 -1
 -1 0 -1 2 -1 0 2 -1 0 0 -1 -1 -1 -1 0 2 -1 2
\emph default
 Note: A weight of +2 is assigned to the CS+|US- because we have twice as
 many CS- and the contrast vector has to sum up to zero.
\end_layout

\begin_layout Itemize

\emph on
Name: Electric Stimulation
\emph default
 We include this contrast optionally to check if the electrical stimulation
 caused an increase in sympathetic arousal which is a premise for successful
 fear conditioning.
\end_layout

\begin_layout Itemize

\emph on
Contrast Vector: -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 3 -1 -1 -1 3 -1 3 3
 3 -1 -1 3 -1 -1 -1 3 -1 -1 3 3 -1 -1 -1 -1 3 -1 -1 -1
\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize

\emph on
Delete: existing contrasts: No (default)
\end_layout

\begin_layout Standard
Save the batch and script as 
\family typewriter
batch_contrast_s1.m
\family default
 and press run.
 The model file of participant s1 now contains the contrast that can be
 forwarded to a statistical test on group level.
 Preparing analyses for more than one scr file is explained in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Adapting-scripts-for"

\end_inset

.
\end_layout

\begin_layout Subsection
Exporting statistics
\end_layout

\begin_layout Standard
PsPM provides basic tools for statistical analysis on the estimates of the
 non-linear model.
 Alternatively you can export the results as a text file to use them in
 different software applications.
\end_layout

\begin_layout Itemize
In the batch editor go to SCR
\begin_inset Formula $\rightarrow$
\end_inset

First Level
\begin_inset Formula $\rightarrow$
\end_inset

Export Data
\end_layout

\begin_layout Itemize

\emph on
Model File(s): 
\emph default
Select 
\emph on
dcm_s1.mat
\end_layout

\begin_layout Itemize

\emph on
Specify Export on Datatype: param
\end_layout

\begin_layout Itemize

\emph on
Target
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Filename 
\emph default
Enter
\emph on
 
\family typewriter
\emph default
dcm_s01
\end_layout

\end_deeper
\begin_layout Itemize

\emph on
Specify Delimiter for Output File
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Semicolon
\end_layout

\end_deeper
\begin_layout Standard
The text file will be saved to Matlab’s current working directory.
\end_layout

\begin_layout Section
Adapting scripts for multiple participants
\begin_inset CommandInset label
LatexCommand label
name "sec:Adapting-scripts-for"

\end_inset


\end_layout

\begin_layout Standard
In most experiments, you want to analyze data from multiple subjects, which
 implies that you have to repeat model estimation several times.
 There are two simple strategies to make this easier.
\end_layout

\begin_layout Itemize
Use dependencies: You can specify all steps for one subject in one go.
 At some points, you need to specify a file from a previous step (e.g., when
 trimming you need the file containing the imported data).
 In these cases, you can use the button “Dependency” to specify the correspondin
g file, but make sure the number of output files of the preceding module
 corresponds with the allowed number of input files for this module.
\end_layout

\begin_layout Itemize
Loop over participants in the script: You can easily adapt the scripts for
 many subjects by including a loop and adapting the file names.
 This is independent of whether or not you use dependencies.
 To show you how this works, see the examples below.
\end_layout

\begin_layout Subsection
Importing and trimming data
\end_layout

\begin_layout Standard
Here, we create an example script for importing and trimming data.
 We chose these steps since they are required in all types of analysis.
 The current example is based on the Appraisal dataset described in Chapter
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:tutorial_GLM"

\end_inset

.
\end_layout

\begin_layout Itemize
In the batch editor specify all parameters in PsPM 
\begin_inset Formula $\rightarrow$
\end_inset

 Data Preparation 
\begin_inset Formula $\rightarrow$
\end_inset

 Import.
\end_layout

\begin_layout Itemize
You do not need to specify the SCR Data File.
 This will later be put in the script that loops over subjects.
\end_layout

\begin_layout Itemize
In the batch editor specify all parameters in PsPM 
\begin_inset Formula $\rightarrow$
\end_inset

 Data Preparation 
\begin_inset Formula $\rightarrow$
\end_inset

 Trim.
\end_layout

\begin_layout Itemize
Use the dependency button to select the imported Data File.
\end_layout

\begin_layout Itemize
Save batch and script.
\end_layout

\begin_layout Itemize
Open the saved job script (e.g., 
\family typewriter
batch_import_trim_job.m
\family default
) and build a loop around the lines of code that were saved.
 In this loop, create a subject-specific filename (and make sure to include
 the whole path to the files in the variable data_path).
\end_layout

\begin_layout Standard
\noindent
\begin_inset listings
inline false
status open

\begin_layout Plain Layout
\noindent

data_path = [insert path!];
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

for p = 25:39; % participants
\end_layout

\begin_layout Plain Layout
\noindent

% load participant-specific raw data
\end_layout

\begin_layout Plain Layout
\noindent

spike.datafile = {fullfile(data_path,sprintf('trsp_1_%i.smr',p))};
\end_layout

\begin_layout Plain Layout
\noindent

spike.importtype{1}.scr.chan_nr.chan_nr_spec = 2;
\end_layout

\begin_layout Plain Layout
\noindent

spike.importtype{1}.scr.transfer.none = true;
\end_layout

\begin_layout Plain Layout
\noindent

spike.importtype{2}.marker.chan_nr.chan_nr_spec = 0;
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.prep{1}.import.datatype.spike = spike;
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.prep{1}.import.overwrite = false;
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{2}.pspm{1}.prep{1}.trim.datafile(1) = ...
\end_layout

\begin_layout Plain Layout
\noindent

cfg_dep('Import: Output File', substruct('.', ...
 
\end_layout

\begin_layout Plain Layout
\noindent

'val', '{}',{1}, '.','val', ...
\end_layout

\begin_layout Plain Layout
\noindent

'{}',{1}, '.','val', '{}',{1}), substruct('()',{':'}));
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{2}.pspm{1}.prep{1}.trim.ref.ref_mrk.from = 110;
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{2}.pspm{1}.prep{1}.trim.ref.ref_mrk.to = 10;
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{2}.pspm{1}.prep{1}.trim.ref.ref_mrk.mrk_chan.chan_def = 0;
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{2}.pspm{1}.prep{1}.trim.overwrite = false;
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

% run batch
\end_layout

\begin_layout Plain Layout
\noindent

pspm_jobman('initcfg');
\end_layout

\begin_layout Plain Layout
\noindent

pspm_jobman('run', matlabbatch);
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

end
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
Run the script.
 The folder 
\family typewriter
data_path
\family default
 now contains trimmed scr files for all subjects.
\end_layout

\begin_layout Subsection
Inverting non-linear models
\end_layout

\begin_layout Standard
Here we adapt the model inversion from Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Delay-fear-conditioning"

\end_inset

 to multiple subjects.
 We use similar loops as above to create timing files and PsPM batches.
\end_layout

\begin_layout Standard
First, open the MATLAB script that created the timing file 
\family typewriter
event_timings_s1.mat
\family default
 and construct a loop around it for subjects 2 to 20.
 Execute the script to obtain files containing timing information for subjects
 2 to 20.
 Alternatively you can use the timing files for subjects 2 to 20 downloaded
 from 
\begin_inset CommandInset href
LatexCommand href
name "pspm.sourceforge.net"
target "http://pspm.sourceforge.net"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Next, open the saved job script (e.g., 
\family typewriter
batch_model_s1_job.m
\family default
) created in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Delay-fear-conditioning"

\end_inset

 and build a loop around the lines of code that were saved.
 Make sure to include the whole path to the files in the variable 
\family typewriter
data_path
\family default
.
 You can use the following code as guideline.
\begin_inset Newline newline
\end_inset


\begin_inset listings
inline false
status open

\begin_layout Plain Layout
\noindent

% set the path where you saved the scr data files
\end_layout

\begin_layout Plain Layout
\noindent

data_path = [insert path!];
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

% set the path where you saved the model file of participant 1
\end_layout

\begin_layout Plain Layout
\noindent

model_path = [insert path!]; % initiate PsPM pspm_init % loop through participan
ts 2 to 20
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

% initialize PsPM
\end_layout

\begin_layout Plain Layout
\noindent

pspm_init
\end_layout

\begin_layout Plain Layout
\noindent

pspm_jobman('initcfg')
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

for p = 2:20
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

clear matlabbatch dcm
\end_layout

\begin_layout Plain Layout
\noindent

dcm.modelfile = ['dcm_s' num2str(p)];
\end_layout

\begin_layout Plain Layout
\noindent

dcm.outdir = {model_path};
\end_layout

\begin_layout Plain Layout
\noindent

dcm.chan.chan_def = 0;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.session.datafile = ...
\end_layout

\begin_layout Plain Layout
\noindent

{fullfile(data_path,['tpspm_s' num2str(p) '.mat'])};
\end_layout

\begin_layout Plain Layout
\noindent

dcm.session.timing.timingfile = ...
\end_layout

\begin_layout Plain Layout
\noindent

{fullfile(data_path,['event_timings_s' num2str(p) '.mat'])};
\end_layout

\begin_layout Plain Layout
\noindent

dcm.session.condition(1).name = 'CS+|US-';
\end_layout

\begin_layout Plain Layout
\noindent

dcm.session.condition(1).index = [6 7 11 14 16 18 26 29 38 40];
\end_layout

\begin_layout Plain Layout
\noindent

dcm.session.condition(2).name = 'CS+|US+';
\end_layout

\begin_layout Plain Layout
\noindent

dcm.session.condition(2).index = [13 17 19 20 21 24 28 31 32 37];
\end_layout

\begin_layout Plain Layout
\noindent

dcm.session.condition(3).name = 'CS-';
\end_layout

\begin_layout Plain Layout
\noindent

dcm.session.condition(3).index = ...
\end_layout

\begin_layout Plain Layout
\noindent

[1 2 3 4 5 8 9 10 12 15 22 23 25 27 30 33 34 35 36 39];
\end_layout

\begin_layout Plain Layout
\noindent

dcm.data_options.norm = 0;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.data_options.filter.def = 0;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.resp_options.crfupdate = 0;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.resp_options.indrf = 0;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.resp_options.getrf = 0;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.resp_options.rf = 0;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.inv_options.depth = 2;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.inv_options.sfpre = 2;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.inv_options.sfpost = 5;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.inv_options.sffreq = 0.5;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.inv_options.sclpre = 2;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.inv_options.sclpost = 5;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.inv_options.ascr_sigma_offset = 0.1;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.disp_options.dispwin = 0;
\end_layout

\begin_layout Plain Layout
\noindent

dcm.disp_options.dispsmallwin = 0;
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.first_level{1}.scr{1}.dcm = dcm;
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

% run batch
\end_layout

\begin_layout Plain Layout
\noindent

pspm_jobman('run', matlabbatch);
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

end
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
Similarly to the previous step, the batch of the first-level Contrast of
 participant 1 is adapted to participants 2 to 20.
 Run the following code in MATLAB, but replace
\family typewriter
 [insert path!]
\family default
 with the path on your hard drive where you saved 
\family typewriter
dcm_s1.mat
\family default
:
\begin_inset Newline newline
\end_inset


\begin_inset listings
inline false
status open

\begin_layout Plain Layout
\noindent

% set the path where you saved the estimated non-linear model
\end_layout

\begin_layout Plain Layout
\noindent

model_path = [insert path!];
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

% initialize PsPM
\end_layout

\begin_layout Plain Layout
\noindent

pspm_init
\end_layout

\begin_layout Plain Layout
\noindent

pspm_jobman('initcfg')
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

% loop through participants 2 to 20
\end_layout

\begin_layout Plain Layout
\noindent

for p = 2:20
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

clear matlabbatch
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.first_level{1}.contrast.modelfile = ...
\end_layout

\begin_layout Plain Layout
\noindent

{fullfile(model_path,['dcm_s' num2str(p) '.mat'])};
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.first_level{1}.contrast.datatype = 'param';
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.first_level{1}.contrast.con(1).conname = 'Fear Learning';
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.first_level{1}.contrast.con(1).convec = ...
\end_layout

\begin_layout Plain Layout
\noindent

[-1 -1 -1 -1 -1 2 2 -1 -1 -1 2 -1 0 2 -1 2 0 2 ...
\end_layout

\begin_layout Plain Layout
\noindent

0 0 0 -1 -1 0 -1 2 -1 0 2 -1 0 0 -1 -1 -1 -1 0 2 -1 2];
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.first_level{1}.contrast.con(2).conname = ...
\end_layout

\begin_layout Plain Layout
\noindent

'Electric Stimulation';
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.first_level{1}.contrast.con(2).convec = ...
\end_layout

\begin_layout Plain Layout
\noindent

[-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 3 -1 -1 -1 ...
\end_layout

\begin_layout Plain Layout
\noindent

3 -1 3 3 3 -1 -1 3 -1 -1 -1 3 -1 -1 3 3 -1 -1 -1 -1 3 -1 -1 -1];
\end_layout

\begin_layout Plain Layout
\noindent

matlabbatch{1}.pspm{1}.first_level{1}.contrast.deletecon = true;
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

% run batch manually
\end_layout

\begin_layout Plain Layout
\noindent

pspm_jobman('run', matlabbatch);
\end_layout

\begin_layout Plain Layout
\noindent

\end_layout

\begin_layout Plain Layout
\noindent

end
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
Run the script.
 The statistics for each contrast are now added to the model file.
\end_layout

\begin_layout Section
Second-level Contrast Manager
\begin_inset CommandInset label
LatexCommand label
name "sec:Second-level-Contrast-Manager"

\end_inset


\end_layout

\begin_layout Standard
In most cases, we want to compare the difference between conditions across
 participants on a group level (i.e., the second level in a hierarchical model).
 Each participant represents one data point that goes into a one sample
 t-test.
\end_layout

\begin_layout Standard
Below we demonstrate how to set-up Second-level contrasts for GLM and non-linear
 models.
\end_layout

\begin_layout Subsection
GLM
\end_layout

\begin_layout Standard
For the appraisal data of Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:tutorial_GLM"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Define Second-Level Model
\end_layout

\begin_layout Itemize
In the batch editor go to 
\emph on
PsPM
\begin_inset Formula $\rightarrow$
\end_inset

Second Level
\begin_inset Formula $\rightarrow$
\end_inset

Define Second-Level Model
\emph default
.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Test Type: One Sample T-Test
\end_layout

\begin_layout Itemize

\emph on
Model File(s)
\emph default
: Select the model files from all participants
\end_layout

\begin_layout Itemize

\emph on
Output Directory:
\emph default
 Choose a location to save the group result
\end_layout

\begin_layout Itemize

\emph on
Filename for Output Model
\emph default
: Chose a name so that you can easily refer to the contrast
\end_layout

\begin_layout Itemize

\emph on
Define Contrast: Read from First Model File
\emph default
: Choose 
\emph on
All Contrasts
\emph default
.
 This will select the contrast(s) that we created in the first level (i.e.,
 in our case aversive>neutral)
\end_layout

\end_deeper
\begin_layout Subsubsection
Report Second-Level Results
\end_layout

\begin_layout Itemize
In the batch editor go to 
\emph on
PsPM 
\begin_inset Formula $\rightarrow$
\end_inset

Second Level
\begin_inset Formula $\rightarrow$
\end_inset

Report Second-Level Results
\emph default
.
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize

\emph on
Model File
\emph default
: Select the second level model file that you created in the previous step.
\end_layout

\begin_layout Itemize

\emph on
Contrast Vector
\emph default
: Leave empty because we want all contrasts to be reported.
\end_layout

\end_deeper
\begin_layout Standard
Run the batch.
 A figure appears that shows you a bar graph of the mean of the parameter
 estimates and the statistics will be printed to the MATLAB command window.
\end_layout

\begin_layout Subsection
Non-linear models
\end_layout

\begin_layout Standard
Here, we test the difference in anticipatory sympathetic arousal elicited
 by a CS+ vs CS- on a group level (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Delay-fear-conditioning"

\end_inset

).
 As a supplementary hypothesis we want to check if the US+ indeed elicited
 a stronger response than the US-.
 From the 1st level contrast, eight statistics were generated for each model
 file.
 Use the 
\emph on
Review Model
\emph default
 utility from the PsPM main GUI to get a list of all contrasts.
 In the 
\emph on
First Level Review Manager
\emph default
, click on 
\emph on
Add Model
\emph default
, choose any model file created previously and press 
\emph on
Done
\emph default
.
 Now press the Show button next to 
\emph on
Contrast names in command window
\emph default
 (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:FLRM2"

\end_inset

) to get a list of all contrasts:
\end_layout

\begin_layout Itemize

\emph on
Contrast 1: Fear Learning - Flexible response # 1: amplitude
\end_layout

\begin_layout Itemize

\emph on
Contrast 2: Electric Stimulation - Flexible response # 1: amplitude
\end_layout

\begin_layout Itemize

\emph on
Contrast 3: Fear Learning - Flexible response # 1: peak latency
\end_layout

\begin_layout Itemize

\emph on
Contrast 4: Electric Stimulation - Flexible response # 1: peak latency
\end_layout

\begin_layout Itemize

\emph on
Contrast 5: Fear Learning - Flexible response # 1: dispersion
\end_layout

\begin_layout Itemize

\emph on
Contrast 6: Electric Stimulation - Flexible response # 1: dispersion
\end_layout

\begin_layout Itemize

\emph on
Contrast 7: Fear Learning - Fixed response # 1 response amplitude
\end_layout

\begin_layout Itemize

\emph on
Contrast 8: Electric Stimulation - Fixed response # 1 response amplitude
\end_layout

\begin_layout Standard
Our hypothesis is concerned only with the response amplitude of the flexible
 event (anticipation of the CS) and the response amplitude of the fixed
 event (electrical stimulation), which are the first and eighth contrasts.
 The indices of these two contrasts are used for the setup of the Second-Level
 model below.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/reviewmodel.png
	scale 35

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The First Level Review Manager displays all contrasts that are stored in
 a model file.
\begin_inset CommandInset label
LatexCommand label
name "fig:FLRM2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize
In the batch editor go to PsPM
\begin_inset Formula $\rightarrow$
\end_inset

Second Level
\begin_inset Formula $\rightarrow$
\end_inset

Define Second-Level Model
\end_layout

\begin_layout Itemize
Test Type: One Sample T-Test
\end_layout

\begin_layout Itemize
Model File(s): Select the model files from all participants
\end_layout

\begin_layout Itemize
Output Directory: Choose a location to save the group result
\end_layout

\begin_layout Itemize
Filename for Output Model: Fear_Learning
\end_layout

\begin_layout Itemize
Define Contrast: Read from First Model File
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Contrast Vector: [1, 8]
\end_layout

\end_deeper
\begin_layout Itemize
Overwrite Existing File: No (default)
\end_layout

\begin_layout Standard
Run the batch.
 You can display the results of the second level contrasts by pressing 
\emph on
Report 2nd level result
\emph default
 in the PsPM user interface and choosing 
\family typewriter
Fear_Learning.mat
\family default
.
 A Figure displays the mean differences and standard error for the hypothesis
 that the CS+ elicits a stronger sympathetic arousal than CS- and that an
 electric stimulation results in an increase in sympathetic arousal (Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Display-of-results"

\end_inset

).
 Statistical parameters are printed in the MATLAB command window (Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Statistics-from-one-sampled"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/2ndlvl_bars.PNG
	scale 35

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Display of results from a group analysis (2nd level).
 Left bar: difference in amplitude of sympathetic arousal (aSA) to CS+|US-
 minus CS-.
 Right bar: difference in aSA to US+ minus US-
\begin_inset CommandInset label
LatexCommand label
name "fig:Display-of-results"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/2ndlvl_table.PNG
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Statistics from one-sampled t-tests CS|US- minus CS- and US+ minus US- for
 20 participants.
\begin_inset CommandInset label
LatexCommand label
name "fig:Statistics-from-one-sampled"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Calling PsPM functions directly from the Matlab command line
\end_layout

\begin_layout Standard
All the above mentioned steps in this tutorial can also be done in the Matlab
 command line without using the Matlabbatch syntax.
 Calling PsPM functions allows fast analysis of the data, efficient processing
 of multiple subject data and gives a lot more flexibility when it comes
 to fine tuning.
 However, this also requires knowledge about the Matlab command line and
 about the PsPM functions used.
 In this section we will revisit some examples from above and go through
 them by calling PsPM functions directly.
 
\end_layout

\begin_layout Subsection*
Basic PsPM setup
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{par}
\end_layout

\end_inset

 Here we setup the command line environment.
 This includes adding PsPM to the path as well as creating path variables
 for other information such as the path where the tutorial data is located.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{par}
\end_layout

\end_inset

 
\begin_inset VSpace 1em
\end_inset

 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

% The path where the 'Tutorial_data_GLM' folder is located
\end_layout

\begin_layout Plain Layout

work_path = 'Path where the data is located';
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Where to find the tutorial data
\end_layout

\begin_layout Plain Layout

tutorial_data = [work_path filesep 'Tutorial_data_GLM'];
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% The path where PsPM is located
\end_layout

\begin_layout Plain Layout

pspm_path = 'Path where PsPM is located';
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Add PsPM to the search path of matlab
\end_layout

\begin_layout Plain Layout

addpath(pspm_path);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% initialise PsPM
\end_layout

\begin_layout Plain Layout

pspm_init;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Change path to the working directory
\end_layout

\begin_layout Plain Layout

cd(work_path);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Define for which subject we want to execute this code:
\end_layout

\begin_layout Plain Layout

subject = 25;
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Import the data
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{par}
\end_layout

\end_inset

 Here we will import the data from an aquisition file into a PsPM-Matlab
 file which we can later use to fit a GLM.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{par}
\end_layout

\end_inset

 
\begin_inset VSpace 1em
\end_inset

 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

% Compose name of datafile and combine with the path where to find it.
\end_layout

\begin_layout Plain Layout

data_file_name = sprintf('trsp_1_%i.smr', subject);
\end_layout

\begin_layout Plain Layout

data_file = [tutorial_data filesep data_file_name];
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% With the option overwrite you can tell whether to overwrite existing
\end_layout

\begin_layout Plain Layout

% files (=true) or not (=false).
\end_layout

\begin_layout Plain Layout

options = struct('overwrite', true);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Define which channels should be imported and what are the settings of
\end_layout

\begin_layout Plain Layout

% those.
 This tells the function to import channel 2 as SCR channel
\end_layout

\begin_layout Plain Layout

% with transfer function disabled and a marker channel, which should be
\end_layout

\begin_layout Plain Layout

% found automatically (therefore no channel id is provided).
\end_layout

\begin_layout Plain Layout

import = { ...
\end_layout

\begin_layout Plain Layout

    struct('type', 'scr', 'channel', 2, 'transfer', 'none'), ...
\end_layout

\begin_layout Plain Layout

    struct('type', 'marker') ...
\end_layout

\begin_layout Plain Layout

    };
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Call PsPM function to import the file.
 'spike' is the datatype of the
\end_layout

\begin_layout Plain Layout

% file.
 You can check in pspm_init under defaults.import.chantypes
\end_layout

\begin_layout Plain Layout

% which datatypes are supported.
 The function returns the path to the
\end_layout

\begin_layout Plain Layout

% imported file.
\end_layout

\begin_layout Plain Layout

imported_file = pspm_import(data_file, 'spike', import, options);
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Trim the data
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{par}
\end_layout

\end_inset

 Trimming allows to cut away the data which should not be used for further
 analysis.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{par}
\end_layout

\end_inset

 
\begin_inset VSpace 1em
\end_inset

 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

% Set option to overwrite existing files.
\end_layout

\begin_layout Plain Layout

options = struct('overwrite', true);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Remove the 110s after the first marker and 10s after the last
\end_layout

\begin_layout Plain Layout

% marker.
\end_layout

\begin_layout Plain Layout

trimmed_file = pspm_trim(imported_file, 110, 10, 'marker', options);
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Fit GLM
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{par}
\end_layout

\end_inset

 Set the model settings and fit the GLM.
 The model uses a separate timing file with timeunits 'markers'.
 We also specify to normalise the data and set a custom response function.
 Args is passed to the response function and the format of an argument therefore
 depends on the specified response function itself.
 Also we tell the function to overwrite existing files by passing options.overwri
te = true; 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{par}
\end_layout

\end_inset

 
\begin_inset VSpace 1em
\end_inset

 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

% set option 'overwrite' to true
\end_layout

\begin_layout Plain Layout

options = struct('overwrite', true);
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% set model settings
\end_layout

\begin_layout Plain Layout

model = struct('modelfile', [tutorial_data filesep sprintf('glm_%i', subject)],
 ...
\end_layout

\begin_layout Plain Layout

    'datafile', trimmed_file, ...
\end_layout

\begin_layout Plain Layout

    'timing', [tutorial_data filesep sprintf('trSP_appraisal_01_%i_onsets_1.mat',
 subject)], ...
\end_layout

\begin_layout Plain Layout

    'timeunits', 'markers', ...
\end_layout

\begin_layout Plain Layout

    'norm', 1, ...
\end_layout

\begin_layout Plain Layout

    'modelspec', 'scr', ...
\end_layout

\begin_layout Plain Layout

    'bf', struct('fhandle', @pspm_bf_scrf, 'args', 1) ...
\end_layout

\begin_layout Plain Layout

    );
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% run GLM fitting procedure
\end_layout

\begin_layout Plain Layout

glm = pspm_glm(model, options);
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Create First-Level contrasts
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{par}
\end_layout

\end_inset

 Here we want to find out if there is a difference between neutral and aversive
 events.
 Therefore we compare event type 1 with event type 2.
 We are not interested event type 3.
 This results in the contrast [1 -1 0].
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{par}
\end_layout

\end_inset

 
\begin_inset VSpace 1em
\end_inset

 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

% Set path to modelfile
\end_layout

\begin_layout Plain Layout

modelfile = [tutorial_data filesep sprintf('glm_%i', subject)];
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

% Call contrasts function (function has no output)
\end_layout

\begin_layout Plain Layout

pspm_con1(modelfile, {'neutral vs.
 aversive'}, {[1 -1 0]});
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Export parameter estimates
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{par}
\end_layout

\end_inset

 If we are interested to do further analysis on the parameter estimates
 we can export them to the screen or to a file.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
end{par}
\end_layout

\end_inset

 
\begin_inset VSpace 1em
\end_inset

 
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

% export parameter estimates to screen
\end_layout

\begin_layout Plain Layout

pspm_exp(modelfile, 'screen', 'param');
\end_layout

\end_inset


\end_layout

\begin_layout Part
How to reference PsPM
\end_layout

\begin_layout Standard
To justify our continued effort in the face of tight resources, we ask you
 acknowledge PsPM when you use it: 
\begin_inset Quotes eld
\end_inset

Data were analysed using PsPM [version number], available at 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://bachlab.org/pspm
\end_layout

\end_inset

.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
We suggest you reference our papers to justify your analysis steps and models
 in the following way:
\end_layout

\begin_layout Itemize
General PsPM reference: 
\end_layout

\begin_deeper
\begin_layout Itemize
Bach DR, & Friston KJ (2013).
 Model-based analysis of skin conductance responses: Towards causal models
 in psychophysiology.
 Psychophysiology, 50, 15-22.
\end_layout

\begin_layout Itemize
Bach DR, Castegnetti G, Korn CW, Gerster S, Melinscak F, Moser T (2018).
 Psychophysiological modelling - current state and future directions.
 Psychophysiology, 55, e13214.
\end_layout

\end_deeper
\begin_layout Itemize
GLM for SCR
\end_layout

\begin_deeper
\begin_layout Itemize
general reference: Bach DR, Flandin G, Friston KJ, & Dolan RJ (2009).
 Time-series analysis for rapid event-related skin conductance responses.
 Journal of Neuroscience Methods, 184, 224-234.
 
\end_layout

\begin_layout Itemize
canonical SCRF: Bach DR, Flandin G, Friston KJ, & Dolan RJ (2010).
 Modelling event-related skin conductance responses.
 International Journal of Psychophysiology, 75, 349-356.
\end_layout

\begin_layout Itemize
assumptions of the model: Gerster S, Namer B, Elam M, Bach DR (2018).
 Testing a linear time invariant model for skin conductance responses by
 intraneural recording and stimulation.
 Psychophysiology, 55, e12986.
\end_layout

\begin_layout Itemize
optimised filter settings: Bach DR, Friston KJ, Dolan RJ (2013).
 An improved algorithm for model-based analysis of evoked skin conductance
 responses.
 Biological Psychology, 94, 490-497.
 
\end_layout

\begin_layout Itemize
comparison with Ledalab and peak-scoring methods: Bach DR (2014).
 A head-to-head comparison of SCRalyze and Ledalab, two model-based methods
 for skin conductance analysis.
 Biological Psychology, 103, 63-88.
\end_layout

\end_deeper
\begin_layout Itemize
non-linear model for event-related SCR:
\end_layout

\begin_deeper
\begin_layout Itemize
general reference: Bach DR, Daunizeau J, Friston KJ, & Dolan RJ (2010).
 Dynamic causal modelling of anticipatory skin conductance responses.
 Biological Psychology, 85, 163-70.
\end_layout

\begin_layout Itemize
optimised filter settings: Staib M, Castegnetti G, Bach DR (2015).
 Optimising a model-based approach to inferring fear learning from skin
 conductance responses.
 Journal of Neuroscience Methods, 255, 131-138.
\end_layout

\begin_layout Itemize
optimised forward model for short SOA paradigms (see supplementary material):
 Tzovara A, Korn CW & Bach DR (2018).
 Human Pavlovian fear conditioning conforms to probabilistic learning.
 PLOS Computational Biology, 14, e1006243.
\end_layout

\end_deeper
\begin_layout Itemize
non-linear model for SF:
\end_layout

\begin_deeper
\begin_layout Itemize
general reference: Bach DR, Daunizeau J, Kuelzow N, Friston KJ, & Dolan
 RJ (2011).
 Dynamic causal modelling of spontaneous fluctuations in skin conductance.
 Psychophysiology, 48, 252-57.
\end_layout

\begin_layout Itemize
canonical SCRF: Bach DR, Friston KJ, & Dolan RJ (2010).
 Analytic measures for quantification of arousal from spontaneous skin conductan
ce fluctuations.
 International Journal of Psychophysiology, 76, 52-55.
\end_layout

\begin_layout Itemize
MP algorithm: Bach DR, Staib M (2015).
 A matching pursuit algorithm for inferring tonic sympathetic arousal from
 spontaneous skin conductance fluctuations.
 Psychophysiology, 52, 1106-12.
\end_layout

\end_deeper
\begin_layout Itemize
GLM for evoked HPR: Paulus PC, Castegnetti G, & Bach DR (2016).
 Modeling event-related heart period responses.
 Psychophysiology, 53, 837-846.
 
\end_layout

\begin_layout Itemize
GLM for fear-conditioned HPR: Castegnetti G, Tzovara A, Staib M, Paulus
 PC, Hofer N, & Bach DR (2016).
 Modeling fear-conditioned bradycardia in humans.
 Psychophysiology, 53, 930-939.
 
\end_layout

\begin_layout Itemize
GLM for evoked respiratory responses: Bach DR, Gerster S, Tzovara A, Castegnetti
 G (2016).
 A linear model for event-related respiration responses.
 Journal of Neuroscience Methods, 270, 147-155.
 
\end_layout

\begin_layout Itemize
GLM for fear-conditioned RAR: Castegnetti C, Tzovara A, Staib M, Gerster
 S, Bach DR (2017).
 Assessing fear memory via conditioned respiratory amplitude responses.
 Psychophysiology, 54, 215-223.
\end_layout

\begin_layout Itemize
GLM for illuminance-elicited PSR: Korn CW & Bach DR (2016).
 A solid frame for the window on cognition: Modeling event-related pupil
 responses.
 Journal of Vision, 16, 28.
 
\end_layout

\begin_layout Itemize
GLM for fear-conditioned PSR: Korn CW, Staib M, Tzovara A, Castegnetti G,
 Bach DR (2017).
 A pupil size response model to quantify fear conditioning.
 Psychophysiology, 54, 330-343.
\end_layout

\begin_layout Itemize
GLM for SEBR: Khemka S, Tzovara A, Gerster S, Quednow BB, Bach DR (2017).
 Modeling startle eyeblink electromyogram to assess fear learning.
 Psychophysiology, 54, 204-214.
\end_layout

\begin_layout Itemize
Comparison of different measures: Xia Y, Gurkina A & Bach DR (2019).
 Pavlovian-to-instrumental transfer after human threat conditioning.
 Learning & Memory, in press.
 
\end_layout

\begin_layout Part
Release notes
\end_layout

\begin_layout Section
PsPM Version 3.0
\end_layout

\begin_layout Subsection*
Import
\end_layout

\begin_layout Subsubsection*
New data types were implemented
\end_layout

\begin_layout Itemize
Noldus Observer compatible 
\end_layout

\begin_layout Itemize
Eyelink
\end_layout

\begin_layout Subsubsection*
Untested data types
\end_layout

\begin_layout Standard
CNT data import has not been not tested – please contact the developers
 with sample data files.
 
\end_layout

\begin_layout Subsection*
Filtering for SCR models
\end_layout

\begin_layout Standard
Previous versions of PsPM have used a bi-directional high pass filter of
 0.0159 for all SCR analyses.
 We have recently shown a better predictive validity for GLM with a unidirection
al filter of 0.05 Hz 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
 This also implies that different filters are used for different models.
 These are now set as defaults, and the way the default settings are implemented
 has changed.
 It is now possible to alter the filter settings in the model definition,
 although we discourage this.
\end_layout

\begin_layout Subsection*
New SF method
\end_layout

\begin_layout Standard
A matching pursuit algorithm is now implemented to approximate the number
 of spontaneous fluctuations (SF) in skin conductance 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2015aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection*
General linear modelling (GLM)
\end_layout

\begin_layout Subsubsection*
Parametric modulators
\end_layout

\begin_layout Standard
Parametric modulators (pmods) are z-normalised before being entered into
 the design matrix.
 This is to account for possibly very large or very small numbers – a badly
 scaled design matrix can cause induced instability in the inversion.
 The parameter estimates of the pmods were not transformed back in previous
 versions, i.
 e.
 the parameter estimates of the pmods were independent of the scaling of
 the pmods.
 This is appropriate as long as they are the same for all datasets, or if
 analysis is done strictly on a within-subject level.
 Some researchers have reported designs in which inference was to be drawn
 on parameter estimates of pmods on a between-group level, and where the
 pmods systematically differed between these groups.
 To account for this possibility, the parameter estimates are now transformed
 back, such that they refer to the pmods in their original scaling/units.
 
\end_layout

\begin_layout Subsubsection*
Parametric confounds
\end_layout

\begin_layout Standard
Previous versions of PsPM contained an option to include a parametric modulator
 across all event types, to account for confounds across all conditions.
 For example, in an experiment with 5 conditions, one could have included
 5 regressors, plus one reaction time confound across all events, without
 including an associated regressor that contains the event onsets for all
 these events.
 This option was removed.
 
\end_layout

\begin_layout Subsubsection*
Design matrix filtering
\end_layout

\begin_layout Standard
Previous versions of PsPM filtered the design matrix after orthogonalisation
 of basis sets.
 This can introduce unwanted dependencies between regressors.
 PsPM 3.0 filters the regressors first, then orthogonalises the basis sets.
\end_layout

\begin_layout Subsection*
File format
\end_layout

\begin_layout Standard
Some minor changes have been made to the data format.
 In particular, marker channels from previous versions can not be read with
 the current version - such data files have to be re-imported.
 Model files have changed drastically, and model files from previous versions
 can not be read with the current version of the software.
\end_layout

\begin_layout Subsection*
VB inversion
\end_layout

\begin_layout Standard
The VBA toolbox (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://mbb-team.github.io/VBA-toolbox/
\end_layout

\end_inset

) was updated in October 2014 
\begin_inset CommandInset citation
LatexCommand cite
key "Daunizeau:2014aa"
literal "true"

\end_inset

.
 This update incorporates bugfixes in this toolbox and slightly changed
 the model estimates in our test models.
 In terms of predictive validity, we noted that there was no consistent
 benefit of the old or new version of this code (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:VBA"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/Comparison_VBA.PNG
	scale 85

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Model comparison between old and new versions of the VBA toolbox, based
 on two delay fear conditioning datasets.
 The log Bayes factor quantifies the difference between negative log likelihood
 (nLL) of parameter estimates obtained from model inversion using the old
 and new version of VBA.
 A difference in nLL above 3 indicates significant differences in model
 evidence which is not exceeded for either data set.
 Analysis and figure contributed by Matthias Staib.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:VBA"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
PsPM Version 3.0.1
\end_layout

\begin_layout Subsection*
Import
\end_layout

\begin_layout Subsubsection*
New data types were implemented
\end_layout

\begin_layout Itemize
DATAQ Windaq (no ActiveX needed)
\end_layout

\begin_layout Itemize
European Data Format (EDF)
\end_layout

\begin_layout Subsection*
Tools
\end_layout

\begin_layout Standard
'Preprocess respiration traces' replaces 'Convert Respiration to Respiration
 Period'.
 It supports conversions into the following datatypes:
\end_layout

\begin_layout Itemize
Respiration preriod (old funtionality)
\end_layout

\begin_layout Itemize
Respiration amplitude
\end_layout

\begin_layout Itemize
Respiration line length
\end_layout

\begin_layout Itemize
Respiration time stamp
\end_layout

\begin_layout Subsection*
First level contrast
\end_layout

\begin_layout Subsubsection*
Z-score parameter estimates
\end_layout

\begin_layout Standard
The function 
\family typewriter
pspm_con1
\family default
 now supports z-scoring trial-by-trial parameter estimates.
 If selected, all parameter estimates for the same event type, across all
 trials, will be z-scored before computing the contrast.
 This option is currently only available for non-linear models.
\end_layout

\begin_layout Subsection*
Review first level model
\end_layout

\begin_layout Standard
Next to the regressors on the x- and y-axes, orthogonality plots newly display
 regressor names along the y-axes.
 
\end_layout

\begin_layout Section
PsPM Version 3.0.2
\end_layout

\begin_layout Subsection*
GLM
\end_layout

\begin_layout Standard
Problem with multiple sessions in Design matrix fixed.
\end_layout

\begin_layout Section
PsPM Version 3.1
\end_layout

\begin_layout Subsection*
General linear modelling (GLM)
\end_layout

\begin_layout Subsubsection*
New modalities
\end_layout

\begin_layout Standard
For the first time in PsPM, we introduce models for data types other than
 SCR:
\end_layout

\begin_layout Itemize
GLM for evoked HPR
\end_layout

\begin_layout Itemize
GLM for fear-conditioned HPR
\end_layout

\begin_layout Itemize
GLM for evoked RA
\end_layout

\begin_layout Itemize
GLM for fear-conditioned RA
\end_layout

\begin_layout Itemize
GLM for evoked RFR
\end_layout

\begin_layout Itemize
GLM for evoked RP
\end_layout

\begin_layout Itemize
GLM for fear-conditioned PS
\end_layout

\begin_layout Subsection*
Tools & Data preprocessing
\end_layout

\begin_layout Standard
Tools are split up into Tools & Data preprocessing.
 The content of each section is listed below.
 New functions are written in 
\color green
green
\color inherit
.
\end_layout

\begin_layout Subsubsection*
Tools
\end_layout

\begin_layout Itemize
Display data
\end_layout

\begin_layout Itemize
Rename file
\end_layout

\begin_layout Itemize
Split sessions
\end_layout

\begin_layout Itemize
Artefact removal
\end_layout

\begin_layout Itemize
Downsample data
\end_layout

\begin_layout Itemize
Interpolate missing data
\end_layout

\begin_layout Itemize

\color green
Extract segments
\end_layout

\begin_layout Itemize

\color green
Segment mean
\end_layout

\begin_layout Subsubsection*
Data preprocessing
\end_layout

\begin_layout Itemize

\color green
Preprocess heart data
\end_layout

\begin_layout Itemize

\color green
Preprocess respiration data
\end_layout

\begin_layout Itemize

\color green
Prepare illuminance GLM
\end_layout

\begin_layout Itemize

\color green
Find valid fixations
\end_layout

\begin_layout Itemize

\color green
Convert pupil data
\end_layout

\begin_layout Itemize

\color green
Find startle sound onsets
\end_layout

\begin_layout Subsection*
Data preparation
\end_layout

\begin_layout Subsubsection*
Import
\end_layout

\begin_layout Standard
Support for Philips Scanphyslog files and for bioread-converted AcqKnowledge
 files has been added to the import function.
\end_layout

\begin_layout Section
PsPM Version 4.0
\end_layout

\begin_layout Subsection*
Change from scr_ to pspm_
\end_layout

\begin_layout Standard
The prefix scr_ has been exchanged with pspm_.
 This applies to all functions contained in PsPM.
\end_layout

\begin_layout Subsection*
Updated toolboxes
\end_layout

\begin_layout Standard
Matlabbatch (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://git.code.sf.net/p/matlabbatch/code-git
\end_layout

\end_inset

) and the VBA toolbox (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/MBB-team/VBA-toolbox
\end_layout

\end_inset

) were updated to the latest available versions (08.11.2016).
 The updated VBA version fully supports newer Matlab versions and warning
 messages in Matlab 2014 and newer do not appear anymore (during PsPM startup).
 In terms of predictive validity, we noted that there was no consistent
 benefit of the old or new version of this code (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:VBA_compare_3.2"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Figures/Comparison_VBA.PNG
	lyxscale 75

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:VBA_compare_3.2"

\end_inset

Model comparison between old and new versions of the VBA toolbox, based
 on one delay fear conditioning dataset (Dataset 2, see earlier comparison).
 The log Bayes factor quantifies the difference between negative log likelihood
 (nLL) of parameter estimates obtained from model inversion using the old
 and new version of VBA.
 A difference in nLL above 3 indicates significant differences in model
 evidence which is not exceeded for the used dataset.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Subsessions in DCM models
\end_layout

\begin_layout Standard
Until now, long periods of NaN values (which are just disregarded) could
 cause problems for inversion of DCMs.
 These periods are now split (according to threshold value) into subsessions.
 The subsessions will be evaluated independently, while at the end the results
 will be stacked together.
 Therefore the output-format will not change and should be compatible with
 earlier releases.
\end_layout

\begin_layout Subsection*
Import
\end_layout

\begin_layout Subsubsection*
New import function for Labchart files
\end_layout

\begin_layout Standard
The new import function allows direct import of raw labchart files without
 exporting them to a suitable format (as was required to date).
 The function is only available on Windows systems.
\end_layout

\begin_layout Subsection*
General linear modeling (GLM)
\end_layout

\begin_layout Subsubsection*
New modalities
\end_layout

\begin_layout Itemize
Startle eyeblink for EMG (SEB)
\end_layout

\begin_layout Subsection*
Pupil Models
\end_layout

\begin_layout Itemize
Blink channels were removed.
 Periods during blinks and saccades are set to NaN already in the import
 function.
 This applies to all channels of the respective eye.
 Accordingly, blink validation functionality was removed in the function
 pspm_find_valid_fixations.
 If needed, blinks and saccades can be imported as custom channels using
 channel ids 7-10 (two eyes) or 4-5 (one eye), while blinks and left eye
 come first.
\end_layout

\begin_layout Itemize
Importing pupil channels now allows direct specification of a transfer function
 to convert arbitrary units to mm.
 
\end_layout

\begin_layout Itemize
Importing of eyes which have not been recorded creates channels containing
 NaN values, so that the same import batches can be used for groups of subjects,
 even if one eye is missing in some of them.
\end_layout

\begin_layout Itemize
Sessions in eyelink files (caused by interruption of recording) will be
 concatenated according to the timing variable.
\end_layout

\begin_layout Itemize
In pspm_find_valid_fixations 
\end_layout

\begin_deeper
\begin_layout Itemize
the use of software aspect ratio was replaced by resolution.
 This allows to correctly map the gaze coordinates to the shapes mapped
 by the stimulus software.
\end_layout

\begin_layout Itemize
gaze coordinates can be plotted in order to verify the validation settings.
\end_layout

\begin_layout Itemize
interpolation option was removed and should now be used independently.
\end_layout

\end_deeper
\begin_layout Subsection*
Minor changes & Bugfixes
\end_layout

\begin_layout Itemize
Version-Check bug during startup is now fixed.
\end_layout

\begin_layout Itemize
Markerinfos will now according to marker channels be converted to an event-based
 format.
\end_layout

\begin_layout Itemize
The data editor (pspm_data_editor) now allows to specify an output file
 using the command line.
\end_layout

\begin_layout Itemize
pspm_split_sessions additionally allows to specify marker ids at which the
 file should split.
\end_layout

\begin_layout Itemize
Artefact correction was extended with a further function (Simple SCR quality
 correction).
\end_layout

\begin_layout Itemize
Convert pupil data becomes convert data and currently only allows area to
 diameter conversion (arbitrary units to mm is integrated in the import
 function)
\end_layout

\begin_layout Section
PsPM Version 4.0.1
\end_layout

\begin_layout Subsection*
Bugfixes
\end_layout

\begin_layout Itemize
Fix not working options in Matlabbatch module 'Preprocess heart data'
\end_layout

\begin_layout Section
PsPM Version 4.0.2
\end_layout

\begin_layout Subsection*
Bugfixes
\end_layout

\begin_layout Itemize
Fix error when calling 'Convert data' from GUI
\end_layout

\begin_layout Itemize
Fix taking square root if pupil data is recorded in AREA
\end_layout

\begin_layout Section
PsPM Version 4.1.0
\end_layout

\begin_layout Subsection*
New Functions
\end_layout

\begin_layout Itemize

\family typewriter
pspm_convert_pixel2unit
\family default
: Allows to transfer gaze data from pixel to units.
 This facilitates the use of pspm_find_valid_fixations which needs data
 in unit values.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_compute_visual_angle
\family default
: Computes visual angle from gaze data.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_convert_visangle2sps
\family default
: Convert visual angles from Eyelink to Scanpath speed.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_bf_spsrf_box
\family default
: SPSRF basis function with box car.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_bf_spsrf_gamma
\family default
: SPSRF basis function with gamma function.
\end_layout

\begin_layout Subsection*
New Features
\end_layout

\begin_layout Itemize

\family typewriter
pspm_extract_segments
\family default
 supports DCM files/structures.
\end_layout

\begin_layout Itemize
GLM for SPS.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_find_valid_fixations
\family default
 can now take a bitmap as input.
\end_layout

\begin_layout Itemize
A new way to trim data: Start and end times can be chosen according to marker
 name or value.
\end_layout

\begin_layout Itemize
A new function to import SMI iView X EyeTracker files into PsPM.
\end_layout

\begin_layout Itemize
A new function to import ViewPoint EyeTracker files into PsPM.
\end_layout

\begin_layout Subsection*
Changes
\end_layout

\begin_layout Itemize

\family typewriter
pspm_find_valid_fixations
\family default
 now computes a circle around the fixation points when run in fixations
 mode.
\end_layout

\begin_layout Subsection*
Bugfixes
\end_layout

\begin_layout Itemize
Heart period response function (bf_hprf) coefficients are fixed according
 to the manual
\end_layout

\begin_layout Itemize

\family typewriter
pspm_extract_segments
\family default
 bugfixes:
\end_layout

\begin_deeper
\begin_layout Itemize
Fix bugs related to conditions appearing in different sessions.
\end_layout

\end_deeper
\begin_layout Itemize

\family typewriter
pspm_get_eyelink
\family default
 now imports markers between two recording sessions (previously these markers
 were 
\begin_inset Quotes eld
\end_inset

lost
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Itemize

\family typewriter
pspm_compute_visual_angle
\family default
: Fix bug in range computation.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_ecg2hb
\family default
: Fix out of bounds error occurring for highly noisy data with many outliers.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_get_acq
\family default
: Fix incorrect linear transformation during ACQ import.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_convert_unit
\family default
: Fix incorrect transformations between metric units and inches.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_resp_pp
\family default
: Fix out of bounds error during convolution in cushion mode.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_pp
\family default
 in 'simple_qa' mode now uses the default values specified in 
\family typewriter
pspm_simple_qa
\family default
.
\end_layout

\begin_layout Itemize
Various further bugfixes.
\end_layout

\begin_layout Subsection*
Improvements
\end_layout

\begin_layout Itemize
Blink and saccade channels can be imported with PsPM Eyelink import.
\end_layout

\begin_layout Itemize
GLM structure holds the missing data percentage of each condition after
 segment extraction.
 Further, the decision to exclude conditions can be made depending on the
 percentage of missing data.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_extract_segments
\family default
 now works both with GLM files and already loaded structures
\end_layout

\begin_layout Itemize
PsPM now checks if SPM is already in MATLAB path.
 If so, user is asked to remove it from path before initializing PsPM.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_load1
\family default
 now returns statistics about conditions with high NaN ratios.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_extract_segments
\family default
 now is able to use data stored in GLM/DCM structures instead of relying
 the existence of original data files.
\end_layout

\begin_layout Itemize
Multiple new tests to validate the correctness of the functions.
\end_layout

\begin_layout Section
PsPM Version 4.1.1
\end_layout

\begin_layout Standard
This is a hotfix release that fixes a few issues with 4.1.0 release.
\end_layout

\begin_layout Subsection*
Changes
\end_layout

\begin_layout Itemize

\family typewriter
pspm_get_eyelink
\family default
 now uses the scaling factor from 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

 for area based arbitrary units to milimeters conversion.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_get_smi
\family default
 does not perform pixel to milimeters conversion for pupil data anymore.
 Pupil values are returned as is in pixel units.
\end_layout

\begin_layout Itemize
pspm_get_smi performs pixel to milimeters conversion for gaze data only
 if the stimulus resolution in pixels are given as an extra option.
\end_layout

\begin_layout Subsection*
Improvements
\end_layout

\begin_layout Itemize

\family typewriter
pspm_get_viewpoint
\family default
 is now able to import blink and saccade channels from sample files as well.
 In order to enable this feature, event files must be stored asynchronously
 in the datafile.
 See ViewPoint EyeTracker section in this manual for further information.
\end_layout

\begin_layout Section
PsPM Version 4.2.0
\end_layout

\begin_layout Subsection*
New Functions
\end_layout

\begin_layout Itemize
A new pupil data preprocessing function
\end_layout

\begin_layout Itemize
A new pupil foreshortening error correction function
\end_layout

\begin_layout Itemize
A new QRS detection algorithm for fMRI environments
\end_layout

\begin_layout Subsection*
New Features
\end_layout

\begin_layout Itemize
Previously, Eyelink import used to discard 50 ms worth of samples from each
 side of every blink or saccade period.
 This behaviour is preserved; however, sample discard duration can now be
 set by the user.
\end_layout

\begin_layout Itemize
Channel processing functions now store extensive historical data in PsPM
 files.
 This data can be printed in table format using the new utility 
\family typewriter
function pspm_format_history_from_file
\end_layout

\begin_layout Itemize
Pupil channel is now loaded according to a new precedence order.
 Refer to GLM documentation in this manual to learn more.
\end_layout

\begin_layout Subsection*
Changes
\end_layout

\begin_layout Itemize
Eyelink import now returns times and dates in a slightly different format.
\end_layout

\begin_layout Itemize
Newest version of PsPM is now obtained from the version string in pspm.sourceforg
e.net, not from the download link zip file name
\end_layout

\begin_layout Itemize
GLM now uses the 
\series bold
LAST
\series default
 channel of a specified modality in a PsPM file.
\end_layout

\begin_layout Itemize
Nonlinear SCR model (DCM) now does not use the inter-trial interval duration
 value (ITI) of the last trial when computing session specific minimum ITI
 values.
 Previously, using these last ITI values would lead to abnormally small
 overall min ITI values in some input files, thereby causing the inference
 and PCA sections to use less data for all trials.
 Now, we prevent this from happening.
\end_layout

\begin_layout Itemize
Eyelink import parameter blink/saccade edge discard factor default value
 has been set to 0.
 This means no extra samples are discarded around blinks/saccades.
\end_layout

\begin_layout Subsection*
Bugfixes
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
pspm_extract_segments
\family default
 where trial onsets were not assigned to conditions correctly
\end_layout

\begin_layout Itemize
Fix a bug in Viewpoint import where files in DOS format were being parsed
 incorrectly
\end_layout

\begin_layout Itemize
Fix a bug in Eyelink import where blink/saccade periods where misaligned,
 causing the function to discard useful data and return noise instead
\end_layout

\begin_layout Subsection*
Improvements
\end_layout

\begin_layout Itemize
New utility functions to make PsPM more compatible across different operating
 systems
\end_layout

\begin_layout Itemize
An optimized Eyelink import function that is significantly faster and more
 memory efficient than previous versions
\end_layout

\begin_layout Itemize
An optimized SMI event import function that is significantly faster than
 the previous version
\end_layout

\begin_layout Itemize
Multiple new tests to validate the correctness of the functions
\end_layout

\begin_layout Itemize
API unification: Now all preprocessing functions use 
\family typewriter
channel_action
\family default
 variable to choose what to do with the new channel.
\end_layout

\begin_layout Section
PsPM Version 4.2.1
\end_layout

\begin_layout Subsection*
New Functions
\end_layout

\begin_layout Itemize
Three new tests (pspm_hb2hp_test.m, pspm_filtfilt_test.m, pspm_butter_test.m)
\end_layout

\begin_layout Subsection*
Changes
\end_layout

\begin_layout Itemize

\family typewriter
pspm_display
\family default
 and 
\family typewriter
pspm_ecg_editor
\family default
 do not perform filtering anymore.
\end_layout

\begin_layout Itemize
Treatment of missing data in DCM is now the same regardless of whether they
 are specified as NaN or via model.missing.
\end_layout

\begin_layout Itemize
Eyelink import parameter blink/saccade edge discard factor default value
 has been set to 0.
 This means no extra samples are discarded around blinks/saccades.
\end_layout

\begin_layout Subsection*
Bugfixes
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
pspm_hb2hp
\family default
 where the function crashed when there is no heartbeat left after lower
 and upper bound filtering of the heartbeat periods
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
import_eyelink
\family default
 which imported more markers than the number of markers in the actual .asc
 file
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
pspm_display
\family default
 which crashed when trying to plot ECG signal that contains NaN
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
pspm_prepdata
\family default
 which returned only NaN when input signal contained some NaN values
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
pspm_version
\family default
 which crashed when MATLAB was invoked with 
\family typewriter
-nojvm
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
pspm_get_viewpoint
\family default
 which returned '+,=,+' lines in the marker list and which crashed when
 given a viewpoint data file containing multiple sessions separated with
 '+,=' type of markers
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
import_viewpoint
\family default
 which created a new session for every marker containing a '+' somewhere,
 e.g.: 'CS+'
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
pspm_get_events
\family default
 which was not able to locate a marker if it occured on the first or last
 sample in a given datafile
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
pspm_filtfilt
\family default
 which crashed when the filter parameters were of dimension one
\end_layout

\begin_layout Section
PsPM Version 4.3.0
\end_layout

\begin_layout Subsection*
New Features
\end_layout

\begin_layout Itemize
In 
\family typewriter
pspm_get_events
\family default
, 
\family typewriter
import.flank
\family default
 can be now set to 
\family typewriter
'all'
\family default
 what would import all markers and data related to them.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_display 
\family default
allows now to display pupil size units and the gaze x & y coordinate units
 on the y-axis.
\end_layout

\begin_layout Itemize

\family typewriter
pspm_extract_segments 
\family default
can be used now with raw data and thus be called easily within another function.
\end_layout

\begin_layout Subsection*
Changes
\end_layout

\begin_layout Itemize

\family typewriter
pspm_version
\family default
 has a new url and thus do not send any warning about version checks anymore.
\end_layout

\begin_layout Itemize

\family typewriter
import_eyelink
\family default
 do not import markers which are outside the session end time (
\family typewriter
END
\family default
 marker).
\end_layout

\begin_layout Itemize

\family typewriter
import_eyelink
\family default
 sends a warning whenever two markers have the same timestamp.
\end_layout

\begin_layout Itemize
In 
\family typewriter
pspm_get_eyelink
\family default
, 
\family typewriter
import.flank
\family default
 set to 
\family typewriter
'all'
\family default
.
\end_layout

\begin_layout Itemize
The test of 
\family typewriter
pspm_extract_segments
\family default
 was adapted to the new feature.
\end_layout

\begin_layout Itemize
External functions and libraries were regrouped in one folder called 
\family typewriter
ext.
\end_layout

\begin_layout Subsection*
Bugfixes
\end_layout

\begin_layout Itemize
Fix a bux in 
\family typewriter
pspm_bf_lcrf_gm
\family default
 and 
\family typewriter
pspm_bf_ldrf_gm
\family default
 where the offset was wrongly implemented.
\end_layout

\begin_layout Itemize
Fix a bug in 
\family typewriter
pspm_compute_visual_angle
\family default
 where there was an error in the conversion factor of pixels wrt.
 to mm.
\end_layout

\begin_layout Part
Acknowledgements
\end_layout

\begin_layout Standard
SCRalyze versions 1-2 were developed at the FIL, Wellcome Trust Centre for
 Neuroimaging, University College London, under the auspices of Karl J.
 Friston and Raymond J.
 Dolan.
 Guillaume Flandin contributed to GLM, and Jean Daunizeau to DCM.
 Eric Featherstone, Alfonso Reid, Oliver Josephs, and Chloe Hutton helped
 with the import functions.
 This development was funded by the Swiss National Science Foundation with
 a personal grant to Dominik R.
 Bach, and by the Wellcome Trust with a programme grant to Raymond J.
 Dolan.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
PsPM 3.0 was developed at the University of Zurich, funded by the University
 of Zurich and by the Swiss National Science Foundation with a project grant.
 The Matlabbatch GUI was written by Gabriel Gräni at University of Zurich.
 Help texts and tutorial were developed by Christoph Korn and Matthias Staib.
 The data display was written by Philipp C Paulus, University of Dresden.
 The test environment was contributed by Linus Rüttimann, and extended by
 Tobias Moser, both University of Zurich.
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
Various models have been developed by different researchers.
 These are:
\end_layout

\begin_layout Itemize
Dominik R.
 Bach: SCR models and GLM for evoked respiratory responses
\end_layout

\begin_layout Itemize
Matthias Staib: Optimisation of non-linear SCR model
\end_layout

\begin_layout Itemize
Philipp Paulus: GLM for evoked HPR
\end_layout

\begin_layout Itemize
Giuseppe Castegnetti: GLM for fear-conditioned HPR and RAR
\end_layout

\begin_layout Itemize
Christoph Korn: PSM models
\end_layout

\begin_layout Itemize
Saurabh Khemka: GLM for SEBR
\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
Some PsPM functions depend on external scripts/libraries implemented by
 other groups:
\end_layout

\begin_layout Itemize
For import of spike data, PsPM makes use of the SON library written by Malcolm
 Lidierth at King's College London, and of functions provided by the SPM
 physiology toolbox, written by Chloe Hutton and Eric Featherstone at the
 FIL.
\end_layout

\begin_layout Itemize
Biopac AcqKnowledge import uses a routine created by Sebastien Authier and
 Vincent Finnerty at the University of Montreal.
\end_layout

\begin_layout Itemize
The DCM inversion uses a variational Bayesian inversion scheme written by
 Jean Daunizeau.
\end_layout

\begin_layout Itemize
Some SCR quality control functions use the method described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Kleckner:2017a"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Pupil preprocessing uses external scripts adapted from the implementations
 by Mariska Kret and Elio Sjak-Shie at 
\begin_inset Newline newline
\end_inset


\begin_inset CommandInset href
LatexCommand href
name "https://github.com/ElioS-S/pupil-size"
target "https://github.com/ElioS-S/pupil-size"
literal "false"

\end_inset

.
 The original reference is 
\begin_inset CommandInset citation
LatexCommand cite
key "kret2018preprocessing"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Pupil foreshortening error correction implements the method proposed in
 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

 by Taylor Hayes and Alexander Petrov.
\end_layout

\begin_layout Itemize
QRS detection for fMRI environment uses external scripts adapted from the
 code by Zhongming Liu, Jacco A de Zwart, Peter van Gelderen, Li-Wei Kuo,
 and Jeff H Duyn at 
\begin_inset CommandInset href
LatexCommand href
name "https://www.amri.ninds.nih.gov/software.html"
target "https://www.amri.ninds.nih.gov/software.html"
literal "false"

\end_inset

.
 The original reference is 
\begin_inset CommandInset citation
LatexCommand cite
key "liu2012statistical"
literal "false"

\end_inset

.
\end_layout

\begin_layout Part
References
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "PsPM"
options "pnas2009"

\end_inset


\end_layout

\end_body
\end_document
