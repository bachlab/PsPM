#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{stmaryrd}
\usepackage[svgpath=./Figures]{svg}
\usepackage{graphicx}
\definecolor{colKeys}{rgb}{0,0,1}
\definecolor{colIdentifier}{rgb}{0,0,0}
\definecolor{colComments}{rgb}{0.53, 0.66, 0.42}
\definecolor{colString}{rgb}{0.87, 0.36, 0.51}
\definecolor{barColor}{rgb}{0.43, 0.5, 0.5}
% Added by lyx2lyx
\renewcommand{\textendash}{--}
\renewcommand{\textemdash}{---}
\usepackage{bera}
\renewcommand*\l@subsection{\@dottedtocline{2}{1.8em}{3.2 em}}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
customHeadersFooters
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command bibtex
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 0
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 0
\use_package mhchem 1
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle headings
\listings_params "language=Matlab,float=hbp,basicstyle={\footnotesize\ttfamily},identifierstyle={\color{colIdentifier}},keywordstyle={\color{colKeys}},stringstyle={\color{colString}},commentstyle={\itshape\color{colComments}},columns=fixed,tabsize=2,extendedchars=true,showspaces=false,showstringspaces=false,captionpos=t,backgroundcolor={\color{white}},framexleftmargin=1pt,frame=l"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
PsPM: Psychophysiological Modelling
\end_layout

\begin_layout Standard
\align center
Version 7.0
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center
by the PsPM team
\begin_inset Foot
status open

\begin_layout Plain Layout
\noindent
If you have comments on or error corrections to this documentation, please
 send them to the PsPM team, 
\family typewriter
pspm@bachlab.org
\family default
, or post them on: 
\begin_inset CommandInset href
LatexCommand href
name "Github"
target "https://github.com/bachlab/PsPM/discussions"
literal "false"

\end_inset


\end_layout

\end_inset


\size larger
:
\end_layout

\begin_layout Standard
\align center
Dominik R Bach, Giuseppe Castegnetti, Laure Ciernik, Samuel Gerster, Uzay
 Gökay, Saurabh Khemka, Christoph Korn, Samuel Maxwell, Tobias Moser, Philipp
 C Paulus, Ivan Rojkov, Matthias Staib, Bernhard Agoué von Raußendorf, Yanfang
 Xia, Eshref Yozdemir, Dadi Zhao, and collaborators
\end_layout

\begin_layout Standard
\align center
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Part
Background
\end_layout

\begin_layout Section
What is psychophysiological modelling?
\end_layout

\begin_layout Subsection
The psychophysiological inverse problem
\end_layout

\begin_layout Standard
Psychophysiology is concerned with the relationship between the mind (i.e.
 psychological processes) and the body (including the nervous system).
 This relationship is bidirectional: the mind influences the body, and the
 body is monitored by the mind via proprioception and interoception.
 
\end_layout

\begin_layout Standard
A very common application of psychophysiological knowledge is to evaluate
 processes in the mind by their influence on the body.
 For example, we may observe skin conductance responses in order to infer
 a person's fear memory.
 This is an inverse problem.
 We are not actually interested whether skin conductance is different between
 a CS+ and a CS- (the forward relation).
 We are interested, in this example, in whether a person successfully learned
 the association between a conditioned stimulus (CS) and an electric shock,
 and we use skin conductance to tap into this latent variable.
 To make this inverse inference, we 
\begin_inset Quotes eld
\end_inset

turn the forward model around
\begin_inset Quotes erd
\end_inset

 - we ask, what has happened in the mind, given what is measured in the
 body.
 There are several way of doing this, and all require good knowledge of
 the forward relation.
 
\end_layout

\begin_layout Subsection
Operational analysis
\end_layout

\begin_layout Standard
Operational approaches leverage data features that closely follow a latent
 variable of interest.
 Operational data analysis algorithms extract these data features, to 
\begin_inset Quotes eld
\end_inset

index
\begin_inset Quotes erd
\end_inset

 latent variables.
 For example, to infer fear memory from skin conductance responses (SCR),
 one may filter the SCR data to reduce observation noise, define a response
 window after the CS, define some criteria to detect peaks within this window,
 and a scoring algorithm to deal with overlapping SCR.
 The amplitude of such peaks may then be taken as 
\begin_inset Quotes eld
\end_inset

index
\begin_inset Quotes erd
\end_inset

 of SA.
 The development of these indices is an important application of psychophysiolog
y.
 Such indices are usually based on qualitative or semi-quantitative models
 of how the index relates to the latent variable.
 Model-based analysis has precisely the same goal as operational analysis
 - but seeks to make these implicit models explicit (i.e.
 testable) in mathematical form - see 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013ab"
literal "true"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach2018:aa"
literal "false"

\end_inset

 for reviews.
\end_layout

\begin_layout Subsection
Model-based analysis 
\end_layout

\begin_layout Standard
Model-based approaches start with explicit, mathematical models that formulate
 how observed data are generated by psychological processes.
 For example, a model may formulate the relation between fear-conditioned
 sympathetic arousal (SA) and skin conductance responses (SCR), 
\begin_inset Formula $SA\mapsto SCR$
\end_inset

, in mathematical form.
 This kind of model is often termed a "forward model": it predicts a data
 time series (SCR) from a known psychological process (SA).
 Another term for this kind of model is 
\begin_inset Quotes eld
\end_inset

generative
\begin_inset Quotes erd
\end_inset

, because it describes how a latent variable generates the data.
 When we analyse experimental data, we are faced with the opposite situation:
 we know the observed data data but not the latent variable, and seek to
 infer the latent variable from the data.
 In order to do so, we have to turn the forward model backwards, to arrive
 at the relation 
\begin_inset Formula $SA\mapsfrom SCR$
\end_inset

.
 In statistics, this process is often termed "model inversion".
 It provides the most likely estimate of the latent variable, given the
 observed data and the model.
 
\end_layout

\begin_layout Section
Method comparison
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
How can we evaluate whether one method of inferring a latent variable is
 better than another, when the true values of the latent variable are unknown?
 Classical validity theory provides us with metrics such as reliability
 or convergent/discriminant validity, but these require stable between-person
 variance in the latent variable to be meaningful 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2024aa"
literal "false"

\end_inset

, a condition which is frequently not met for those latent variables that
 can be inferred from psychophysiological measurements (such as fear memory).
 Furthermore, convergent validity frequently does not tell us which of a
 set of somewhat related measurement methods is more or less valid (such
 as two slightly different SCR scoring methods).
\end_layout

\begin_layout Standard
The solution we propose is to experimentally induce known values of the
 latent variable, and evaluate how well a method recovers these known states
 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2020aa"
literal "false"

\end_inset

.
 We term this approach
\begin_inset Quotes erd
\end_inset

experiment-based calibration
\begin_inset Quotes erd
\end_inset

, and the correlation between measured and intended scores 
\begin_inset Quotes eld
\end_inset

retrodictive validity
\begin_inset Quotes erd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2020ab"
literal "false"

\end_inset

.
 One can show that measurement methods with higher retrodictive validity
 have lower measurement error.
 Thus, retrodictive validity is the metric that we seek to maximise with
 PsPM.
\end_layout

\begin_layout Standard
In the example of fear conditioning, we could express retrodictive validity
 simply as effect size of the CS+/CS- difference in the estimates; the method
 with higher effect sizes will have lower measurement error.
 Since we are assessing this in finite samples, a frequent follow-up question
 is whether one method is 
\begin_inset Quotes eld
\end_inset

decisively
\begin_inset Quotes erd
\end_inset

 more valid than another.
 This can be assessed with a formal model comparison.
 
\end_layout

\begin_layout Subsection
Implementation
\end_layout

\begin_layout Standard
In our example, we can try to predict CS identity (CS+/CS-) from the model
 estimates.
 This means we quantify evidence for a model in which individual participants'
 CS+ and CS- estimates are drawn from two distributions with different means,
 rather than the same mean.
 In other words, we are using a regression model that seeks to predict the
 known latent variable (i.e.
 the experimental conditions) as dependent variable from the estimated latent
 variable.
 Note that this is different from a more conventional regression or ANOVA
 model in which the data are the dependent variable and experimental conditions
 are the independent variable.
 This difference is important.
 In our approach, the dependent variable (the true state) will always be
 the same, and the independent variable (the estimate of the latent variable)
 will differ between methods.
 This means that the total sum of squares (TSS) in the model will be constant.
 Thus, we can use the residual sum of squares (RSS) to compute model evidence
 and compare models - i.e.
 compare evidence for the statement that the method's estimates of the psycholog
ical state predict the true psychological state.
 
\end_layout

\begin_layout Standard
To quantify model evidence, we often use the following approximation to
 Akaike Information Criterion (AIC) 
\begin_inset CommandInset citation
LatexCommand cite
key "Burnham:2004"
literal "true"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
AIC=n\log\left(RSS/n\right)+2k=-2\log\left(L\right)+2k,
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $n$
\end_inset

 is the number of data points in the predictive model, 
\begin_inset Formula $L$
\end_inset

 is the maximum of the likelihood function, and 
\begin_inset Formula $k$
\end_inset

 the number of parameters in the predictive model.
 
\begin_inset Formula $k$
\end_inset

 is constant for all methods that are evaluated in a methods comparison.
 We only interpret AIC differences, so this complexity term disappears from
 methods comparison.
 AIC differences divided by 2 can be interpreted as approximate log Bayes
 Factors (LBF).
 In our case this quantifies the relative evidence that one method's estimates
 predict the true latent variable, relative to the other method.
 An absolute LBF of greater than 3 is usually regarded as decisive.
 This is because for a classical significance threshold of 
\begin_inset Formula $\alpha=.05$
\end_inset

, the probability of the data given the null hypothesis is 
\begin_inset Formula $p<.05$
\end_inset

.
 Similarly, for an LBF difference larger than 3, the relative probability
 that the inferior method predicts the true psychological state given the
 data is 
\begin_inset Formula $p<\exp\left(-3\right)\approx0.05$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Penny:2004aa"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Standard
All methods included in PsPM have empirically been shown to provide better
 or equal retrodictive validity than the best available corresponding convention
al index.
 Although in most validation experiments only two conditions need to be
 distinguished (a discrimination problem), the goal of PsPM is to provide
 minimum-variance estimates of a latent variable also in situations in which
 the latent variable varies across more than just two levels.
 Of course, this approach to method comparison can also be used to improve
 operational indices, or event to create new indices in a blind classification
 approach based on large data sets.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
Historical remark:
\shape default
 Some papers from the PsPM team have used the formula: 
\begin_inset Formula $NLL=n\log\left(RSS/n\right)$
\end_inset

.
 If NLL is read as an arbitrary variable name, this formula is consistent
 with the previous paragraphs.
 However, note that NLL in this formula is not the negative log likelihood
 (as confusingly implied in the papers), but really the AIC without complexity
 correction.
 The numerical value of the negative log likelihood would in this terminology
 be 
\begin_inset Formula $NLL/2$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Section
General model structure
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
All models in PsPM split the relation between mind and body into two models,
 a peripheral and a neural model.
 The peripheral model describes how a neural impulse is converted to a measurabl
e signal.
 The neural model describes the relation between the latent variable and
 the neural input into the peripheral system.
 This distinction is historically based on SCR models.
 The neural signal that elicits SCR can be measured by intraneural recordings
 
\begin_inset CommandInset citation
LatexCommand cite
key "Gerster:2017aa"
literal "false"

\end_inset

, and its properties are in principle known.
 Hence it appeared plausible for various research groups to create a peripheral
 model 
\begin_inset CommandInset citation
LatexCommand cite
key "Alexander:2005aa,Bach:2009aa,Benedek:2010ab"
literal "true"

\end_inset

 that takes an arbitrary neural input, and several neural models were then
 combined with this peripheral model.
 This distinction has later been used for other modalities, too: first because
 it appeared simple from a practical standpoint, secondly because it is
 often plausible to assume that the peripheral process is not directly influence
d by psychological states, but only via a neural input.
 Note, however, that the peripheral/neural distinction in the model implementati
on is not always consistent with biophysical reality and tends to follow
 a need for manageable inversion algorithms.
 Indeed, some models collapse peripheral and stereotypical neural processes
 into the peripheral model.
 Examples are the GLMs for fear-conditioned HPR, PSR, and RAR - this is
 unlike the non-linear SCR model in which parameters of the neural model
 are estimated explicitly.
\end_layout

\begin_layout Subsection
Peripheral models
\end_layout

\begin_layout Standard
The peripheral models in PsPM collapse all physiological and biophysical
 processes involved in the generation of the measured signal.
 For most psychophysiological measures, these processes are not known at
 the level of detail required to build true biophysical models from theory.
 In fact, biophysical models for the best-investigated modality, SCR, tend
 to not fit the observed data very well 
\begin_inset CommandInset citation
LatexCommand cite
key "Benedek:2010aa,Alexander:2005aa"
literal "true"

\end_inset

.
 This is why PsPM uses purely phenomenological models, which treat the periphera
l system as a black box.
 By applying controlled inputs into the system, and measuring the output,
 one can then approximate the workings of this black box in mathematical
 form, without knowing its content.
\end_layout

\begin_layout Subsubsection*
LTI systems
\end_layout

\begin_layout Standard
Crucially, all models in PsPM assume that the peripheral system can be described
 by one (or several) linear time invariant (LTI) systems with the defining
 properties linearity and time invariance.
 A LTI system is unambiguously described by its response function (RF).
 By linearity, input and output are linearly mapped so the responses to
 several inputs can be simply obtained by summing the responses to individual
 inputs.
 Time invariance means that the output does not explicitly depend on the
 time, i.e.
 that the shape of the RF is constant over time while the amplitude can
 vary.
 It is usually also assumed that the RF is constant over individuals, although
 this assumption is not necessary in the PsPM framework.
\end_layout

\begin_layout Standard
In principle, linearity ensures pure summation of two overlapping inputs.
 This is not realistic if the system has limited dynamic range and saturates
 due to a quick succession of inputs (e.
 g.
 the heart rate cannot increase indefinitely).
 One can formulate limits, for each data modality, within which the model
 is a useful approximation to reality.
 
\end_layout

\begin_layout Standard
For some modalities, the two properties linearity and time invariance can
 be explicitly tested by neural recordings (e.g.
 for SCR).
 For other modalities, this is not possible.
 
\end_layout

\begin_layout Standard
Mathematically, the output 
\begin_inset Formula $y\left(t\right)$
\end_inset

 of a LTI system can be fully described by convolving input 
\begin_inset Formula $u(t)$
\end_inset

 with the system’s response function 
\begin_inset Formula $h(t)$
\end_inset

 and can be written as 
\begin_inset Formula 
\[
y(t)=u(t)*h(t)=∫_{0}^{∞}u(t-τ)h(τ)dτ.
\]

\end_inset


\end_layout

\begin_layout Standard
This is the equation for a linear filter.
 
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\family typewriter

\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
 Note: 
\shape default
Convolution is more generally defined by integration over 
\begin_inset Formula $\mathbb{R}$
\end_inset

.
 Integrating over 
\begin_inset Formula $\mathbb{R}^{+}$
\end_inset

 (or alternatively, setting 
\begin_inset Formula $h\left(t\right)=0,\;t<0$
\end_inset

) ensures the causal structure of the model - only past inputs can have
 an effect only into the future, not future inputs into the past.
 It also reflects the implementation via Matlab's vector convolution function
 (
\family typewriter
conv
\family default
) in PsPM.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset

In many cases, the peripheral system is not exactly LTI but can be approximated
 by the combination of several LTI systems.
 The common case is the inclusion of RF derivatives to account for between-subje
ct variability in RF shape and latency, and a special case the combination
 of a dilation and a constriction RF in pupil size modelling.
 In our terminology, the RF then has 
\begin_inset Formula $k$
\end_inset

 
\begin_inset Quotes eld
\end_inset

components
\begin_inset Quotes erd
\end_inset

: 
\begin_inset Formula $h\left(t\right)=h_{1..k}\left(t\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
In such cases, the amplitude estimates for several response functions need
 to be combined.
 In PsPM, this is usually (unless indicated otherwise) done by multiplying
 each component of the RF with its amplitude estimate, and adding them.
 The peak of highest absolute amplitude is then identified, and its signed
 amplitude extracted as estimate of neural input amplitude.
\end_layout

\begin_layout Standard
Signal frequencies in the data that are not present in the RF do not contribute
 to the model inversion and can be filtered out.
 If the true RF were known, the matched filter theorem provides a way of
 theoretically deriving a filter that maximises the signal-to-noise ratio
 for the model inversion.
 In most cases, the true RF is not precisely known, and also varies between
 individuals.
 This is why PsPM seeks to empirically determine the filter characteristics
 that maximise retrodictive validity of psychological state estimates.
\end_layout

\begin_layout Subsection
Neural models
\end_layout

\begin_layout Standard
The neural model in PsPM describes the form of the neural input that the
 peripheral model can take, and thus, the relation between mind and neural
 system.
 In general, model inversion benefits from constraining the neural model,
 i.e.
 from reducing the number of parameters that have to be estimated.
 We have empirically shown for SCR models that in many cases, a strongly
 constrained neural model will result in higher retrodictive validity 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa,Bach:2014aa,Staib:2015aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
Most PsPM models assume an instantaneous (delta) neural input into the periphera
l system at a known time point 
\begin_inset Formula $t_{i}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u\left(t\right)=\delta\left(t_{i}\right).
\]

\end_inset

Only the amplitude of the neural input is then estimated, and is taken as
 estimate of the psychological state.
 This renders the model suitable for GLM inversion (see below).
 Less constrained models require non-linear inversion methods and can also
 deal with variable onset, dispersion, or shape, of the neural input.
 
\end_layout

\begin_layout Subsection
Model inversion
\end_layout

\begin_layout Subsubsection
Hierarchical summary statistic approach
\end_layout

\begin_layout Standard
It is common in psychophysiology (and psychology in general) to compute
 summary statistics for each cell of the design, and for each participant.
 These estimates of are then entered into a group-level model.
 To implement this approach, PsPM estimates parameters for each participant
 separately, either per experimental condition, or per trial.
 In line with fMRI terminology (and different from many branches of psychology),
 we use the terms 
\begin_inset Quotes eld
\end_inset

first-level
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

second-level
\begin_inset Quotes erd
\end_inset

 for the individual and group level.
\end_layout

\begin_layout Subsubsection
Multi-level modelling
\end_layout

\begin_layout Standard
Multi-level models, also termed linear mixed effects model (LME) or random-effec
t models, are becoming increasingly popular in psychology 
\color black

\begin_inset CommandInset citation
LatexCommand cite
key "Pinheiro:2000aa"
literal "true"

\end_inset

.
 The idea is to take variance between trials into account: a summary statistic
 that is computed from individual data points with high variance is less
 precise that a statistic from low-variance data, and such information is
 lost when averaging within each condition.
 PsPM offers the possibility to compute trial-by-trial estimates (by modelling
 each trial as a separate condition in GLM, or by default in DCM for SCR).
 This approach has been used for SCR, PSR and SEBR 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2017aa"
literal "true"

\end_inset

, see also 
\begin_inset CommandInset citation
LatexCommand cite
key "Homan:2017aa"
literal "false"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "Tzovara:2018aa"
literal "false"

\end_inset

.
 For GLM, modelling trial-by-trial amplitudes and averaging within conditions
 yields the same result as modelling condition-by-condition amplitudes,
 if the design matrix is of full rank and if there is only one basis function.
 With more than one basis function, the results will deviate for the second
 and further basis functions in the basis set, because the orthogonalisation
 with the basis set is a nonlinear operation.
\end_layout

\begin_layout Standard
In theory it would also be possible to account for variability within the
 time series, i.e.
 between data points, not only between trials.
 Such approaches are implemented for fMRI, but they are not trivial.
 First, model inversion is much slower by the inclusion of many subjects.
 Secondly, in the time-series data analysed in PsPM, errors are usually
 not independent.
 This is usually not a problem for parameter estimation but impacts on the
 effective degrees of freedom and thus renders statistical tests in these
 models invalid, and this would apply to multi-level models, too.
 fMRI softwares solve this problem by estimating an auto-regression model
 on the first level but this is usually done on data from many data channels/vox
els, and this is not possible for single-channel data in psychophysiology.
 This is why PsPM does not offer statistical tests on the time-series level.
 For the trial-wise or condition-wise summary statistic approach in PsPM,
 the dependencies between data points on the first level are unproblematic.
\end_layout

\begin_layout Subsubsection
Probabilistic model inversion
\end_layout

\begin_layout Standard
All peripheral and neural models in PsPM are approximations to reality.
 It is hence assumed that there is measurement error (imprecision of the
 peripheral model) 
\begin_inset Formula $\varepsilon$
\end_inset

 in the data, and that the neural input is not truthfully described by the
 neural model such that it contains latent error, 
\begin_inset Formula $\omega$
\end_inset

.
 While this distinction between 
\begin_inset Formula $\varepsilon$
\end_inset

 and 
\begin_inset Formula $\omega$
\end_inset

 is theoretically interesting and often physiologically plausible, the model
 inversion methods collapse these two sources of error:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
y\left(t\right)=\varepsilon\left(t\right)+\left[u\left(t\right)+\omega\left(t\right)\right]*h\left(t\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\varepsilon\left(t\right)+\omega\left(t\right)*h\left(t\right)+u\left(t\right)*h\left(t\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
=\epsilon\left(t\right)+u\left(t\right)*h\left(t\right).
\]

\end_inset


\end_layout

\begin_layout Subsubsection
General linear convolution model (GLM)
\begin_inset CommandInset label
LatexCommand label
name "subsec:General-linear-convolution"

\end_inset


\end_layout

\begin_layout Standard
Under the assumption of a delta neural model, we can harness GLM to estimate
 the neural input amplitude.
 A GLM can be written as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Y=Xβ+\epsilon.
\]

\end_inset

Here, 
\begin_inset Formula $Y$
\end_inset

 is the vector of observations (time series data), 
\begin_inset Formula $β$
\end_inset

 is a vector of input amplitude parameters and 
\begin_inset Formula $\epsilon$
\end_inset

 is the error.
 
\begin_inset Formula $X$
\end_inset

 is design matrix in which each column is obtained by convolving impulse
 functions at known time points (e.g.
 event onsets for one condition) with each component of the RF.
 Each column takes the form:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
X_{ij}\left(t\right)=u_{i}\left(t\right)*h_{j}\left(t\right),
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $u_{i}\left(t\right)$
\end_inset

 is the neural input with unit amplitude for condition 
\begin_inset Formula $i$
\end_inset

, and 
\begin_inset Formula $j$
\end_inset

 is the index of the RF component.
 Finally, 
\begin_inset Formula $X$
\end_inset

 also contains a column for the intercept.
 It is possible to concatenate data from different experimental sessions,
 and an intercept is modelled for each session.
 The maximum-likelihood amplitude estimates are then computed using the
 Moore-Penrose pseudoinverse 
\begin_inset Formula $X^{+}$
\end_inset

, implemented in the Matlab function 
\family typewriter
pinv
\family default
: 
\begin_inset Formula 
\[
\hat{β}=X^{+}Y.
\]

\end_inset


\end_layout

\begin_layout Standard
This allows to deal with situations in which 
\begin_inset Formula $X$
\end_inset

 is not of full rank.
\end_layout

\begin_layout Subsubsection
Non-linear model inversion
\end_layout

\begin_layout Standard
Models in which timing and/or dispersion of the neural input need to be
 estimated require non-linear model inversion.
 PsPM contains several efficient non-linear model inversion methods:
\end_layout

\begin_layout Itemize
a Variational Bayes (VB) algorithm 
\begin_inset CommandInset citation
LatexCommand cite
key "Daunizeau:2009aa"
literal "true"

\end_inset

 for dynamic systems.
 This can be applied either to an entire data set, or on a trial-by-trial
 basis, and requires the peripheral system to be written in the form of
 an ordinary differential equation (ODE).
\end_layout

\begin_layout Itemize
a Matching Pursuit algorithm that provides a fast approximation to the VB
 inversion for some models
\end_layout

\begin_layout Section
Skin conductance (SCR) models
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
SCR arise from opening of sweat glands and are elicited via the sympathetic
 nervous system with negligible parasympathetic transmission (see 
\begin_inset CommandInset citation
LatexCommand cite
key "boucsein:2012"
literal "true"

\end_inset

 for the physiology of SCR).
 Nerve fibres carrying impulses to the sweat glands are termed 
\begin_inset Quotes eld
\end_inset

sudomotor nerve
\begin_inset Quotes erd
\end_inset

 (SN) fibres and can be measured by intraneural recordings.
 SN fibres are slow C-fibres.
 From their end terminal, the neurotransmitter Acetylcholine diffuses through
 the skin to reach sweat glands, a process on the time scale of up to a
 second.
 
\end_layout

\begin_layout Standard
The frequency and amplitude of SCR is mainly influenced by psychological
 arousal.
 Because not all forms of psychological arousal may influence SCR in the
 same way, we term the relevant psychological state 
\begin_inset Quotes eld
\end_inset

sympathetic arousal
\begin_inset Quotes erd
\end_inset

 (SA).
 Hence, the PsPM model is 
\begin_inset Formula $SA\mapsto SN\mapsto SCR$
\end_inset

.
\end_layout

\begin_layout Subsection
Peripheral LTI model
\end_layout

\begin_layout Subsubsection
Model evaluation
\end_layout

\begin_layout Standard
The peripheral LTI model can be evaluated explicitly (by intraneural recordings
 or stimulation) and implicitly (by assessing properties of the model 
\begin_inset Formula $SA\mapsto SN\mapsto SCR$
\end_inset

, an approach that collapses LTI violations with imprecision in the neural
 model).
 
\end_layout

\begin_layout Paragraph*
Time invariance: the system's response does not explicitly depend on time,
 or in other words, a given input always produces the same output.
 
\end_layout

\begin_layout Itemize
Direct evidence: The amplitude of individual SN bursts is linearly related
 to the amplitude of ensuing SCR, with a considerable scatter 
\begin_inset CommandInset citation
LatexCommand cite
key "Bini:1980aa"
literal "true"

\end_inset

; to the maximal rate of sweat expulsion; and, somewhat more weakly, to
 the integrated sweat production during the skin response 
\begin_inset CommandInset citation
LatexCommand cite
key "Sugenoya:1990aa"
literal "true"

\end_inset

.
 After initial dishabituation, constant SN stimulation leads to SCR, with
 constant amplitude and latency 
\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1991aa"
literal "true"

\end_inset

.
 Repeated SN stimulation yields slightly different SCR shapes 
\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1992aa"
literal "true"

\end_inset

, although this could be due to variation in elicited neural responses that
 were not measured downstream.
 In summary, these findings are consistent with (but do not prove or disprove)
 the time invariance principle.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Gerster:2017aa"
literal "true"

\end_inset

 re-analysed data 
\color black
from an experiment in which brachial sudomotor neves were regularly stimulated
 under thoracic block and SCR recorded 
\color inherit

\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1991aa,Kirno:1991aa"
literal "true"

\end_inset


\color black
.
 They found that for stimulation rates below 0.6 s (1 stimulus every 1.7 s)
 around 95% of variance could be explained by an LTI model.
 
\end_layout

\begin_layout Itemize
Indirect evidence: We have shown that for short events (< 1 s duration)
 that are separated by at least 30 s, more than 60% of the variance in (high
 pass filtered) SCR can be explained under an LTI model, for aversive white
 noise bursts, aversive electric stimulation, aversive pictures, auditory
 oddballs, and a visual detection task 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

.
 Is this residual variance (40%) due to violations of the LTI assumptions?
 We have shown that in the absence of any event for 60 s, signal variance
 amounts to more than 60% of total variance during stimulus presentation.
 That is to say, by introducing events, residual baseline variance is reduced
 by 20%.
 This suggests that residual variance is not caused by violations of the
 time invariance assumption but variation of the neural input (for example,
 spontaneous fluctuations), and observation error.
 
\end_layout

\begin_layout Paragraph
Linearity: the system's response does not depend on previous inputs.
 
\end_layout

\begin_layout Itemize
Direct evidence: Latency of sweat expulsion is slightly shortened when sweat
 expulsion rate is very high (i.
 e.
 for very strong SN bursts) but not when SN firing is frequent 
\begin_inset CommandInset citation
LatexCommand cite
key "Sugenoya:1990aa"
literal "true"

\end_inset

.
 SCR to individual SN stimulations depend linearly on skin conductance level,
 and are slightly suppressed upon repetition of the stimulation after 1
 s 
\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1992ab"
literal "true"

\end_inset

.
 This suggests that the linearity principle does not hold under all conditions
\color black
.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Gerster:2017aa"
literal "true"

\end_inset

 
\color inherit
re-analysed data 
\color black
from an experiment in which brachial sudomotor neves were regularly stimulated
 under thoracic block and SCR recorded 
\color inherit

\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1991aa,Kirno:1991aa"
literal "true"

\end_inset


\color black
.
 They found that for stimulation rates above 0.6 s (1 stimulus every 1.7 s),
 the response function looked very different from lower frequencies, suggesting
 non-linearities at that stimulation frequency.
 They did not quantitatively characterise these non-linearities.
\end_layout

\begin_layout Itemize
Indirect evidence: The linearity principle amounts to saying that SCR are
 not influenced by the (preceding) baseline signal.
 We tested this assumption by presenting two subsequent aversive white noise
 bursts with an inter stimulus interval (ISI) of either 2 s, 5.5 s, or 9
 s, such that the baseline signal at these three time points differed markedly.
 Violations of the linearity principle in the peripheral system would imply
 that the amplitude of the subsequent response is dependent on the baseline
 signal, and thereby, upon the ISI.
 The second response was always smaller than the first.
 However, this was not dependent on the ISI, and hence not on the baseline
 signal.
 We interpret this effect as central repetition suppression (of the neural
 inputs into the peripheral system) and conclude that linearity is appropriate
 for the peripheral system.
 In other words, the peripheral response to one input is not modulated or
 affected by the response to another, even when they overlap in time 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph

\series bold
Model limits
\end_layout

\begin_layout Standard
Both properties appear good approximations to reality as long as the time
 interval between two SN firing bursts is not very short (< 2 s) or when
 the SN firing burst is not extremely strong.
 It would be possible to model non-linearities in a linear model, using
 Volterra kernels, as in the analysis of functional magnetic resonance images
 in the software SPM 
\begin_inset CommandInset citation
LatexCommand cite
key "Friston:1998aa,Friston:2000aa"
literal "true"

\end_inset

.
 Such possibility is however not implemented in PsPM.
 
\end_layout

\begin_layout Subsubsection
Skin Conductance Response Function (SCRF)
\end_layout

\begin_layout Standard
The peripheral model in its general form does not specify a particular form
 of the SCRF.
 There are three principled ways of defining a SCRF in PsPM:
\end_layout

\begin_layout Enumerate
Individual response function.
 The most precise option is to measure the SCRF for each individual by providing
 brief inputs into the peripheral system and measuring the response.
 PsPM allows specifying individual response functions.
 The benefit of this approach has not been empirically tested.
\end_layout

\begin_layout Enumerate
Canonical response function.
 The most parsimonious method is to use a so-called canonical SCRF which
 is assumed to be constant across individuals.
 We have previously shown that a canonical SCRF can explain on average 50%
 of the variance in individual SCR elicited by various stimuli, while individual
 SCRFs explain about on average 75% of the variance 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

.
 Using a canonical SCRF, linear and non-linear models show a good retrodictive
 validity, superior to peak-scoring methods 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa,Staib:2015aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Enumerate
Constrained response function.
 One can estimate an SCRF from the data of an actual experiment and use
 this for analysis.
 It is usually necessary to constrain the shape of the SCRF to make the
 model estimable.
 PsPM provides two options for this: 
\end_layout

\begin_layout Itemize
In GLM, one can estimate parameters of the (orthogonalised) time derivative
 of the SCRF.
 In order to combine this with the canonical SCRF, the response can afterwards
 be reconstructed for each experimental condition, and the peak amplitude
 taken as estimate of SA.
 This approach has higher retrodictive validity than using the canonical
 SCRF alone, or using a less constrained SCRF (canonical with time and dispersio
n derivative) 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Itemize
In the non-linear model for event-related SCR, one can use the combined
 data from all evoked responses from one individual to estimate an SCRF.
 This approach only considers data within the inter-trial interval.
 In a validation experiments study with ITI of 7-11 s, this had lower retrodicti
ve validity than using the canonical SCRF, and we would not recommend it
 unless the ITI is longer than 20 s, so that the SCRF tail can be unambigouosly
 estimated 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph
Canonical Skin Conductance Response Function
\end_layout

\begin_layout Standard
The canonical SCRF that is currently implemented was derived from a large
 dataset of 1278 SCRs from 64 individuals subjected to different experimental
 manipulations (white noise 85 dB and 95 dB, painful electric stimulation,
 aversive IAPS pictures, detection of auditory oddballs, detection of a
 visual target in a stimulus stream).
 We extracted and mean-centred the 30 s following each stimulus onset and
 performed a principal component analysis.
 The first principal component served as empirical SCRF 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph*
Formulation for linear models
\end_layout

\begin_layout Standard
The first PCA component of the empirical SCRF was approximated was fitted
 by a Gaussian smoothed bi-exponential function (also named bi-exponentially
 modified Gaussian function), and this provided better fit than other function
 categories, in particular Gaussian smoothed monoexponential function, exponenti
al-Gaussian hybrid function, or smoothed sigmoid-exponential function.
 The function is thus defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
h\left(t\right)\propto\int_{0}^{t}N\left(t-\tau\right)\left(E_{1}\left(\tau\right)+E_{2}\left(\tau\right)\right)d\tau\:,\:t\geqslant0,\label{eq:SCRFcan}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
N\left(t\right)=\frac{1}{\sqrt{2\pi\sigma}}e^{-\left(t-t_{0}\right)^{2}/2\sigma^{2}},
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E_{i}\left(t\right)=e^{-\lambda_{i}t},
\]

\end_inset


\end_layout

\begin_layout Standard
with estimated parameters: 
\begin_inset Formula $\hat{t}_{0}=3.0745$
\end_inset

 seconds for peak latency; 
\begin_inset Formula $\hat{\sigma}=0.7013$
\end_inset

 for definition of the rise time; 
\begin_inset Formula $\hat{\lambda}_{1}=0.3176$
\end_inset

 and 
\begin_inset Formula $\hat{\lambda}_{2}=0.0708$
\end_inset

 to define the two decay components.
 This function is normalised to its maximum such that an infinitely short
 SN impulse with unit amplitude elicits an SCR with unit amplitude.
 This renders parameter estimates from linear models easily interpretable
 in relation to conventional (peak-scoring) analysis.
 
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard

\shape italic
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
Historical remarks:
\shape default
 
\end_layout

\begin_layout Plain Layout
(a) The appendix of 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

 contains a typographic error in the definition of the canonical response
 function, in particular in the integration limits of eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SCRFcan"

\end_inset

).
 However, in all versions of the software (PsPM 1.0-now) the canonical SCRF
 was constructed using the Matlab function 
\family typewriter
conv()
\family default
 which defines vector convolution analogous to the integral defined above.
 This implementation has not changed since the initial formulation of the
 model.
\end_layout

\begin_layout Plain Layout
(b) The initial formulation of the SCRF 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2009aa"
literal "true"

\end_inset

 used a Gaussian-smoothed Gamma distribution, based on a smaller dataset.
 In the extended data set published in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

, the polynomial part of the Gamma distribution was estimated to be one,
 resulting in a Gaussian smoothed exponential function.
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
\begin_inset VSpace defskip
\end_inset

Formulation for non-linear models
\end_layout

\begin_layout Standard
An alternative formulation is provided for non-linear models which require
 a definition of the SCRF in the form of an inhomogeneous ordinary differential
 equation (ODE).
 We use an third-order linear ODE to describe the data 
\begin_inset Formula $y\left(t\right)$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dddot{y}+\vartheta_{1}\ddot{y}+\vartheta_{2}\dot{y}+\vartheta_{3}y-u\left(t-\vartheta_{4}\right)=0;\label{eq:ODE}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where dot notation is used for time derivatives, and this formulation embeds
 convolution of the SCRF with the SN time series.
 Parameters were estimated from the empirical SCRF by using a Gaussian bump
 as canonical SN input (see section on SN below) as 
\begin_inset Formula $\hat{\vartheta}_{1}=1.342052$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{2}=1.411425$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{3}=0.122505$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{4}=1.533879$
\end_inset

.
 Amplitude of the response function is rescaled such that a canonical Gaussian
 bump SN impulse with unit amplitude elicits an SCR with unit amplitude.
\end_layout

\begin_layout Paragraph*
Formulation for spontaneous fluctuations
\end_layout

\begin_layout Standard
For modelling spontaneous fluctuations (SF), a different database was used
 that contained 1153 semi-automatically detected SF from 40 male participants
 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ac"
literal "true"

\end_inset

 The first PCA component was taken as empirical SCRF which has slightly
 different shape than the empirical SCRF for evoked responses.
 A number of reasons may account for this difference, from participant selection
 over data pre-conditioning to differences in the canonical SN input.
 In the absence of further knowledge about the reason for this difference,
 we propose to use this empirical response function for SF.
 We estimated the ODE parameters (eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ODE"

\end_inset

): 
\begin_inset Formula $\hat{\vartheta}_{\text{1}}=2.1594$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{2}=3.9210$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{3}=0.9235$
\end_inset

, 
\begin_inset Formula $\hat{\vartheta}_{4}=1.533879$
\end_inset

 seconds.
 Amplitude of the response function is rescaled such that a canonical Gaussian
 bump SN impulse with unit amplitude elicits an SF with unit amplitude.
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
Note: 
\shape default
In the Matlab implementation, the third order ODE is converted to a 3-dimensiona
l system of first-order ODEs.
 In that process, the order of the parameters 
\begin_inset Formula $\vartheta_{1..3}$
\end_inset

 is reversed, and they are renamed.
 With substitutions 
\begin_inset Formula $y_{1}=y$
\end_inset

, 
\begin_inset Formula $y_{2}=\dot{y}$
\end_inset

, 
\begin_inset Formula $y_{3}=\ddot{y}$
\end_inset

, the ODE becomes:
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\begin{array}{c}
\dot{y}_{1}=y_{2}\\
\dot{y}_{2}=y_{3}\\
\dot{y}_{3}=-\vartheta_{1}y_{3}-\vartheta_{2}y_{2}-\vartheta_{3}y_{1}+u\left(t-\vartheta_{4}\right)
\end{array}.
\]

\end_inset


\end_layout

\end_inset

 
\end_layout

\begin_layout Paragraph*

\series bold
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsection
Neural model and model inversion
\end_layout

\begin_layout Subsubsection
Physiological evidence
\end_layout

\begin_layout Standard

\color black
\begin_inset CommandInset citation
LatexCommand cite
key "Gerster:2017aa"
literal "true"

\end_inset

 
\color inherit
recorded from C-fibres in the superficial branch of the common peroneal
 nerve proximal to the ankle, while participants heard loud sounds, or responsed
 to oddball sounds.
 They found that the average SN response was well described by a Gaussian
 bump with 0.25 - 0.30 s standard deviation.
 PsPM models SN bursts as a Gaussian bump with 0.30 s standard deviation.
\end_layout

\begin_layout Subsubsection
General Linear Model (GLM) for evoked SA
\end_layout

\begin_layout Standard
This model was developed for experiments in which short experimental events
 with evoke SA with amplitude 
\begin_inset Formula $a$
\end_inset

.
 For each experimental condition 
\begin_inset Formula $i$
\end_inset

 with onset vector 
\begin_inset Formula $t_{o_{i}}$
\end_inset

, we assume 
\begin_inset Formula $u_{i}\left(t\right)=a_{i}\delta\left(t_{o_{i}}\right)$
\end_inset

.
 See 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

 for details on the model inversion.
 
\end_layout

\begin_layout Subsubsection
Non-linear model (DCM) for event-related SA
\end_layout

\begin_layout Standard
This model 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010aa"
literal "true"

\end_inset

 assumes that event-related SA with amplitude 
\begin_inset Formula $a$
\end_inset

 causes a Gaussian bump-like SN firing burst after some delay and with a
 specified dispersion.
 For each experimental event:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u_{exp}\left(t\right)=a\exp\frac{-\left(t-\mu\right)^{2}}{2\sigma^{2}}+\omega,\:0<\mu<\mu_{max},\:\sigma_{min}<\sigma<\sigma_{max}.
\]

\end_inset


\end_layout

\begin_layout Standard
For situations in which short external stimuli elicit SA, this model uses
 a canonical central burst latency of zero and dispersion of 
\begin_inset Formula $\sigma_{e}=0.3$
\end_inset

 seconds (
\begin_inset Quotes eld
\end_inset

fixed response
\begin_inset Quotes erd
\end_inset

).
 For situations in which central processes translate SA into SN with unknown
 parameters, latency and dispersion are estimated from the data, alongside
 the SA amplitude, using the following constraints: 
\begin_inset Formula $\sigma_{min}=0.1$
\end_inset

, 
\begin_inset Formula $\sigma_{max}=0.5\mu_{max}$
\end_inset

 where 
\begin_inset Formula $\mu_{max}$
\end_inset

 is the maximally allowed response latency (
\begin_inset Quotes eld
\end_inset

flexible response
\begin_inset Quotes erd
\end_inset

).
\end_layout

\begin_layout Standard
The full model also accounts for spontaneous fluctuations (next subsection)
 and baseline changes between trials and can be written as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
y\left(t\right)=y_{exp}\left(t\right)+y_{SF}\left(t\right)+y_{SCL}\left(t\right)+\epsilon
\]

\end_inset


\end_layout

\begin_layout Standard
The SCR components are defined by eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ODE"

\end_inset

) with respective parameters and a respective input function 
\begin_inset Formula $u\left(t\right)$
\end_inset

.
 Specifically, the experimental SCR component models evoked and event-related
 responses, and the SF component models spontaneous fluctuations between
 trials (part of the latent error).
 The SCL term is an explicitly modelled error term that absorbs baseline
 fluctuations and is defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u_{SCL}\left(t\right)=a\exp\frac{-\left(t-\mu\right)^{2}}{2\sigma^{2}},\:\sigma=\sigma_{0}
\]

\end_inset


\end_layout

\begin_layout Standard
where dispersion is set to 
\begin_inset Formula $\sigma_{0}=1.0$
\end_inset

 seconds, and 
\begin_inset Formula $\mu$
\end_inset

 is estimated from the data.
 By default, PsPM automatically mdoels SN bursts that occur more than 5
 s after the previous trial, and more than 2 s before the next trial.
 These limits ensure that the modelled SCL and SF do not absorb variance
 caused by the experiment.
 The use of different limits has not empirically been tested.
\end_layout

\begin_layout Standard
In this model, the parameter space is too large to invert it at once.
 Inversion is done in a trial-by-trial approach: a number of trials, 
\begin_inset Formula $T_{1..n}$
\end_inset

 is inverted.
 The ensuing parameter estimates for 
\begin_inset Formula $T_{1}$
\end_inset

 are extracted, and the parameter estimates for 
\begin_inset Formula $T_{2..n}$
\end_inset

 are used as prior values for the next inversion for trials 
\begin_inset Formula $T_{2..n+1}$
\end_inset

 where the estimated hidden state values at the start of trial 2 are taken
 as starting values of the hidden states 
\begin_inset Formula $x$
\end_inset

.
 This is continued until all trials have been estimated.
 This scheme ensures that inversion is kept tractable, and at the same time
 overlapping responses are taken into account.
 It also means that estimation errors accumulate over trials which is why
 part of the latent error is explicitly modelled as SF and SCL.
 At an inter trial interval of around 10 seconds, inverting 2 or 3 trials
 at the same time yields comparable retrodictive validity 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Subsubsection
Non-linear model for tonic SA (spontaneous fluctuations, SF)
\end_layout

\begin_layout Standard
Spontaneous SN bursts cause spontaneous fluctuations (SF) in skin conductance.
 The number of spontaneous SN bursts is thought to depend on SA.
 Each spontaneous SN burst is modelled as a Gaussian bump with unknown timing
 and amplitude and fixed dispersion.
 For each spontaneous SF burst:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u_{SF}=a\exp\frac{-\left(t-\mu\right)^{2}}{2\sigma^{2}}+\omega,\:\sigma=\sigma_{0},\:a>0
\]

\end_inset


\end_layout

\begin_layout Standard
The dispersion is set to 
\begin_inset Formula $\sigma_{0}=0.3$
\end_inset

 seconds.
 This model is inverted using a Variational Bayes algorithm 
\begin_inset CommandInset citation
LatexCommand cite
key "Daunizeau:2014aa,Daunizeau:2009aa"
literal "true"

\end_inset

.
 Because the number of SN bursts is difficult to estimate directly, the
 SF model inversion uses a fixed rate of SN bursts (set to 
\begin_inset Formula $f=0.5$
\end_inset

 Hertz by default) the amplitude of which is estimated from the data.
 An amplitude threshold is defined to separate 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 SN bursts from noise.
 An amplitude threshold of 0.1 µS rendered the predictive highest validity
 in a validation paper 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2011a"
literal "true"

\end_inset

.
 The results from this paper have been replicated in an unpublished re-analysis
 using AIC as objective function in a manner similar to 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
 Re-analysing the second data set described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2011a"
literal "true"

\end_inset

, the optimal threshold was between 0.15 - 0.20 µS.
 Further systematic research is needed to fine tune the optimal threshold.
 
\end_layout

\begin_layout Standard
Furthermore, PsPM uses a Matching Pursuit (MP) algorithm as fast (< 1 s
 per minute of data) approximation to the DCM inversion (ca.
 1 min.
 per minute of data).
 Using simulated data, this method was less precise, but empirically it
 was comparable to DCM results in three different data sets 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2015aa"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Subsection
Data conditioning
\end_layout

\begin_layout Subsubsection
Filtering
\end_layout

\begin_layout Standard
Skin conductance signals return to a baseline after an SCR, but this baseline
 can change over time within a large dynamic range.
 Such fluctuations of the skin conductance level need to be filtered out
 to make the data accessible to an LTI model.
 A unidirectional 1st order Butterworth high pass filter with cut off frequency
 0.05 Hz was optimal for GLM 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
 The design matrix of the GLM is filtered with the same frequency to account
 for distortions of response shape.
 For the non-linear model (DCM) for event-related responses, an optimal
 filter frequency was found at 0.0159 Hz when using a canonical SCRF and
 inversion of 2 trials at the same time 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
 Filter characteristics of SF models have not been investigated.
 In order to reduce computation load, data are resampled to 10 Hz sampling
 rate for all data analyses which requires a low-pass filter cut off frequency
 of 5 Hz.
 
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Boxed
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout

\shape italic
Historical remark:
\shape default
 The SCRF was developed using a high pass filter with cut off frequency
 of 0.0159 Hz as commonly employed in conventional analysis (bidirectional
 for phasic responses, unidirectional for spontaneous fluctuations).
 However, this turned out to not be the optimal filter for GLM in follow-up
 analyses of optimal data conditioning.
 Note that the canonical SCRF was developed from data filtered with the
 original settings, and this has not changed since.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Subsubsection
Normalisation
\end_layout

\begin_layout Standard
For within-subjects analysis, we propose data normalisation after filtering
 to remove SCR scaling differences due to peripheral factors such as skin
 property.
 This increases retrodictive validity (unpublished analyses).
 For methods that yield trial-by-trial estimates, post-hoc normalisation
 of amplitude estimates across trials, before averaging within conditions,
 yields even better retrodictive validity 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
 For between-subjects analysis, this is not an option as it removes between-subj
ects variance.
 
\end_layout

\begin_layout Subsection
Implicit estimates of tonic sympathetic arousal
\end_layout

\begin_layout Standard
Our model for SF implies that 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\int_{I}\left[y\left(t\right)-y_{0}\right]dt\propto\overset{n}{\underset{i=1}{\sum}}a_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $I$
\end_inset

 is a time interval, and 
\begin_inset Formula $a_{1..n}$
\end_inset

 are the amplitudes of the 
\begin_inset Formula $n$
\end_inset

 sudomotor bursts in this interval and 
\begin_inset Formula $y_{0}$
\end_inset

 is the skin conductance level at rest.
 That is, by simply taking the time integral, or area under the curve (AUC),
 of the baseline-corrected data, we get a measure of the number x amplitude
 of spontaneous SN bursts 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ac"
literal "true"

\end_inset

.
 This measure is implemented in the software as well.
 However, we have subsequently shown that the number of spontaneous SN bursts
 is a better predictor of tonic SA than AUC, and hence we recommend to use
 the non-linear model for tonic SA.
 
\end_layout

\begin_layout Subsection
Comparison with other model-based methods for SCR
\end_layout

\begin_layout Standard
Several further approaches to model-based analysis of SCR have been introduced
 in the literature 
\begin_inset CommandInset citation
LatexCommand cite
key "Lim:1997aa,Alexander:2005aa,Benedek:2010ab,Benedek:2010aa,Greco:2014aa"
literal "true"

\end_inset

 - for one of them, the implementation is publicly available in the software
 package Ledalab.
 In this method, SN is calculated from SCR using a deterministic inverse
 filter.
 Peaks in the SN time series are then identified and used as operational
 index of SA.
 In a head-to-head comparison, retrodictive validity to identify states
 with known SA was compared for experiments involving short stimuli and
 evoked SA.
 PsPM had better retrodictive validity than Ledalab in 4 out of 5 tested
 contrasts, and equal validity in the fifth.
 Ledalab did not consistently perform superior to classical peak scoring
 analysis 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2014aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design: 
\end_layout

\begin_deeper
\begin_layout Itemize
SOA > 2 s between events eliciting SCR.
 SCR amplitudes appear to be linear with an SOA of 3.5 s between subsequent
 stimuli 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2010ad"
literal "true"

\end_inset

 and non-linear with SOA < 1 s 
\begin_inset CommandInset citation
LatexCommand cite
key "Kunimoto:1992ab"
literal "true"

\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Itemize
Model set up:
\end_layout

\begin_deeper
\begin_layout Itemize
Use GLM wherever possible.
 GLM is more sensitive than non-linear models in evoked SCR paradigms 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Itemize
Use default filter frequencies (0.05 - 5 Hz unidirectional filter for GLM
 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

; 0.0159 - 5 Hz bidirectional filter for non-linear model 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

).
 In case of sparse SCR (e.g.
 in paradigms with long ITIs), the bidirectional filter can distort the
 signal to an extent that it becomes difficult to model.
 In such cases, it might be preferable to use a unidirectional filter (see
 e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Wehrli:2022aa"
literal "false"

\end_inset

)
\end_layout

\begin_layout Itemize
GLM: include all experimental events that evoke SCR (including block starts,
 break messages, etc.).
\end_layout

\begin_layout Itemize
GLM: canonical SCRF with time derivative and reconstruction of amplitudes
 is more sensitive than just canonical SCRF, or SCRF plus time and dispersion
 derivative 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa"
literal "true"

\end_inset

.
 The benefit of subject-specific SCRFs has not been tested.
\end_layout

\begin_layout Itemize
non-linear model: canonical SCRF is more sensitive than using subject-specific
 SCRFs based on short (~ 10 s) ITIs 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

.
 The use of individual SCRFs based on long ITI paradigms has not been tested.
\end_layout

\begin_layout Itemize
non-linear model: for fear conditioning paradigms, the best way of modelling
 anticipatory SCR is currently under investigation.
 It is possibly suboptimal to model one anticipatory 
\begin_inset Quotes eld
\end_inset

flexible
\begin_inset Quotes erd
\end_inset

 response, in particular at longer CS/US SOAs when this flexible response
 may absorb SCR elicited by US or US omission.
 See e.g.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Wehrli:2022aa,Xia:2023aa"
literal "false"

\end_inset


\end_layout

\begin_layout Itemize
GLM and non-linear model: z-normalisation of data is recommended for within-subj
ects designs, and should not be used for between-subjects designs.
\end_layout

\end_deeper
\begin_layout Itemize
Model inversion:
\end_layout

\begin_deeper
\begin_layout Itemize
SF model: the VB inversion is theoretically better suited than the MP inversion
 when the expected number of SF is > 10/minute 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2015ab"
literal "false"

\end_inset

.
\end_layout

\end_deeper
\begin_layout Itemize
Post-processing
\end_layout

\begin_deeper
\begin_layout Itemize
non-linear model: trial-by-trial normalisation of amplitude estimates before
 averaging within conditions can increase sensitivity in within-subjects
 designs 
\begin_inset CommandInset citation
LatexCommand cite
key "Staib:2015aa"
literal "true"

\end_inset

 but should not be used in between-subjects designs.
\end_layout

\end_deeper
\begin_layout Section
Heart Period Response (HPR) Models
\end_layout

\begin_layout Standard

\shape italic
contributed by Philipp C.
 Paulus and Giuseppe Castegnetti, and edited by Dominik R.
 Bach
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
Cardiac rhythm is generated locally in the sinoatrial node, but is modulated
 by central neural input.
 Therefore, heart rhythm can be used to infer psychological states.
 To quantify phasic changes in cardiac chronotropy, two measures are common:
 heart rate (beats per minute) or heart period (milliseconds).
 Heart period appears to relate to autonomic input linearly, as revealed
 in experiments in which autonomic nerves in rodents were electrically stimulate
d with varying frequencies to elicit heart period changes 
\begin_inset CommandInset citation
LatexCommand cite
key "Berntson:1995"
literal "true"

\end_inset

.
 This is why PsPM models heart period.
 Heart period information is only available at discrete time points.
 To facilitate analysis within the existing algorithms, PsPM assigns each
 heart period to its following heartbeat and linearly interpolates this
 time series at 10 Hz resolution.
 
\end_layout

\begin_layout Standard
For the analysis of event-related, i.e.
 phasic cardiac responses, PsPM includes two models: A model for event-related
 HPR 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

 and a model for fear-conditioned bradycardia 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

.
 As in previous models for SCR, both models are optimised with regard to
 
\shape italic
retrodictive validity
\shape default
, i.e.
 the ability to separate experimental conditions (e.g., CS+ vs.
 CS-).
\end_layout

\begin_layout Standard
Operational analysis has shown that event-related HPR pattern strongly depends
 upon properties of the input - i.e.
 modality, intensity and presentation duration of the stimulus material.
 It follows that both models can only be applied in experiments with similar
 conditions, including stimulus presentation times (i.e.
 
\begin_inset Formula $\leq$
\end_inset

 1 s for event-related HPR).
 Pharmacological studies have suggested a differential time course of sympatheti
c and parasympathetic nervous input, but it is not yet known how this maps
 onto the response components modelled here.
\end_layout

\begin_layout Subsection
Peripheral and neural model
\end_layout

\begin_layout Standard
In the absence of information on the time course of cardiac information,
 it is difficult to separate a neural and a peripheral model.
 Hence, these two are collapsed for the purpose of quick and simple inversion
 with GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

).
 This means that the implemented models - for evoked HPR and fear-conditioned
 or reward-conditioned HPR - use a different RF, although of course the
 peripheral system is the same in both cases.
 Castegnetti et al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

 relate the two models to each other, and derived the neural input producing
 fear-conditioned bradycardia (see figure 1 of 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

).
\end_layout

\begin_layout Subsection
Model for event-related HPR
\end_layout

\begin_layout Standard
The model for event-related HPR 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

 was developed on data from 84 participants that underwent three different
 experiments: An experiment using loud white noise sounds (
\begin_inset Formula $\sim85dB$
\end_inset

), an experiment using an auditory oddball task, and an experiment using
 emotional pictures from the International Affective Picture System (IAPS;
 
\begin_inset CommandInset citation
LatexCommand cite
key "Bradley:2001"
literal "true"

\end_inset

).
 All stimuli were presented with long ITIs (> 30 s) to allow the cardiac
 system to return to baseline after stimulus presentation and avoid overlapping
 responses.
 The first three principal response components were extracted, and individual
 peaks fitted with Gaussian Functions as RF:
\begin_inset Formula 
\begin{equation}
h\left(y\right)=\frac{1}{\sigma\sqrt{2\pi}}e^{\frac{-(t-\mu)^{2}}{2\sigma^{2}}}\label{eq:Gaussian}
\end{equation}

\end_inset

To test whether a modeled peak qualified as a RF, we tested whether it explained
 interesting variance in the data.
 We started with a single RF and included further RFs.
 Specifically, we created a first-level GLM for each participant by convolving
 the event onsets with the specific subset of RFs, and extracted estimates
 of the response amplitudes for each RF and condition from the continuous
 heart period data.
 In order to qualify as RF, parameter estimates for this RF were either
 required to depict a stable response (i.e., acceleration or deceleration)
 across all experiments, tested by a one-sample t-test, or to add to the
 
\shape italic
retrodictive validity
\shape default
 of the model.
 This second criterion was evaluated by subjecting the parameter estimates
 to a between-subject analysis of variance (ANOVA) testing for a main effect
 of experimental condition.
\begin_inset Newline newline
\end_inset

 Hence, the following steps were taken: 
\begin_inset Newline newline
\end_inset

 
\begin_inset space \hspace*{}
\length 10mm
\end_inset


\series bold
Step 1.

\series default
 Test all potential RFs modeled from PCs individually and retain each single
 RF if it depicts a stable acceleration or deceleration across all experiments
 or if it allows separation of at least two of the three experiments.
 All potential RFs fulfilled one of these criteria.
 
\begin_inset Newline newline
\end_inset

 
\begin_inset space \hspace*{}
\length 10mm
\end_inset


\series bold
Step 2.

\series default
 Take the chronologically first RF from Step 1 and combine it with the chronolog
ically second RF from Step 1, or with any other RF that overlaps with this
 second RF.
 Orthogonalize each set in temporal order, using a Gram-Schmidt algorithm.
 Retain the best set if additional RFs allow the separation of the three
 experiments.
 
\begin_inset Newline newline
\end_inset

 
\begin_inset space \hspace*{}
\length 10mm
\end_inset


\series bold
Step 3-5.

\series default
 Take the current set, and add the chronologically next untested RF from
 Step 1, or any other RF that overlaps in time with this second RF.
 Repeat the strategy of Step 2, and retain the best set if additional RFs
 allow the separation of the three experiments.
 
\begin_inset Newline newline
\end_inset

 This testing procedure yielded a basis set of six RFs.
 Model constants are depicted in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:model_constants_HPR"

\end_inset

.
 
\begin_inset Newline newline
\end_inset

 In an independent model-validation experiment with short ISI (10 s) that
 used white-noise sounds of varying intensities (
\begin_inset Formula $\sim$
\end_inset

85 vs.
 
\begin_inset Formula $\sim$
\end_inset

65 dB) and both negative and positive pictures from the International Affective
 Picture System (IAPS; 
\begin_inset CommandInset citation
LatexCommand cite
key "Bradley:2001"
literal "true"

\end_inset

), the following RFs allowed separation of the different experimental conditions
:
\begin_inset Newline newline
\end_inset

 RF1 allowed the discrimination of 85 dB white-noise sounds and IAPS pictures
 as well as Positive and Negative IAPS pictures.
 RF2 allowed the discrimination of 85 dB and 65 dB white-noise sounds, as
 well as Positive and Negative IAPS pictures.
 RF3 allowed the discrimination of Negative and Positive IAPS pictures.
 RF4 did not allow discrimination of any experimental conditions in the
 validation experiment, but showed a trend to significance for the discriminatio
n of 85 dB white-noise sounds and IAPS pictures (
\begin_inset Formula $p=.051$
\end_inset

) and a trend for discrimination of Positive and Negative IAPS pictures
 (
\begin_inset Formula $p=.068$
\end_inset

).
\end_layout

\begin_layout Standard
\noindent
\begin_inset Float table
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Model constants for evoked HPR 
\end_layout

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Response Function (RF)
\series default
 
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameters of Gaussian Function
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.0 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.9 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.9 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7.2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.5 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7.2 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12.6 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.0 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18.85 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.8 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
Note.

\shape default
 
\begin_inset Formula $\mu=$
\end_inset

mean; 
\begin_inset Formula $\sigma=$
\end_inset

 standard deviation
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:model_constants_HPR"

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Because the data are interpolated, apparent responses to stimuli can start
 before stimulus presentation.
 This is evident in these RFs some of which overlap time point 0 and therefore
 start before the actual stimulus.
 In PsPM this phenomenon is automatically accounted for.
\end_layout

\begin_layout Subsection
Model for fear-conditioned HPR
\end_layout

\begin_layout Standard

\color black
For the analysis of fear-conditioned HPR, we sought to build a data-driven
 RF for discriminating between HPR to CS+ and CS- 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

.
 This model-based analysis was developed on the basis of four independent
 data sets, acquired during diverse implementations of a fear conditioning
 protocol.
 The shape of the response was determined by visually identifying a gamma
 distribution as the function that qualitatively best resembled the difference
 between grand means.
 This function 
\begin_inset Formula 
\begin{equation}
y=\frac{A}{\theta^{k}\Gamma(k)}(x-x_{0})^{k-1}e^{-\frac{x-x_{0}}{\Theta}}\label{eq:gamma}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\color black
was fitted it by finding the values of the shape parameter 
\begin_inset Formula $k$
\end_inset

, the scale parameter 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\theta$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\xout default
\uuline default
\uwave default
\noun default
\color black
, the time onset 
\begin_inset Formula $x_{0}$
\end_inset

 and the amplitude 
\begin_inset Formula $A$
\end_inset

 that minimised the residual sum of squares (RSS)
\color inherit
.
 The resulting parameters were 
\begin_inset Formula $k=1373$
\end_inset

, 
\begin_inset Formula $\theta=0.0311$
\end_inset

, 
\begin_inset Formula $x_{0}=-38$
\end_inset

, with 
\begin_inset Formula $A$
\end_inset

 left free to vary during the model inversion.
 Shifts in the response are modelled by its first time derivative.
 The ensuing model-based analysis reliably distinguishes HPR to CS+ and
 CS-, and does so significantly better than model-free analogues (e.g., peak
 scoring, area under the curve).
\end_layout

\begin_layout Subsubsection
Adaptation to different SOAs
\end_layout

\begin_layout Standard
By considering fear conditioning sessions with different SOAs between CS
 and US, we investigated how this changes the anticipatory response.
 Our analysis suggested that for different SOAs the anticipatory HPR is
 time-locked to the US, with no changes in shape.
 This can be modelled by time-locking the RF (developed for 3.5 s) to the
 US.
 In PsPM, the default SOA is 3.5 s, and it can be modified to assume any
 positive value.
 However, we recommend not using SOAs shorter than 2 s.
 This procedure has been successfully tested with SOAs of 4 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

 and 6 s 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016ab"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Model for reward-conditioned HPR
\end_layout

\begin_layout Standard
For analysis of reward-conditioned HPR with an SOA of 5 s, we built a response
 function on an exploration data set and validated it on a confirmation
 data set 
\begin_inset CommandInset citation
LatexCommand cite
key "xia_liu:2024"
literal "false"

\end_inset

.
 The RF caputured responses observed during acqusition, as well as during
 retention 7 days later.
 The RF implemented in PsPM was updated on the combined data set.
 Parameters for eq.
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:gamma"
plural "false"
caps "false"
noprefix "false"

\end_inset

) were estimated as 
\begin_inset Formula $k=171.6$
\end_inset

, 
\begin_inset Formula $\theta=0.1400$
\end_inset

, 
\begin_inset Formula $x_{0}=-17.60$
\end_inset

, with 
\begin_inset Formula $A$
\end_inset

 left free to vary during the model inversion.
 
\end_layout

\begin_layout Subsection
Data Conditioning
\end_layout

\begin_layout Subsubsection
Heart beat detection 
\begin_inset CommandInset label
LatexCommand label
name "subsec:QRS-detection"

\end_inset


\end_layout

\begin_layout Standard
PsPM uses a modified offline version of the Pan & Tompkins 
\begin_inset CommandInset citation
LatexCommand cite
key "Pan:1985aa"
literal "true"

\end_inset

 QRS detection algorithm.
 The algorithm analyses slope, amplitude, and width of QRS complexes.
 It uses digital band-pass filters to reduce noise and its thresholds are
 periodically adjusted to low values.
 The algorithm works best on data with a time-resolution of 200 Hz.
 Data with higher sampling rate will automatically be downsampled to the
 optimal time-resolution.
 The QRS complex is marked at the rising edge of the integrated waveform
 signal that usually corresponds well with the position of the R-spike of
 the ECG.
\begin_inset Newline newline
\end_inset

 For the offline version of the Pan & Tompkins QRS detection algorithm some
 adjustments were made: 
\end_layout

\begin_layout Itemize
The originally used cascaded integer filters were replaced by a second order
 Butterworth filter that approximates the desired passband from 5 to 15
 Hz better than the original filters.
 
\end_layout

\begin_layout Itemize
To increase detection accuracy heart rate values were restricted to the
 interval of 20 bpm (IBI of 3000 ms) to 300 bpm (IBI of 300 ms).
 
\end_layout

\begin_layout Itemize
To allow for a manual inspection and possible correction of detection failures,
 the ECG editor allows visually inspecting the results of QRS detection.
 
\end_layout

\begin_layout Standard
Depending on the quality of the recordings, QRS detection can achieve a
 very high accuracy in detecting QRS complexes of up to 99.66% 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard

\series medium
PsPM also contains a QRS detection algorithm for ECG data acquired in MRI
 environments.
 The algorithm is described in 
\begin_inset CommandInset citation
LatexCommand cite
key "liu2012statistical"
literal "false"

\end_inset

.
 The implementation is obtained from the software link given in the paper.
 
\series default
To process pulse oxymetry data, PsPM contains a template matching algorithm
 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

 and an interface to the HeartPy toolbox 
\begin_inset CommandInset citation
LatexCommand cite
key "Gent:2019aa"
literal "false"

\end_inset

.
 
\end_layout

\begin_layout Subsubsection
Interpolation and Filtering 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Interpolation-and-Filtering"

\end_inset


\end_layout

\begin_layout Standard
To transform the discontinuous heart-beat information into a continuous
 signal of heart-period, the heart-beat events are interpolated at a fixed
 sampling rate of 10 Hz using the built-in function 
\family typewriter
pspm_hb2hp
\family default
.
 The interpolation shifts some early evoked responses such that they appear
 to start before an event - this is automatically being taken care of by
 a response function that starts slightly before an event definition.
\begin_inset Newline newline
\end_inset

Before obtaining parameter estimates for the individual response functions
 the interpolated heart beat time-series is filtered with a second-order
 Butterworth band-pass filter.
 For evoked HPR, PsPM uses a pass band of 0.01-2 Hz 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

.
 For fear-conditioned HPR, PsPM uses a 0.015-0.5 Hz bidirectional 4th order
 Butterworth filter (cf.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

).
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design: 
\end_layout

\begin_deeper
\begin_layout Itemize
evoked HPR model: use only those RFs that peak within the SOA between subsequent
 events that elicit an HPR.
 A formal test of the linearity assumption has not been done yet.
 Therefore, the number of RFs that can be applied depends upon the SOA.
\end_layout

\begin_layout Itemize
fear-conditioned HPR: use default model for CS/US-SOAs between approximately
 2-8 s.
 The model is tested for 3.5 - 6 s.
 
\end_layout

\begin_layout Itemize
reward-conditioned HPR: use default model for CS-US-SOA of around 5 s.
 The model is tested for 5 s.
\end_layout

\end_deeper
\begin_layout Itemize
Model set up:
\end_layout

\begin_deeper
\begin_layout Itemize
Use default filter frequencies (0.01 - 2 Hz unidirectional 2nd order Butterworth
 filter for evoked HPR 
\begin_inset CommandInset citation
LatexCommand cite
key "Paulus:2016aa"
literal "true"

\end_inset

; 0.015 - 0.5 Hz bidirectional 6th order Butterworth filter for fear- and
 reward-conditioned HPR 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa,xia_liu:2024"
literal "true"

\end_inset

, although there is apparently no strong impact of filter frequency.
\end_layout

\begin_layout Itemize
Fear-conditioned HPR: using first derivative and reconstructing response
 amplitude is more sensitive that using just the canonical RF 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

.
\end_layout

\end_deeper
\begin_layout Section
Pupil size response (PSR) models
\end_layout

\begin_layout Standard

\shape italic
\color black
contributed by Christoph W.
 Korn
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
Pupil size is under control of two antagonistic muscles 
\begin_inset CommandInset citation
LatexCommand cite
key "McDougal:2008aa"
literal "true"

\end_inset

: Dilation (mydriasis) results from sympathetic inputs on the M.
 dilatator pupillae.
 Constriction (miosis) results from parasympathetic inputs on the M.
 sphincter pupillae.
 Pupil size reacts to changes in illuminance (light falling onto the eye,
 directly related to the luminance of screen presentations).
 It also responds to many cognitive processes including attention, perception,
 memory, and emotion (see 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset

 for references).
 Such cognitive processes are supposed to be relayed via the Edinger-Westphal
 nucleus and noradrenergic inputs into the locus coeruleus, among others
 
\begin_inset CommandInset citation
LatexCommand cite
key "McDougal:2008aa"
literal "true"

\end_inset

.
 On the basis of two experiments that elicited (il)luminance changes, we
 have developed a model for steady state pupil size and, more importantly,
 an model for changes of pupil size that is based on two LTI systems.
 These LTI systems can be harnessed to infer the neural input into the pupillary
 system that is elicited by cognitive processes (under the assumption of
 a common final pathway of (il)luminance-mediated inputs and cognitive inputs).
 We have also developed and validated a specific LTI system that allows
 distinguishing responses to CS+US- and CS- in fear-conditioning setups
 employing different sensory modalities and timings 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2017a"
literal "true"

\end_inset

.
 In this latter model, neural and peripheral system are collapsed for the
 purpose of quick and simple inversion with GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

).
 
\end_layout

\begin_layout Subsection
Model for pupil size changes elicited by (il)luminance changes
\end_layout

\begin_layout Standard
The system controlling pupil size is non-linear.
 To be able and use linear methods for analysis, PsPM splits the model into
 several parts.
 
\end_layout

\begin_layout Subsubsection
Model for steady-state pupil size
\end_layout

\begin_layout Standard
An exponential function is used to relate illuminance (in
\begin_inset Formula $[lx]$
\end_inset

) or luminance (in
\begin_inset Formula $\frac{cd}{m^{2}}$
\end_inset

) to steady-state pupil size (in arbitrary units as determined by the Eyelink
 system or in mm).
 These functions were specified on the basis of the first experiment described
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset

 (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prepare-illuminance-GLM"

\end_inset

).
 The functional relationship should cover the (il)luminance range employed
 in most cognitive experiments.
 
\begin_inset Formula 
\[
d\text{(}E_{v}\text{)=}C\text{ +}A\exp(BE_{v}\text{)}.
\]

\end_inset


\end_layout

\begin_layout Standard
Here, 
\begin_inset Formula $d$
\end_inset

 is the z-scored steady-state pupil diameter and 
\begin_inset Formula $E_{v}$
\end_inset

 is the respective illuminance level in (in 
\begin_inset Formula $[lx]$
\end_inset

).
 We obtained the following parameter values: 
\begin_inset Formula $A=49.79$
\end_inset

; 
\begin_inset Formula $B=-0.50$
\end_inset


\begin_inset Formula $[\frac{1}{lx}]$
\end_inset

; 
\begin_inset Formula $C=-1.05$
\end_inset

.
 Whether the non-linearity occurs in the peripheral or neural system is
 currently not known.An extension that is similar to our model within the
 (il)luminance range specified in our experiments, but extends across a
 wider range, can be found in 
\begin_inset CommandInset citation
LatexCommand cite
key "Watson:2012aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Model for pupil dilation/constriction
\end_layout

\begin_layout Standard
Dilations and constrictions differ in shape, and can thus not be modeled
 by a single LTI system (which would assume that positive and negative changes
 do not differ in shape but just in sign).
 Hence, we identified a combination of two LTI systems that provide a good
 approximation of pupil size changes elicited by (il)luminance changes (see
 first two experiments in 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset

).
 The first LTI-system describes changes to continuous (il)luminace inputs
 and the second LTI-system models the difference between constriction and
 dilation.
 The second system thus receives a brief input for any increase in (il)luminance.
 Both systems are specified by canonical response functions that take the
 form of gamma probability density functions.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
d\text{(}t)=c\frac{(t-t0)^{k-1}\exp(-(t+t0)/\theta)}{\theta^{k}\Gamma(k)}
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $d$
\end_inset

 is the z-scored steady-state pupil diameter, 
\begin_inset Formula $t$
\end_inset

 is time, 
\begin_inset Formula $\varGamma$
\end_inset

 is the gamma function, and 
\begin_inset Formula $k$
\end_inset

, 
\begin_inset Formula $\theta$
\end_inset

, 
\begin_inset Formula $c$
\end_inset

and 
\begin_inset Formula $t0$
\end_inset

 are free parameters.
 The fitted parameter values were: System 1: 
\begin_inset Formula $k=2.40$
\end_inset

, 
\begin_inset Formula $\theta=0.29s^{-1}$
\end_inset

, 
\begin_inset Formula $c=0.77$
\end_inset

; System 2: 
\begin_inset Formula $k=3.24$
\end_inset

, 
\begin_inset Formula $\theta=0.18s^{-1}$
\end_inset

, 
\begin_inset Formula $c=0.43$
\end_inset

.
 Since the latency of the empirical responses was around 200 ms, 
\begin_inset Formula $t0$
\end_inset

 was set to 200 ms prior to fitting.
 (We also modelled the first system with a Gaussian smoothed biexponential
 function; 
\begin_inset Formula $d\text{(}t)=aN(t)*(E_{1}(t)+E_{2}(t));$
\end_inset

 where 
\begin_inset Formula $*$
\end_inset

 is the convolution operator; 
\begin_inset Formula $N(t)$
\end_inset

 is a centered Gaussian function 
\begin_inset Formula $N(t)=(2\pi\sigma)^{-0.5}\exp(-t^{2}/2\sigma^{2})$
\end_inset

 and 
\begin_inset Formula $E_{1}(t)$
\end_inset

 and 
\begin_inset Formula $E_{2}(t)$
\end_inset

 are exponential functions of the form 
\begin_inset Formula $E(t)=\exp(-\lambda t)$
\end_inset

; parameter values: 
\begin_inset Formula $\sigma=0.27$
\end_inset

, 
\begin_inset Formula $\lambda_{1}=2.04s^{-1}$
\end_inset

, 
\begin_inset Formula $\lambda_{2}=1.48s^{-1}$
\end_inset

, 
\begin_inset Formula $a=0.004$
\end_inset

).
\end_layout

\begin_layout Standard
In GLM-based analyses, these systems explain considerable variance in pupil
 size time series in two experiments with (il)luminance inputs of long and
 short duration (with the second LTI system being particularly relevant
 for brief, i.e., sub-second, inputs).
 The modeled pupil size time series can be easily specified given a time
 series of (il)luminance values (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Prepare-illuminance-GLM"

\end_inset

).
 These time series can be used as nuisance regressors in GLMs.
 Because the end stage of the pupil system does not depend on where the
 neural input comes from, the specified canonical response functions can
 also be used to estimate the shape (i.e., the temporal characteristics) of
 likely inputs into the pupillary systems for cognitive tasks.
 We provide examples for this for auditory oddball tasks with three different
 timings, for an emotional words task, and for a visual detection task (see
 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2016a"
literal "true"

\end_inset

).
 
\end_layout

\begin_layout Subsection
Model for pupil size changes elicited by fear conditioning
\end_layout

\begin_layout Standard
This model collapses peripheral and neural processes into one RF, in order
 to use GLM for the inversion.
 On the basis of four experiments employing simple and complex auditory,
 visual, and somatosensory CS, we have determined a canonical response function
 that reliably distinguishes pupil responses to CS+US- and CS- 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2017a"
literal "true"

\end_inset

.
 retrodictive validity exceeds (or is at least equal to) peak scoring and
 calculating the area-under-the-curve.
 The response function was initially based on a CS to US SOA of 3.5 s but
 the same function can be used for an SOA of 6 s.
 The overall best performing model did not include the temporal derivative
 but this is still accessible in PsPM.
 The gamma probability density function followed the same form specified
 above with the parameter values 
\begin_inset Formula $k=6.03$
\end_inset

, 
\begin_inset Formula $\theta=0.73s^{-1}$
\end_inset

, 
\begin_inset Formula $c=1.6$
\end_inset

, 
\begin_inset Formula $t0=0.029$
\end_inset

 (
\begin_inset Formula $t0$
\end_inset

 was fitted for this model).
\end_layout

\begin_layout Subsection
Data preconditioning
\end_layout

\begin_layout Standard
We provide procedures to import pupil data from Eyelink, SMI and ViewPoint
 files, but they can also be imported from other sources via matlab or text
 files.
 All PsPM models specify pupil diameter.
 Eyelink import automatically converts input into diameter in absolute units
 (mm).
 SMI diameter values are returned in pixel values.
 ViewPoint diameter values are returned in ratio units as they are given
 in the data file.
 For other sources it may be necessary to convert the data using the respective
 conversion function.
 Missing data due to blinks, saccades, or slight head movements can be linearly
 interpolated before z-scoring.
 These missing data can then be retained, or not, for the GLM.
\end_layout

\begin_layout Standard
Pupil area appears smaller to the eyetracking camera when the participant
 does not maintain fixation.
 Whether this 
\begin_inset Quotes eld
\end_inset

Pupil foreshortening error
\begin_inset Quotes erd
\end_inset

 (PFE) influences recordings depends on the eyetracker.
 Geometrically, it would be possible to fit the visible pupil shape with
 an ellipse and retain the long axis as pupil diameter, which is invariant
 to eye movements.
 However, apparently many eyetrackers simply report the number of pupil
 pixels, ie.
 an area measure.
 For example, although the Eyelink 1000 eyetracker has the possibility to
 choose an ellipsoid model, this is according to the manual (User Manual.
 v.1.4.0, p.
 23) only used to determine pupil position, but not pupil area or diameter
 (
\begin_inset Quotes eld
\end_inset

Measure of Area or Diameter are always based on the Centroid Model
\begin_inset Quotes erd
\end_inset

).
 
\end_layout

\begin_layout Standard
To account for loss of fixation, PsPM includes two options: exclude these
 time intervals, or correct pupil size with a geometric model.
 (1) To detect loss of fixation there is a specific function .
 The user has to specify the distance between screen and eye, the screen
 size, the position of the fixation point (by default the middle of the
 screen is assumed but additionally a time series of fixation points can
 be specified), and the threshold for exclusion set in degrees of visual
 angle.
 (2) PsPM also includes a method to perform pupil foreshortening error (PFE)
 correction as described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

.
 The implementation itself is eyetracker or measurement method independent;
 however, we use Eyelink in its name because the method was proposed specificall
y for Eyelink 1000 eyetracker.
 To perform PFE correction, PsPM requires extra information about the recording
 setup.
 Specifically, screen resolution, screen size and the screen-camera-eye
 geometry setup must be known.
\end_layout

\begin_layout Standard
Pupil size obtained using eyetrackers may be contaminated with high noise.
 Before using this data in various statistical models, it might be beneficial
 to preprocess it in order to increase signal-to-noise ratio.
 PsPM offers a pupil size preprocessing utility that is independent of the
 eyetracker used.
 The method is described in 
\begin_inset CommandInset citation
LatexCommand cite
key "kret2018preprocessing"
literal "false"

\end_inset

.
 We use a modified version of the software published in this paper.
 All the modifications are documented and the changelog is part of PsPM.
 The preprocessing method can be used without any additional information
 about the recording setup.
 PsPM exposes all the preprocessing parameters used by the underlying software
 to the user for finetuning.
\end_layout

\begin_layout Standard
Finally, we found that filtering provided equal or worse proportions of
 explained variance and therefore there is no default filtering although
 this may be beneficial for other experimental designs.
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design: 
\end_layout

\begin_deeper
\begin_layout Itemize
fear-conditioned PSR: use default model for CS/US-SOAs between approximately
 2-8 s.
 The model is tested for 3.5 - 6 s.
 
\end_layout

\end_deeper
\begin_layout Itemize
Model set up:
\end_layout

\begin_deeper
\begin_layout Itemize
fear-conditioned PSR: use no filter 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2017a"
literal "true"

\end_inset


\end_layout

\begin_layout Itemize
fear-conditioned PSR: use no derivative, If possible, model the US response
 separately (requires a command-line function call to 
\family typewriter
pspm_glm
\family default
) 
\begin_inset CommandInset citation
LatexCommand cite
key "Korn:2017a"
literal "true"

\end_inset


\end_layout

\end_deeper
\begin_layout Section
Respiratory response models
\end_layout

\begin_layout Standard

\shape italic
\color black
contributed by Giuseppe Castegnetti and Dominik R Bach
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
Brain stem centres regulate respiration via autonomic nervous efferents,
 and these centres are influenced by higher cognitive processes 
\begin_inset CommandInset citation
LatexCommand cite
key "Cacioppo:2007aa,Wientjes:1998aa"
literal "true"

\end_inset

.
 This may allow inferring psychological states from measured respiration,
 although it is not very well know which psychological variables or events
 elicit phasic respiratory responses.
 PsPM implements four models for respiratory responses, derived from a single
 chest belt system.
 In principle, this system only allows assessing respiration period, while
 for precise quantification of respiratory amplitude, a double-belt system
 would be required to measure both thoracic and abdominal compartments 
\begin_inset CommandInset citation
LatexCommand cite
key "Binks:2006aa"
literal "true"

\end_inset

.
 However, if the ratio between thoracic and abdominal contribution is relatively
 constant within any individual, it may still be possible to approximate
 respiratory amplitude up to a linear constant from the single-belt system.
 We confirmed in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

 that respiration amplitude from a single chest belt system can be usefully
 analysed.
 PsPM considers the following measures: 
\end_layout

\begin_layout Itemize
Respiration period (RP) is the duration of a breathing cycle.
 PsPM models RP rather than the more common respiration rate, its inverse,
 in analogy to analysis of event-related cardiac responses where heart period
 has been shown to linearly relate to autonomic nervous system input 
\begin_inset CommandInset citation
LatexCommand cite
key "Berntson:1995"
literal "true"

\end_inset


\end_layout

\begin_layout Itemize
Respiration amplitude (RA) is the amplitude in rib cage excursion on that
 cycle, which linearly relates to current tidal volume (VT) 
\begin_inset CommandInset citation
LatexCommand cite
key "Binks:2006aa"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Itemize
Respiration flowrate (RFR), RA/RP, which is linearly related to tidal volumetric
 flow rate, i.e.
 tidal volume per time unit.
 RFR is computed per cycle with variable duration.
 Otherwise it is similar to minute volume, or RLL (respiration line length),
 which are computed over fixed intervals rather than respiratory cycles.
\end_layout

\begin_layout Standard
In these measures, we identified the following pattern of phasic responses
 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

:
\end_layout

\begin_layout Itemize
Respiratory period responses (RPR) are elicited by various external events
 (aversive sounds, electric shocks, picture viewing, visual detection) and
 reliably distinguish events from non-events
\end_layout

\begin_layout Itemize
Respiratory amplitude responses (RAR) are elicited by aversive sounds and
 shocks, and by picture viewing.
 Response amplitudes are smaller for picture viewing (including aversive
 pictures) than aversive sounds.
 RAR are also elicited by fear-conditioned stimuli.
\end_layout

\begin_layout Itemize
Respiratory flow-rate responses (RFRR) are elicited by aversive sounds and
 shocks, and by picture viewing.
 Response amplitudes are smaller for picture viewing (including aversive
 pictures).
 
\end_layout

\begin_layout Subsection
Peripheral and neural model
\end_layout

\begin_layout Standard
In the absence of information on the timecourse of input into breathing
 control, it is difficult to separate a neural and a peripheral model.
 Hence, these two are collapsed for the purpose of quick and simple inversion
 with GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

).
 This means that the two implemented models for RAR - evoked RAR and fear-condit
ioned RAR - use a different RF, although of course the peripheral system
 is the same in both cases.
\end_layout

\begin_layout Subsection
Models for evoked respiratory responses
\end_layout

\begin_layout Standard
These models are based on responses from 46 participants and on the following
 task conditions: visual detection, aversive electric shocks, IAPS picture
 viewing.
 The model was validated on an independent sample of 20 participants and
 the following task conditions: aversive and less aversive white noise sounds,
 positive and negative IAPS picture viewing.
 
\end_layout

\begin_layout Standard
We modelled responses with Gaussian functions:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
h\left(y\right)=\frac{1}{\sigma\sqrt{2\pi}}e^{\frac{-(t-\mu)^{2}}{2\sigma^{2}}}.
\]

\end_inset


\end_layout

\begin_layout Standard
Model constants after filter optimisation are summarised in table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:model_constants-Resp"

\end_inset

.
 Later response components that were visually identified in the development
 data set did not contribute to detecting overall responses or separating
 experimental conditions.
 Modelling the time derivative of the RF improved the RA and RFR models,
 but not the RP model 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
\noindent
\begin_inset Float table
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Model constants for evoked respiratory responses
\end_layout

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Response Function (RF)
\series default
 
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Parameters of Gaussian Function
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mu$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RPR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.20 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.65
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RAR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.07 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.74
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RFRR
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.23
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="l">
\begin_inset Text

\begin_layout Plain Layout

\shape italic
Note.

\shape default
 
\begin_inset Formula $\mu=$
\end_inset

 mean; 
\begin_inset Formula $\sigma=$
\end_inset

 standard deviation
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:model_constants-Resp"

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Model for fear-conditioned RAR
\end_layout

\begin_layout Standard
After showing that RAR may be better suited to distinguish cognitive processes
 than respiration period 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

, we investigated whether RAR allow assessment of fear memory in cued fear
 conditioning.
 Following the same procedure as in 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016aa"
literal "true"

\end_inset

, we built the RF from data collected during six experiments, involving
 diverse stimuli and two types of breathing belts (bellows and cushion systems).
 The ensuing winning model was the combination of an early and a late response
 components, modelled by gamma distributions
\end_layout

\begin_layout Standard

\color black
\begin_inset Formula 
\[
y=\frac{A}{\Theta^{k}\Gamma(k)}(x-x_{0})^{k-1}e^{-\frac{x-x_{0}}{\Theta}}
\]

\end_inset


\color inherit
with parameters 
\begin_inset Formula $k_{e}=2.570*10^{7}$
\end_inset

, 
\begin_inset Formula $\Theta_{e}=3.124*10^{-4}$
\end_inset

, 
\begin_inset Formula $x_{o,e}=-8.024*10^{3}$
\end_inset

 and 
\begin_inset Formula $k_{l}=3.413$
\end_inset

, 
\begin_inset Formula $\Theta_{l}=1.107$
\end_inset

, 
\begin_inset Formula $x_{0,l}=7.583$
\end_inset

, respectively.
 This method distinguishes RAR to CS+ and CS- better than model-free scoring
 of RAR (e.g., peak scoring).
 Compared to other measures of fear learning, RAR turn out to perform similar
 to SCR, but are less sensitive than HPR.
 By comparing CS/US SOAs of 3.5, 4, and 6 s, it is evident that the RAR are
 most likely time locked to the US.
 In the model, both components of the RF are shifted in time as a function
 of the SOA.
 To avoid deformation of the early RF due to violations of the linearity
 assumptions, however, we recommend to use this method only with experiments
 involving SOAs longer than 2.5 s.
\end_layout

\begin_layout Subsection
Data Conditioning
\end_layout

\begin_layout Subsubsection
Breathing cycle detection 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Breathing-cycle-detection"

\end_inset


\end_layout

\begin_layout Paragraph*
Bellows system
\end_layout

\begin_layout Standard
Transducer output is filtered offline with an anti-aliasing bidirectional
 first-order Butterworth low-pass filter and a cut-offfrequency of 5 Hz.
 Data are then downsampled to 10 Hz resolution.
 Respiration traces are mean-centred, filtered with a bidirectional Butterworth
 band pass filter and cut-off frequencies of 0.01 Hz and 0.6 Hz, and median
 filtered over 1 s.
 A negative zero-crossing is taken as start of inspiration.
 After each detected cycle, PsPM imposes a 1 s refractory period, to account
 for residual signal noise with might cause several zero-crossings on the
 same cycle.
 In the validation data set, we compared this method to visual detection
 as gold standard and found, for the automated method, a sensitivity of
 99.3%, and a positive predictive value of 99.5%.
 For the time difference between visual and automated detection, we found
 a median delay of 0.1 s and a standard deviation of 0.1 s 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Paragraph
Cushion system
\end_layout

\begin_layout Standard
For data obtained from the cushion/belt system, the above algorithm must
 be adapted to account for the different response of cushion/belt system
 to ventilator activity.
 Specifically, we defined the onsets of the inspirations as the minima of
 the respiratory trace.
 Hence, the algorithm was adapted to extract zero crossings of the derivative
 of the time series (i.e., the extrema), from which the positive ones (i.e.,
 the minima) were set as the start of the inspiration.
\end_layout

\begin_layout Subsubsection
Interpolation and Filtering 
\begin_inset CommandInset label
LatexCommand label
name "subsec:Interpolation-and-Filtering-Resp"

\end_inset


\end_layout

\begin_layout Standard
To transform the discontinuous RP, RA and RFR information into a continous
 signal, they are assigned to the start of the following inspiration cycle
 and linearly interpolated with 10 Hz sampling frequency.
 PsPM also allows writing out the respiration time stamps for quality control.
 The interpolation shifts some early evoked responses such that they appear
 to start before an event - this is automatically being taken care of by
 a response function that starts slightly before an event definition.
 The best filter frequencies in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2016aa"
literal "true"

\end_inset

 were: 0.01-1 Hz for RP, 0.001-1 Hz for evoked RA and RFR.
 For fear-conditioned RA a 0.01-2 Hz bidirectional 6th order Butterworth
 filter provided the best results (cf.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Castegnetti:2016ab"
literal "true"

\end_inset

).
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design: 
\end_layout

\begin_deeper
\begin_layout Itemize
evoked respiratory response models: make sure the SOA between subsequent
 events that elicit an respiratory response is longer than the peak of the
 respective RF.
 A formal test of the linearity assumption has not been done yet.
 
\end_layout

\begin_layout Itemize
fear-conditioned RAR: To avoid deformation of the early RF due to violations
 of the linearity assumptions, we recommend to use this method only with
 experiments involving SOAs longer than 2.5 s.
\end_layout

\end_deeper
\begin_layout Itemize
Model set up:
\end_layout

\begin_deeper
\begin_layout Itemize
Use default filter frequencies (0.01-1 Hz for RP, 0.001-1 Hz for evoked RA
 and RFR.
 0.001-2 Hz for fear-conditioned RA.)
\end_layout

\end_deeper
\begin_layout Section
Startle eye blink response models
\end_layout

\begin_layout Subsection
General
\end_layout

\begin_layout Standard
The startle response is a fast defensive reflex to an unexpected intense
 auditory, visual, or haptic stimulus.
 Functionally, it appears to protect an organism from an imminent blow to
 the head 
\begin_inset CommandInset citation
LatexCommand cite
key "Yeomans:2002aa"
literal "true"

\end_inset

.
 The human startle response encompasses a postural change and an eyeblink
 response which is easy to measure
\color magenta
 
\color inherit

\begin_inset CommandInset citation
LatexCommand cite
key "Lang:1997aa"
literal "true"

\end_inset

.
 While the startle response itself is very stereotypical, its amplitude
 is susceptible to various physiological and psychological manipulations,
 many of which can be summarised in a decision-theoretic model in terms
 of optimising the cost of the startle response, and of a putative predator
 attack
\color magenta
 
\color black

\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2015ac"
literal "true"

\end_inset

.
 In this context, the most important phenomenon is fear-potentiated startle,
 a stronger startle response during a CS+ than CS- in fear conditioning
 
\begin_inset CommandInset citation
LatexCommand cite
key "Brown:1951aa"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Peripheral and neural model
\end_layout

\begin_layout Standard
In the absence of information on the millesecond-time course of neural response
 in the centres controlling startle, it is difficult to separate a neural
 and a peripheral model.
 Hence, these two are collapsed for the purpose of quick and simple inversion
 with GLM (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"

\end_inset

).
 Because the startle response is so stereotypical, the same RF is used for
 all applications, and the amplitude estimated.
 There appears to be some variability in the latency of the startle response
 between trials and participants, such that the neural model contains a
 (constrained) latency parameter that is estimated from the data.
 The startle eye blink response function (SEBRF) is based on data from 19
 participants that heard startle sounds with no other manipulation.
 Pre-processing parameters were optimised to distinguish CS+/CS- in a fear
 retention task with 20 participants in which startle onsets were recorded
 for enhanced temporal precision.
 They were then validated on two independent samples of 15 and 14 participants
 in a fear retention, and fear acquisition task, respectively.
 The SEBRF is described as a gamma distribution 
\end_layout

\begin_layout Standard

\color black
\begin_inset Formula 
\[
y=\frac{A}{\Theta^{k}\Gamma(k)}(x-x_{0})^{k-1}e^{-\frac{x-x_{0}}{\Theta}}
\]

\end_inset


\end_layout

\begin_layout Standard
with parameters 
\begin_inset Formula $k=3.5114$
\end_inset

, 
\begin_inset Formula $\Theta=0.0108$
\end_inset

, 
\begin_inset Formula $x_{o}=0.0345$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Khemka:2016a"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Data preconditioning
\end_layout

\begin_layout Standard
The algorithm expects raw data from orbicularis oculi EMG.
 Data filtering and preprocessing is taken care of by a separate PsPM function
 (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Preprocess-startle-eyeblink"

\end_inset

) and includes a 4th order Butterworth band-pass filter with cutoff frequency
 of 50 Hz and 470 Hz, removal of mains noise with a 50 Hz notch filter.
 Filtered continuous EMG signals are rectified and smoothed using a 4th
 order Butterworth low-pass filter with a time constant of 3 ms corresponding
 to a cutoff frequency of 53.05 Hz.
 No more data pre-conditioning is applied during GLM inversion, which allows
\color black
 to visually inspect the filtered EMG data in advance to the inversion.
 To specify startle sound onsets with high precision, you can use the function
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Preprocess-startle-eyeblink"

\end_inset

 to detect these onsets from recorded audio signals.
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design: 
\end_layout

\begin_deeper
\begin_layout Itemize
record audio output from your startle equipment and use PsPM to detect sound
 onsets
\end_layout

\end_deeper
\begin_layout Itemize
Preprocessing:
\end_layout

\begin_deeper
\begin_layout Itemize
use default pre-processing
\end_layout

\end_deeper
\begin_layout Itemize
Model setup:
\end_layout

\begin_deeper
\begin_layout Itemize
model each trial as separate event type such that the response latency can
 be estimated per trial, rather than per condition
\end_layout

\end_deeper
\begin_layout Section
Scanpath speed (SPS) model
\end_layout

\begin_layout Subsection
General 
\end_layout

\begin_layout Standard
Various salient stimuli, e.g.
 threat-conditioned cues, capture overt attention in a bottom-up process
 
\begin_inset CommandInset citation
LatexCommand cite
key "schutz:2011"
literal "false"

\end_inset

, as shown in multiple stimulus competition paradigms using aversive cues.
 This yields a possibility to assess threat memory by overt attention.
 In cue competition paradigms, overt attention is usually measured as gaze
 patterns; for example, fixation duration, saccade initiation latency, and
 number of erroneous saccades.
 Here, we implement a model that captures gaze patterns during exclusive
 presentation of a single cue, by assessing scanpath speed, the length of
 scanpath per time unit, quantified as degree visual angle per second 
\begin_inset CommandInset citation
LatexCommand cite
key "xia:2020"
literal "false"

\end_inset

.
 In our publication, we refer to scanpath length, which is the integral
 of scanpath speed over time.
 Since we used constant cue presentation times in our publication, average
 scanpath speed and scanpath length were identical up to a multiplicative
 constant.
\end_layout

\begin_layout Subsection
Model for fear-conditioned SPS 
\end_layout

\begin_layout Standard
Scanpath speed/length allow differentiating CS+ and CS- in fear-conditioning
 paradigms with visual cues, and without fixation instructions or fixation
 cross.
 PsPM implements two simple models that build on the GLM inversion algorithm
 (see 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:General-linear-convolution"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 The first model is to compute average scanpath speed during a 2-s time
 window before US (shock) delivery.
 This was validated on three independent samples in 
\begin_inset CommandInset citation
LatexCommand cite
key "xia:2020"
literal "false"

\end_inset

.
 The model is implemented with a simple boxcar response function without
 mean-centering and is the default option.
 Parameter estimates can be interpreted as average scan path speed per second,
 and if they are multiplied with 2 then the resulting values can be interpreted
 as scan path length during the 2 s preceding the US.
 We also implement a gamma RF that describes the shape of the scanpath speed
 during the CS-US interval better than the boxcar function, but did not
 yield higher retrodictive validity in inferring the CS-/+ difference.
 This RF was fitted to the data of 21 participants and validated in an independe
nt sample; it is described by a gamma probability density function: 
\begin_inset Formula 
\[
y=\frac{A}{\mu^{k}\Gamma(k)}(t-t_{0})^{k-1}e^{-\frac{t-t_{0}}{\mu}}
\]

\end_inset

 with parameters 
\begin_inset Formula $k=10.0913,µ=0.4213,t0=-1.9020+(SOA–3)$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "xia:2020"
literal "false"

\end_inset

, where 
\begin_inset Formula $SOA$
\end_inset

 is the duration of the interval between CS onset and US onset in seconds.
 
\end_layout

\begin_layout Subsection
Data preconditioning 
\end_layout

\begin_layout Standard
PsPM provides procedures to import scan path speed directly.
 More commonly, it is convenient to import gaze coordinates in pixels, distance
 units, or visual angle, and convert them to scanpath speed.
 This requires interpolation of missing values which is done automatically.
 Conversion from pixels to mm or visual angle in degree is also possible.
 No filtering or smoothing is required for both RF during model inversion
 with GLM.
\end_layout

\begin_layout Subsection
Recommendations
\end_layout

\begin_layout Itemize
Experimental design:
\end_layout

\begin_deeper
\begin_layout Itemize
use visual cues during fear conditioning and avoid fixation guides.
\end_layout

\begin_layout Itemize
use a SOA longer than 2 s.
 Tested SOAs are 3.0 s and 3.5 s.
\end_layout

\end_deeper
\begin_layout Itemize
Model setup:
\end_layout

\begin_deeper
\begin_layout Itemize
use the default boxcar function and specify custom SOA.
\end_layout

\end_deeper
\begin_layout Part
User Guide
\end_layout

\begin_layout Section
File types
\end_layout

\begin_layout Standard
PsPM knows two file types:
\end_layout

\begin_layout Itemize
Data files - the original file name is prepended with 'pspm_' during import.
 Various pre-processing steps prepend additonal letters to the name.
 These files are loaded and saved with the function 
\family typewriter
pspm_load_data
\family default
.
\end_layout

\begin_layout Itemize
First-level model files - all models use a similar data structure.
 The name can be freely specified by the user.
 These files can also contain reconstructed responses in GLM.
 These files are loaded and saved with the function 
\family typewriter
pspm_load1
\family default
.
\end_layout

\begin_layout Section
Functions that create new data files
\end_layout

\begin_layout Standard
All functions in the Matlabbatch menu item 
\begin_inset Quotes eld
\end_inset

Data preparation
\begin_inset Quotes erd
\end_inset

 create new data files.
 These functions ask whether an existing file with the same name should
 be overwritten - unless you specify 'overwrite' in the options.
\end_layout

\begin_layout Itemize
Import - prepended with 'pspm_'
\end_layout

\begin_layout Itemize
Trim - prepended with 't'
\end_layout

\begin_layout Itemize
Split sessions - appended with '_sn<nr>'
\end_layout

\begin_layout Itemize
Rename - user-defined file name
\end_layout

\begin_layout Itemize
Interpolation - prepended with 'i' (only if run on all channels of the file)
\end_layout

\begin_layout Section
Functions that create or modify data channels in an existing file
\end_layout

\begin_layout Standard
All functions in the Matlabbatch menu item 
\begin_inset Quotes eld
\end_inset

Data preprocessing
\begin_inset Quotes erd
\end_inset

 create new channels.
 These functions allow you to select where to store a modified data channel.
 The following options exist:
\end_layout

\begin_layout Itemize
add: A new channel is created with the new data
\end_layout

\begin_layout Itemize
replace: If one or several channels of the output type exists, the last
 of these will be overwritten.
 For some functions, this can overwrite the original data, i.
 e.
 if a conversion function produces an output of the same type as the input.
 If no channel of the output channel type is found, a channel will be added.
\end_layout

\begin_layout Section
Import details
\end_layout

\begin_layout Standard
Here, we list some additional information regarding the import of various
 data types.
\end_layout

\begin_layout Paragraph
CED Spike
\end_layout

\begin_layout Paragraph
Text
\end_layout

\begin_layout Standard
Text files can only contain numbers (i.e.
 no header lines with channel names) and one data column per channel.
 Make sure you use the decimal point (i.e.
 not decimal comma).
 At the moment, no import of event time stamps is possible, but continuous
 event marker channels are supported.
\end_layout

\begin_layout Paragraph
Matlab
\end_layout

\begin_layout Standard
Each input file must contain a variable called data that is either a cell
 array of column vectors, or a data points × channels matrix.
 The import of event markers is supported.
 Marker channels are assumed to be continuous if the input data is a matrix
 or if the input data is a cell and the given samplerate is larger than
 1 Hz.
 A sample rate has to be specified for any type of data.
\end_layout

\begin_layout Paragraph
Biopac AcqKnowledge (up to v.
 3.9)
\end_layout

\begin_layout Standard
Imports original files.
\end_layout

\begin_layout Paragraph
exported Biopac AcqKnowledge
\end_layout

\begin_layout Standard
Converted with manufacturer's export function.
\end_layout

\begin_layout Paragraph
bioread-converted Biopac AcqKnowledge (any version)
\end_layout

\begin_layout Standard
Loads mat files which have been converted using the bioread tool acq2mat.
 Bioread can be installed using pip (installed by python) or can be downloaded
 and installed manually from here 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/njvack/bioread
\end_layout

\end_inset

.
 It requires python and the python libraries numpy and scipy.
 
\end_layout

\begin_layout Paragraph*
Labchart (any Version, Windows only)
\end_layout

\begin_layout Standard
Supports the import of any original Labchart (.adicht) file.
 Since it uses an external library, this import is restricted to Windows
 systems only and does not work on any other operating system.
\end_layout

\begin_layout Paragraph
Labchart exported (up to v.
 7.1)
\end_layout

\begin_layout Standard
Export data to matlab format (plugin for the LabChart software, available
 from www.adinstruments.com)
\end_layout

\begin_layout Paragraph
Labchart exported (v.
 7.2 and higher)
\end_layout

\begin_layout Paragraph
VarioPort
\end_layout

\begin_layout Paragraph
Biograph Infiniti exported
\end_layout

\begin_layout Standard
Export data to text format, both "Export Channel Data" and "Export Interval
 Data" are supported; a header is required
\end_layout

\begin_layout Paragraph*
Mindmedia Biotrace exported
\end_layout

\begin_layout Paragraph*
BrainVision
\end_layout

\begin_layout Paragraph*
Windaq (Manufacturer's version)
\end_layout

\begin_layout Standard
Requires an ActiveX Plugin provided by the manufacturer and contained in
 the subfolder Import/wdq for your convenience.
 This plugin only runs under 32 bit Matlab on Windows.
 
\end_layout

\begin_layout Paragraph
Windaq (PsPM Version)
\end_layout

\begin_layout Standard
Windaq import written by the PsPM team.
 Is platform independent, thus has no requirements for ActiveX Plugins,
 Windows or 32bit Matlab.
 Imports the *.wdq files.
 Up to now the import has been tested with files of the following type:
 Unpacked, no Hi-Res data, no Multiplexer files.
 A warning will be produced if the imported data-type fits one of the yet
 untested cases.
 If this is the case try to use the import provided by the manufacturer
 (see above).
\end_layout

\begin_layout Paragraph*
Observer XT compatible
\end_layout

\begin_layout Paragraph*
NeuroScan
\end_layout

\begin_layout Paragraph*
BioSemi
\end_layout

\begin_layout Paragraph*
Eyelink
\end_layout

\begin_layout Standard
Eyelink output files (with extension *.edf) must first be converted to ASCII
 format (extension *.asc).
 This is done with the utility edf2asc.exe (normally included in the Eyelink
 software in <Path to Program Files>
\backslash
SR Research
\backslash
EyeLink
\backslash
EDF_Access_API
\backslash
).
 Otherwise there is a Data viewer, available at 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://www.sr-research.com/dv.html
\end_layout

\end_inset

 (registration needed), which installs a utility called 'Visual EDF2ASC'.
 This also allows the conversion and does not require a license.
 The composition of channels depends on the acquisition settings.
 Available channels are Pupil L, Pupil R, x L, y L, x R, y R, Blink L, Blink
 R, Saccade L, Saccade R.
 The channels will be imported according to a known data structure, therefore
 channel ids passed to the import function or set in the Batch will be ignored.
 If the import function defines PsPM file channels that are not available
 in the data file, these channels will be filled with NaN values.
 Periods of blinks and saccades will be set to NaN in the gaze and pupil
 channels.
 To reduce the impact of loss of fixation on recorded pupil size, we recommend
 setting ELCL_PROC to ELLIPSE during acquisition.
\end_layout

\begin_layout Subparagraph*
Pupil Channels and Eyetracker distance 
\end_layout

\begin_layout Standard
Distance between eyetracker camera and recorded eyes in length units.
 If the given eyetracker distance is given as a positive numeric value,
 it enables the pupil data to be converted from arbitrary area or diameter
 units to diameter (mm) and then to the length unit of the eyetracker distance.
 If eyetracker distance is not given, or if it is not a positive numeric
 value, then the conversion to mm is disabled.
 In this case, pupil data will be imported in arbitrary (Eyelink) units.
 (Use only if you are interested in relative values)
\end_layout

\begin_layout Standard
The relation between arbitrary units (a.u.) and diameter is assumed to be
 linear such that for diameter data
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
d=m_{diameter}\cdot\frac{dist}{dist_{ref}}\cdot d_{a.u.}
\]

\end_inset


\end_layout

\begin_layout Standard
and for area data 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
d=m_{area}\cdot\frac{dist}{dist_{ref}}\cdot\sqrt{d_{a.u.}}
\]

\end_inset


\end_layout

\begin_layout Standard
for data 
\begin_inset Formula $d$
\end_inset

 in mm, data 
\begin_inset Formula $d_{a.u.}$
\end_inset

 in arbitrary units, reference camera-eye distance 
\begin_inset Formula $dist_{ref}$
\end_inset

 in mm, used camera-eye distance 
\begin_inset Formula $dist$
\end_inset

 in mm and a proportionality factor 
\begin_inset Formula $m$
\end_inset

 in mm.
 In our equations, 
\begin_inset Formula $m_{area}/dist_{ref}$
\end_inset

ratio corresponds to the scaling factor in 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

.
 For area-based conversion, we use the scaling factor 
\begin_inset Formula $\alpha=1.70\times10^{-4}$
\end_inset

as given in 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

.
 For a reference distance of 700 mm this translates to 
\begin_inset Formula $m_{area}=0.119$
\end_inset

 mm.
 For diameter-based conversion, we determined reference distance and the
 proportionality factor in a simpler calibration with three different artificial
 pupil sizes setting using linear regression.
 We note that for a different Eyelink eye-tracker setup, conversion with
 these values yielded results with slight deviance from the expected value,
 such that they are either not entirely precise, or there may be small differenc
es between different eyetrackers.
 The table below summarises all coefficients:
\end_layout

\begin_layout Standard
\noindent
\begin_inset Float table
placement t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Coefficients Used for Eyelink Data Conversion
\end_layout

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Coefficient
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Variable in 
\family typewriter
\series default
pspm_get_eyelink.m
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Value
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Unit
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $dist_{ref}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
reference_distance
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
700
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{diameter}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
diameter_multiplicator
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.00087743
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m_{area}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
area_multiplicator
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.119
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mm
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
tab:eyelink_coefficients
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For custom setups reference distance (field 
\family typewriter
reference_distance
\family default
) and proportionality factor (
\family typewriter
diameter_multiplicator
\family default
 or 
\family typewriter
area_multiplicator
\family default
) can be set at the top of 
\family typewriter
pspm_get_eyelink.m 
\family default
file.
\end_layout

\begin_layout Subparagraph*
Gaze Channels
\end_layout

\begin_layout Standard
Gaze channels are reported exactly as given in the datafile without any
 conversion.
 Gaze channel units are pixels.
\end_layout

\begin_layout Subparagraph*
Distance unit
\end_layout

\begin_layout Standard
The length unit in which the eyetracker distance is given.
 It can be mm, cm, m or inches.
\end_layout

\begin_layout Subparagraph*
Blink/Saccade Edge Discard
\end_layout

\begin_layout Standard
Samples surrounding a blink or saccade period may be noisy.
 For this reason, Eyelink import provides a parameter that allows users
 to specify the amount of samples they want to discard on each side of every
 blink and saccade period.
 This value is multiplied by the sampling rate of the recording to determine
 the number of samples to discard from one end.
 Therefore, for each blink/saccade period, 
\begin_inset Formula $2\cdot factor\cdot F_{sampling}$
\end_inset

 many samples are discarded in total, and effectively blink/saccade period
 is extended.
\end_layout

\begin_layout Standard
This value also corresponds to the duration of samples to discard on one
 end in seconds.
 For example, when it is 0.01, we discard 10 ms worth of data on each end
 of every blink/saccade period.
\end_layout

\begin_layout Standard
The default value has been changed to 0 in PsPM revision r803 to reduce
 the amount of discarded data.
 Note that this might result in noisy samples around blink/saccade points.
 Therefore, it is highly recommended to perform pupil size data preprocessing
 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Pupil-Size-Preprocessing"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and gaze data filtering 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Find-valid-fixations"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Paragraph*
SMI (SensoMotoric Instruments)
\end_layout

\begin_layout Standard
SMI output files (with extension *.idf) must first be converted to ASCII
 format (extension *.txt) using IDF converter.
\end_layout

\begin_layout Standard
SMI iView X EyeTracker sample and optionally also event files can be imported.
 The SMI sample file contains pupil, gaze and position related information.
 The SMI event file contains information about blink/saccade events.
 Available channels to import are Pupil L, Pupil R, Gaze x L, Gaze x R,
 Gaze y L, Gaze y R, Blink L, Blink R, Saccade L, Saccade R, Marker, Custom.
 All channels except custom are imported according to a known data structure.
 Therefore, there is no need to specify the column indices of channels.
 If specified channels are not available, they will be filled with NaN values.
 If an event file is given so that blinks/saccades are available, blink
 and saccade periods will be set to NaN.
\end_layout

\begin_layout Standard
There are multiple ways to specify pupil information in SMI sample files.
 Instead of importing all the channels for a given eye, PsPM selects only
 one of the available ones according to the following precedence order:
\end_layout

\begin_layout Enumerate
Mapped Diameter (mm)
\end_layout

\begin_layout Enumerate
Dia X (mm)
\end_layout

\begin_layout Enumerate
Dia (squared mm)
\end_layout

\begin_layout Enumerate
Dia X (px)
\end_layout

\begin_layout Enumerate
Dia (squared px)
\end_layout

\begin_layout Standard
If the chosen pupil channel is in squared px or squared mm, then it is converted
 to diameter by assuming the shape is a circle.
 However, no conversion from pixels to milimeters is performed for pupil
 channels.
 Therefore, if a pixel or squared pixel channel is chosen, it is returned
 in pixel units.
\end_layout

\begin_layout Standard
Returned gaze coordinates assume that (0, 0) point of the calibration area
 is the top left corner.
 
\begin_inset Formula $x$
\end_inset

 coordinates increase towards right and 
\begin_inset Formula $y$
\end_inset

 coordinates increase downwards.
 If the resolution of the whole stimulus window is given, the gaze values
 are returned in the desired target unit.
 Otherwise, they are returned in pixels.
 It is important to note that the values can be negative or larger than
 the sides of the screen, if gaze is outside the calibration area.
\end_layout

\begin_layout Standard
Gaze values are reported in pixels by SMI.
 The conversion from pixels to milimeters is performed by using the size
 and the resolution of the stimulus window to calculate 
\begin_inset Formula $px/mm$
\end_inset

 ratio, and then using this ratio for scaling.
\end_layout

\begin_layout Paragraph*
Viewpoint (Arrington Research)
\end_layout

\begin_layout Standard
Arrington Research ViewPoint EyeTracker files can be imported into PsPM.
 Available channels to import are Pupil L, Pupil R, Gaze x L, Gaze x R,
 Gaze y L, Gaze y R, Blink L, Blink R, Saccade L, Saccade R, Marker, Custom.
 Currently, blink and saccade events can only be imported if they are stored
 as asynchronous messages in the datafile.
 This is enabled by 
\begin_inset Quotes eld
\end_inset

Include Events in Datafile
\begin_inset Quotes erd
\end_inset

 option in ViewPoint EyeTracker software.
 All channels except custom are imported according to a known data structure;
 therefore, there is no need to specify the column indices of channels.
 If specified channels are not available, they will be filled with NaN values.
\end_layout

\begin_layout Standard
ViewPoint reports data for eye A in monocular mode and for eyes A and B
 in binocular mode.
 PsPM performs the following mapping from A/B to L/R:
\end_layout

\begin_layout Enumerate
If only one eye is specified by user (only L or only R) and there is only
 eye A in data, then data for eye A is returned as the eye specified by
 user
\end_layout

\begin_layout Enumerate
In all other cases, eye A is mapped to eye R and eye B is mapped to eye
 L.
\end_layout

\begin_layout Standard
All gaze and diameter values are reported as ratios by ViewPoint:
\end_layout

\begin_layout Enumerate
Gaze value for a given axis is the ratio of the gaze coordinate to the length
 of that axis.
\end_layout

\begin_layout Enumerate
Pupil diameter is the ratio of pupil width to the EyeCamera window width.
\end_layout

\begin_layout Standard
Since ViewPoint data files contain the size of the stimulus window in milimeters
, PsPM converts normalized gaze values to values in milimeter.
 This is performed by multiplying the ratio with the length of the corresponding
 stimulus window axis.
 Returned gaze coordinates assume that (0, 0) point of the stimulus window
 is the top left corner.
 
\begin_inset Formula $x$
\end_inset

 coordinates increase towards right and 
\begin_inset Formula $y$
\end_inset

 coordinates increase downwards.
 The gaze values are returned in the desired target unit.
 It is important to note that the values can be negative or larger than
 side of the screen which correspond to looking outside the stimulus window.
\end_layout

\begin_layout Standard
Pupil diameter is returned as ratio without any conversion.
\end_layout

\begin_layout Paragraph
European Data Format (EDF)
\end_layout

\begin_layout Paragraph
Philips Scanphyslog
\end_layout

\begin_layout Standard
This functions imports psychophysiology files from Philips MRI scanners.
 The physlog ascii file contains 6 channels with physiological measurements:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Channel id
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Event type
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ECG1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ECG2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ECG3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ECG4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pulse oxymeter
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Respiration
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

Depending on your scanner settings, there are 10 trigger channels (see complete
 list below) of which channel 6 marks time t of the last slice recording.
 After importing, a time window from t minus 
\begin_inset Formula $(\#\,volumes)*(repetition\:time)$
\end_inset

 seconds until t should be used for trimming or splitting of sessions to
 constrain data in the imported file to the EPI recording window and easier
 matching with experimental events from a separate source.
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

Available trigger channels are:
\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Channel id
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Event type
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Trigger ECG
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Trigger PPG
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Trigger Respiration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Measurement ('slice onset')
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Start of scan sequence
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
End of scan sequence
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Trigger external
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Calibration
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Manual start
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Reference ECG Trigger
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Paragraph*
SCR Transfer Function [for SCR data only]
\end_layout

\begin_layout Standard
The transfer function supports two recording systems, which are either a
 conductance based system (default) or a resistance based system.
 Depending on the recording system the relation between measured conductance
 
\begin_inset Formula $G$
\end_inset

 in 
\begin_inset Formula $\mu S$
\end_inset

 to recorded voltage 
\begin_inset Formula $U$
\end_inset

 in 
\begin_inset Formula $V$
\end_inset

 is either
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
G=\frac{1}{\frac{c}{U-offset}-R_{s}*10^{-6}},\label{eq:Voltage from Skin conductance}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
or
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
G=\frac{1}{\frac{U-offset}{c}-R_{s}*10^{-6}}.\label{eq:Voltage from Skin resistance}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For a transfer constant 
\begin_inset Formula $c$
\end_inset

 in 
\begin_inset Formula $V/\mu S$
\end_inset

 (for 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Voltage from Skin conductance"

\end_inset

) or in 
\begin_inset Formula $V/M\Omega$
\end_inset

 (for 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Voltage from Skin resistance"

\end_inset

), series resistor 
\begin_inset Formula $R_{s}$
\end_inset

 in Ohm, and a fixed offset in 
\begin_inset Formula $V$
\end_inset

 which was added to the initially measured voltage.
 If there is no offset and series resistor, this is equivalent to 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
G=\frac{U}{c},\,U=cG
\]

\end_inset


\end_layout

\begin_layout Standard
or 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
G=\frac{c}{U},\,U=cR=\frac{c}{G},
\]

\end_inset


\end_layout

\begin_layout Standard
There are three options how to enter this information:
\end_layout

\begin_layout Itemize
File: Enter the name of the .mat file that contains the variables: 'c', 'Rs'
 (in Ohm) and 'offset', 'recsys' (possible values: 'conductance' or 'resistance'
).
\end_layout

\begin_layout Itemize
Input: Enter the transfer constants manually.
\end_layout

\begin_layout Itemize
None: No transfer function.
 Use this only if you are not interested in absolute values, and if the
 recording settings were the same for all subjects.
\end_layout

\begin_layout Part
Tutorial data sets
\end_layout

\begin_layout Standard

\shape italic
Contributed by Christoph Korn & Matthias Staib.
\end_layout

\begin_layout Section
GLM for SCR: Appraisal data 
\begin_inset CommandInset label
LatexCommand label
name "sec:tutorial_GLM"

\end_inset


\end_layout

\begin_layout Standard
To analyse this data set, follow tutorials 1-2 on the PsPM website.
 Tutorial 6 shows how to adapt your scripts for multiple participants.
 In this tutorial, we analyze SCR data using a general linear model (GLM).
 The example data set comprises SCR data from 15 participants and can be
 downloaded from 
\begin_inset CommandInset href
LatexCommand href
name "https://bachlab.github.io/PsPM/courses/"
target "https://bachlab.github.io/PsPM/courses/"
literal "false"

\end_inset

.
 Results from this data set have been previously published 
\begin_inset CommandInset citation
LatexCommand cite
key "Bach:2013aa,Bach:2014aa"
literal "true"

\end_inset

.
 Each participant saw 45 neutral and 45 aversive pictures within one session
 that included two short breaks.
 SCR data were recorded using a 0.5 V coupler, optical (wave to pulse) transducer
, and CED Spike, with a minimum sampling rate of 100 Hz.
 
\end_layout

\begin_layout Section
Non-linear SCR analysis: Delay fear conditioning data
\begin_inset CommandInset label
LatexCommand label
name "sec:Delay-fear-conditioning"

\end_inset


\end_layout

\begin_layout Standard
To analyse this data set, follow tutorial 3 on the PsPM website.
 Tutorial 6 shows how to adapt your scripts for multiple participants.
 In this tutorial, the non-linear model is estimated.
 The estimated parameters can then be used to test the within-subject hypothesis
 that the sympathetic arousal between CS+ and CS- are different on a group
 level.
 The example data set comprises SCR data from 20 participants, with 40 trials
 each, which can be downloaded from 
\begin_inset CommandInset href
LatexCommand href
name "https://bachlab.github.io/PsPM/courses/"
target "https://bachlab.github.io/PsPM/courses/"
literal "false"

\end_inset

 together with the result files of the model inversion.
 Participants underwent a differential delay fear conditioning paradigm
 where coloured circles were presented for 4 seconds each.
 Either the blue or orange coloured circles (balanced over participants)
 were probabilistically paired with an electric stimulation (unconditioned
 stimulus, US) that coterminated with the stimulus (conditioned stimulus,
 CS+) while the CS- were always presented alone.
\end_layout

\begin_layout Standard
Presenting the CS+ causes phasic sympathetic arousal in anticipation of
 an electric shock.
 This anticipatory reaction typically occurs with an unknown and variable
 latency after stimulus onset.
 For such cases, a GLM should not be used because it assumes that sympathetic
 arousal follows the stimulus with a fixed latency.
 In contrast, the non-linear model allows estimating (i) a variable onset
 within a user-specified time window and (ii) a variable duration of a sympathet
ic response.
 Additionally, the non-linear model includes estimation of spontaneous fluctuati
ons that occur between trials.
\end_layout

\begin_layout Part
How to reference PsPM
\end_layout

\begin_layout Standard
To justify our development and maintenance effort, we ask you acknowledge
 PsPM when you use it: 
\begin_inset Quotes eld
\end_inset

Data were analysed using PsPM [version number], available at 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://bachlab.github.io/pspm
\end_layout

\end_inset

.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
We ask you reference our papers to justify your analysis steps and models
 in the following way:
\end_layout

\begin_layout Itemize
General PsPM reference: 
\end_layout

\begin_deeper
\begin_layout Itemize
Bach DR, & Friston KJ (2013).
 Model-based analysis of skin conductance responses: Towards causal models
 in psychophysiology.
 Psychophysiology, 50, 15-22.
\end_layout

\begin_layout Itemize
Bach DR, Castegnetti G, Korn CW, Gerster S, Melinscak F, Moser T (2018).
 Psychophysiological modelling - current state and future directions.
 Psychophysiology, 55, e13214.
\end_layout

\end_deeper
\begin_layout Itemize
General PsPM reference for fear conditioning experiments:
\end_layout

\begin_deeper
\begin_layout Itemize
Bach DR, & Melinščak F (2020).
 Psychophysiological modelling and the measurement of fear conditioning.
 Behaviour Research and Therapy, 127, 103576.
\end_layout

\end_deeper
\begin_layout Itemize
GLM for SCR
\end_layout

\begin_deeper
\begin_layout Itemize
general reference: Bach DR, Flandin G, Friston KJ, & Dolan RJ (2009).
 Time-series analysis for rapid event-related skin conductance responses.
 Journal of Neuroscience Methods, 184, 224-234.
 
\end_layout

\begin_layout Itemize
canonical SCRF: Bach DR, Flandin G, Friston KJ, & Dolan RJ (2010).
 Modelling event-related skin conductance responses.
 International Journal of Psychophysiology, 75, 349-356.
\end_layout

\begin_layout Itemize
assumptions of the model: Gerster S, Namer B, Elam M, Bach DR (2018).
 Testing a linear time invariant model for skin conductance responses by
 intraneural recording and stimulation.
 Psychophysiology, 55, e12986.
\end_layout

\begin_layout Itemize
optimised filter settings: Bach DR, Friston KJ, Dolan RJ (2013).
 An improved algorithm for model-based analysis of evoked skin conductance
 responses.
 Biological Psychology, 94, 490-497.
 
\end_layout

\begin_layout Itemize
comparison with Ledalab and peak-scoring methods: Bach DR (2014).
 A head-to-head comparison of SCRalyze and Ledalab, two model-based methods
 for skin conductance analysis.
 Biological Psychology, 103, 63-88.
\end_layout

\end_deeper
\begin_layout Itemize
non-linear model for event-related SCR:
\end_layout

\begin_deeper
\begin_layout Itemize
general reference: Bach DR, Daunizeau J, Friston KJ, & Dolan RJ (2010).
 Dynamic causal modelling of anticipatory skin conductance responses.
 Biological Psychology, 85, 163-70.
\end_layout

\begin_layout Itemize
optimised filter settings: Staib M, Castegnetti G, Bach DR (2015).
 Optimising a model-based approach to inferring fear learning from skin
 conductance responses.
 Journal of Neuroscience Methods, 255, 131-138.
\end_layout

\begin_layout Itemize
optimised forward model for short SOA paradigms (see supplementary material):
 Tzovara A, Korn CW & Bach DR (2018).
 Human Pavlovian fear conditioning conforms to probabilistic learning.
 PLOS Computational Biology, 14, e1006243.
\end_layout

\end_deeper
\begin_layout Itemize
non-linear model for SF:
\end_layout

\begin_deeper
\begin_layout Itemize
general reference: Bach DR, Daunizeau J, Kuelzow N, Friston KJ, & Dolan
 RJ (2011).
 Dynamic causal modelling of spontaneous fluctuations in skin conductance.
 Psychophysiology, 48, 252-57.
\end_layout

\begin_layout Itemize
canonical SCRF: Bach DR, Friston KJ, & Dolan RJ (2010).
 Analytic measures for quantification of arousal from spontaneous skin conductan
ce fluctuations.
 International Journal of Psychophysiology, 76, 52-55.
\end_layout

\begin_layout Itemize
MP algorithm: Bach DR, Staib M (2015).
 A matching pursuit algorithm for inferring tonic sympathetic arousal from
 spontaneous skin conductance fluctuations.
 Psychophysiology, 52, 1106-12.
\end_layout

\end_deeper
\begin_layout Itemize
GLM for evoked HPR: Paulus PC, Castegnetti G, & Bach DR (2016).
 Modeling event-related heart period responses.
 Psychophysiology, 53, 837-846.
 
\end_layout

\begin_layout Itemize
GLM for fear-conditioned HPR: Castegnetti G, Tzovara A, Staib M, Paulus
 PC, Hofer N, & Bach DR (2016).
 Modeling fear-conditioned bradycardia in humans.
 Psychophysiology, 53, 930-939.
 
\end_layout

\begin_layout Itemize
GLM for evoked respiratory responses: Bach DR, Gerster S, Tzovara A, Castegnetti
 G (2016).
 A linear model for event-related respiration responses.
 Journal of Neuroscience Methods, 270, 147-155.
 
\end_layout

\begin_layout Itemize
GLM for fear-conditioned RAR: Castegnetti C, Tzovara A, Staib M, Gerster
 S, Bach DR (2017).
 Assessing fear memory via conditioned respiratory amplitude responses.
 Psychophysiology, 54, 215-223.
\end_layout

\begin_layout Itemize
GLM for illuminance-elicited PSR: Korn CW & Bach DR (2016).
 A solid frame for the window on cognition: Modeling event-related pupil
 responses.
 Journal of Vision, 16, 28.
 
\end_layout

\begin_layout Itemize
GLM for fear-conditioned PSR: Korn CW, Staib M, Tzovara A, Castegnetti G,
 Bach DR (2017).
 A pupil size response model to quantify fear conditioning.
 Psychophysiology, 54, 330-343.
\end_layout

\begin_layout Itemize
GLM for SEBR: Khemka S, Tzovara A, Gerster S, Quednow BB, Bach DR (2017).
 Modeling startle eyeblink electromyogram to assess fear learning.
 Psychophysiology, 54, 204-214.
\end_layout

\begin_layout Itemize
GLM for scanpath speed: Xia Y, Melinščak F, Bach DR (2020).
 Saccadic scanpath length: an index for human threat conditioning.
 Behavior Research Methods, 53, 1426-1439.
\end_layout

\begin_layout Itemize
Integration of different measures: Mancinelli F*, Sporrer JK*, Myrov V,
 Melinscak F, Zimmermann J, Huaiyu L, Bach DR (2024).
 Dimensionality and optimal combination of autonomic fear-conditioning measures
 in humans.
 Behavior Research Methods, 56, 6119–6129.
\end_layout

\begin_layout Part
Acknowledgements
\end_layout

\begin_layout Standard
Beyond the authors named on this manual, the following persons contributed
 to PsPM.
 
\end_layout

\begin_layout Itemize
Import functions: Eric Featherstone, Chloe Hutton, Oliver Josephs, Alfonso
 Reid.
\end_layout

\begin_layout Itemize
Model development and model inversion: Jean Daunizeau, Guillaume Flandin,
 Karl Friston.
\end_layout

\begin_layout Standard
PsPM uses code from the following toolboxes:
\end_layout

\begin_layout Itemize
SON library for CED spike *.smr import (Malcolm Lidierth at King's College
 London)
\end_layout

\begin_layout Itemize
SPM physiology toolbox for CED spike *.smr import (Eric Featherstone, Chloe
 Hutton)
\end_layout

\begin_layout Itemize
Biopac Acknowledge import (Sebastien Authier, Vincent Finnertyat the University
 of Montreal)
\end_layout

\begin_layout Itemize
FieldTrip for various import routines (Robert Oostenveldt at Radboud University
 Nijmegen)
\end_layout

\begin_layout Standard
PsPM incorporates the following published toolboxes and/or methods:
\end_layout

\begin_layout Itemize
SCR quality control 
\begin_inset CommandInset citation
LatexCommand cite
key "Kleckner:2017a"
literal "false"

\end_inset


\end_layout

\begin_layout Itemize
pupil preprocessing 
\begin_inset CommandInset citation
LatexCommand cite
key "kret2018preprocessing"
literal "false"

\end_inset


\end_layout

\begin_layout Itemize
pupil foreshortening error correction 
\begin_inset CommandInset citation
LatexCommand cite
key "Hayes:2015a"
literal "false"

\end_inset

 
\end_layout

\begin_layout Itemize
QRS detection for fMRI enviornments 
\begin_inset CommandInset citation
LatexCommand cite
key "liu2012statistical"
literal "false"

\end_inset


\end_layout

\begin_layout Itemize
HeartPy toolbox for pulse oxymetry 
\begin_inset CommandInset citation
LatexCommand cite
key "Gent:2019aa"
literal "false"

\end_inset


\end_layout

\begin_layout Itemize
VBA toolbox 
\begin_inset CommandInset citation
LatexCommand cite
key "Daunizeau:2014aa"
literal "false"

\end_inset


\end_layout

\begin_layout Part
References
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "PsPM"
options "pnas2009"

\end_inset


\end_layout

\end_body
\end_document
